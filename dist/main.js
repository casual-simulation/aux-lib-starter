/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./index.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./RemoteNodeAuxChannel.ts":
/*!*********************************!*\
  !*** ./RemoteNodeAuxChannel.ts ***!
  \*********************************/
/*! exports provided: RemoteNodeAuxChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RemoteNodeAuxChannel\", function() { return RemoteNodeAuxChannel; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _casual_simulation_causal_tree_client_socketio__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/causal-tree-client-socketio */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/index.js\");\n/* harmony import */ var _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @casual-simulation/aux-vm */ \"./node_modules/@casual-simulation/aux-vm/index.js\");\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var _casual_simulation_crypto_node__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @casual-simulation/crypto-node */ \"./node_modules/@casual-simulation/crypto-node/index.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\nclass RemoteNodeAuxChannel extends _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_2__[\"BaseAuxChannel\"] {\r\n    constructor(user, config) {\r\n        super(user, config);\r\n        this._socketManager = new _casual_simulation_causal_tree_client_socketio__WEBPACK_IMPORTED_MODULE_1__[\"SocketManager\"](config.host);\r\n        this._treeManager = new _casual_simulation_causal_tree_client_socketio__WEBPACK_IMPORTED_MODULE_1__[\"CausalTreeManager\"](this._socketManager, Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"auxCausalTreeFactory\"])(), new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"NullCausalTreeStore\"]());\r\n        // Workaround until we let users specify\r\n        // the crypto implementation for the causal tree manager.\r\n        const treeManager = this._treeManager;\r\n        treeManager._crypto = new _casual_simulation_crypto_node__WEBPACK_IMPORTED_MODULE_4__[\"NodeSigningCryptoImpl\"]('ECDSA-SHA256-NISTP256');\r\n    }\r\n    setGrant(grant) {\r\n        return __awaiter(this, void 0, void 0, function* () { });\r\n    }\r\n    _sendRemoteEvents(events) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const aux = this._aux;\r\n            yield aux.channel.connection.sendEvents(events);\r\n        });\r\n    }\r\n    _createRealtimeCausalTree() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this._socketManager.init();\r\n            yield this._treeManager.init();\r\n            const tree = yield this._treeManager.getTree({\r\n                id: this._config.treeName,\r\n                type: 'aux',\r\n            }, this.user, {\r\n                garbageCollect: true,\r\n                // TODO: Allow reusing site IDs without causing multiple tabs to try and\r\n                //       be the same site.\r\n                alwaysRequestNewSiteId: true,\r\n            });\r\n            return tree;\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./RemoteNodeAuxChannel.ts?");

/***/ }),

/***/ "./index.ts":
/*!******************!*\
  !*** ./index.ts ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _RemoteNodeAuxChannel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RemoteNodeAuxChannel */ \"./RemoteNodeAuxChannel.ts\");\n/* harmony import */ var _casual_simulation_aux_vm_node__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/aux-vm-node */ \"./node_modules/@casual-simulation/aux-vm-node/index.js\");\n/* harmony import */ var repl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! repl */ \"repl\");\n/* harmony import */ var repl__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(repl__WEBPACK_IMPORTED_MODULE_2__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\nstart();\r\nfunction start() {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const user = {\r\n            id: 'myUserId',\r\n            username: 'myUsername',\r\n            name: 'myName',\r\n            token: 'mySecretToken',\r\n            isGuest: false\r\n        };\r\n        // This is all gonna get cleaned up\r\n        const config = {\r\n            config: { isBuilder: false, isPlayer: false },\r\n            host: 'https://auxplayer.com',\r\n            id: 'https://auxplayer.com/*/hello',\r\n            treeName: 'aux-hello'\r\n        };\r\n        const channel = new _RemoteNodeAuxChannel__WEBPACK_IMPORTED_MODULE_0__[\"RemoteNodeAuxChannel\"](user, config);\r\n        // Ignore the cast\r\n        const sim = new _casual_simulation_aux_vm_node__WEBPACK_IMPORTED_MODULE_1__[\"NodeSimulation\"](channel, config.id, config.config);\r\n        yield sim.init();\r\n        sim.connection.syncStateChanged.subscribe(synced => {\r\n            if (synced) {\r\n                console.log(\"We're synced!\");\r\n                startRepl(sim);\r\n            }\r\n            else {\r\n                console.log('No longer synced.');\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction startRepl(sim) {\r\n    const server = repl__WEBPACK_IMPORTED_MODULE_2___default.a.start({\r\n        prompt: `${sim.id} > `,\r\n        eval: evalScript\r\n    });\r\n    server.on('exit', () => {\r\n        sim.unsubscribe();\r\n        process.exit();\r\n    });\r\n    function evalScript(cmd, context, filename, callback) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const result = yield sim.helper.search(cmd);\r\n            callback(null, result);\r\n        });\r\n    }\r\n}\r\n\n\n//# sourceURL=webpack:///./index.ts?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/ApiVersion.js":
/*!******************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/ApiVersion.js ***!
  \******************************************************************/
/*! exports provided: apiVersion */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"apiVersion\", function() { return apiVersion; });\n/**\n * Gets the API version that the AUX common library currently supports.\n * This needs to get manually incremented whenever a new API version is added.\n * Basically a really barebones start for API versioning.\n */\nvar apiVersion = 2;\n//# sourceMappingURL=ApiVersion.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/ApiVersion.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/File.js":
/*!******************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/File.js ***!
  \******************************************************************/
/*! exports provided: DEFAULT_USER_MODE, DEFAULT_SELECTION_MODE, DEFAULT_FILE_SHAPE, DEFAULT_LABEL_ANCHOR, DEFAULT_WORKSPACE_HEIGHT, DEFAULT_WORKSPACE_SIZE, DEFAULT_WORKSPACE_SCALE, DEFAULT_MINI_WORKSPACE_SCALE, DEFAULT_WORKSPACE_GRID_SCALE, DEFAULT_WORKSPACE_HEIGHT_INCREMENT, DEFAULT_WORKSPACE_MIN_HEIGHT, DEFAULT_WORKSPACE_COLOR, DEFAULT_SCENE_BACKGROUND_COLOR, DEFAULT_BUILDER_USER_COLOR, DEFAULT_PLAYER_USER_COLOR, DEFAULT_USER_INACTIVE_TIME, DEFAULT_USER_DELETION_TIME, GLOBALS_FILE_ID, AUX_FILE_VERSION, KNOWN_TAGS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_MODE\", function() { return DEFAULT_USER_MODE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SELECTION_MODE\", function() { return DEFAULT_SELECTION_MODE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_FILE_SHAPE\", function() { return DEFAULT_FILE_SHAPE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_LABEL_ANCHOR\", function() { return DEFAULT_LABEL_ANCHOR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT\", function() { return DEFAULT_WORKSPACE_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SIZE\", function() { return DEFAULT_WORKSPACE_SIZE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SCALE\", function() { return DEFAULT_WORKSPACE_SCALE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_MINI_WORKSPACE_SCALE\", function() { return DEFAULT_MINI_WORKSPACE_SCALE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_GRID_SCALE\", function() { return DEFAULT_WORKSPACE_GRID_SCALE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT_INCREMENT\", function() { return DEFAULT_WORKSPACE_HEIGHT_INCREMENT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_MIN_HEIGHT\", function() { return DEFAULT_WORKSPACE_MIN_HEIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_COLOR\", function() { return DEFAULT_WORKSPACE_COLOR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SCENE_BACKGROUND_COLOR\", function() { return DEFAULT_SCENE_BACKGROUND_COLOR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_BUILDER_USER_COLOR\", function() { return DEFAULT_BUILDER_USER_COLOR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_PLAYER_USER_COLOR\", function() { return DEFAULT_PLAYER_USER_COLOR; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_INACTIVE_TIME\", function() { return DEFAULT_USER_INACTIVE_TIME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_DELETION_TIME\", function() { return DEFAULT_USER_DELETION_TIME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GLOBALS_FILE_ID\", function() { return GLOBALS_FILE_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AUX_FILE_VERSION\", function() { return AUX_FILE_VERSION; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KNOWN_TAGS\", function() { return KNOWN_TAGS; });\n/**\n * The default user mode.\n */\nconst DEFAULT_USER_MODE = 'files';\n/**\n * The default selection mode.\n */\nconst DEFAULT_SELECTION_MODE = 'single';\n/**\n * The default file shape.\n */\nconst DEFAULT_FILE_SHAPE = 'cube';\n/**\n * The default file label anchor.\n */\nconst DEFAULT_LABEL_ANCHOR = 'top';\n/**\n * The default height for workspaces.\n */\nconst DEFAULT_WORKSPACE_HEIGHT = 0.1;\n/**\n * The default size for workspaces.\n */\nconst DEFAULT_WORKSPACE_SIZE = 1;\n/**\n * The default scale for workspaces.\n */\nconst DEFAULT_WORKSPACE_SCALE = 2;\n/**\n * The default scale for mini workspaces.\n */\nconst DEFAULT_MINI_WORKSPACE_SCALE = DEFAULT_WORKSPACE_SCALE / 3;\n/**\n * The default grid scale for workspaces.\n */\nconst DEFAULT_WORKSPACE_GRID_SCALE = 0.2;\n/**\n * The amount that a hex's height is allowed to change by in a single increment.\n */\nconst DEFAULT_WORKSPACE_HEIGHT_INCREMENT = 0.1;\n/**\n * The minimum height that hexes in a workspace can be.\n */\nconst DEFAULT_WORKSPACE_MIN_HEIGHT = 0.1;\n/**\n * The default color for workspaces.\n */\nconst DEFAULT_WORKSPACE_COLOR = '#999999';\n/**\n * The default color for scene background.\n */\nconst DEFAULT_SCENE_BACKGROUND_COLOR = '#263238';\n/**\n * The default color for users in AUX Builder.\n */\nconst DEFAULT_BUILDER_USER_COLOR = '#00D000';\n/**\n * The default color for users in AUX Player.\n */\nconst DEFAULT_PLAYER_USER_COLOR = '#DDDD00';\n/**\n * The amount of time that a user needs to be inactive for\n * in order to hide their file.\n */\nconst DEFAULT_USER_INACTIVE_TIME = 1000 * 60;\n/**\n * The amount of time that a user needs to be inactive for\n * in order to delete their file.\n */\nconst DEFAULT_USER_DELETION_TIME = 1000 * 60 * 60;\n/**\n * The ID of the global configuration file.\n */\nconst GLOBALS_FILE_ID = 'config';\n/**\n * The current file format version for AUX Files.\n * This number increments whenever there are any changes between AUX versions.\n * As a result, it will allow us to make breaking changes but still upgrade people's files\n * in the future.\n */\nconst AUX_FILE_VERSION = 1;\n/*\n * The list of all tags that have existing functionality in casual sim\n */\nconst KNOWN_TAGS = [\n    'aux._selection',\n    'aux._destroyed',\n    'aux._user',\n    'aux._userContext',\n    'aux._userInventoryContext',\n    'aux._userMenuContext',\n    'aux._userSimulationsContext',\n    'aux._mode',\n    'aux._editingFile',\n    'aux._selectionMode',\n    'aux._lastEditedBy',\n    'aux.account.username',\n    'aux.account.locked',\n    'aux.connectedSessions',\n    'aux.maxSessionsAllowed',\n    'aux.token',\n    'aux.token.username',\n    'aux.token.locked',\n    'aux.inventory.color',\n    'aux.context.inventory.color',\n    'aux.context.inventory.height',\n    'aux.context.inventory.visible',\n    'aux.scene.color',\n    'aux.scene.user.player.color',\n    'aux.scene.user.builder.color',\n    'aux.color',\n    'aux.creator',\n    'aux.movable',\n    'aux.movable.mod.tags',\n    'aux.stackable',\n    'aux.mergeable',\n    'aux.destroyable',\n    'aux.editable',\n    'aux.stroke.color',\n    'aux.stroke.width',\n    'aux.line.to',\n    'aux.line.style',\n    'aux.line.width',\n    'aux.line.color',\n    'aux.label',\n    'aux.label.color',\n    'aux.label.size',\n    'aux.label.size.mode',\n    'aux.label.anchor',\n    'aux.listening',\n    'aux.scale',\n    'aux.scale.x',\n    'aux.scale.y',\n    'aux.scale.z',\n    'aux.input',\n    'aux.input.target',\n    'aux.input.placeholder',\n    'aux.image',\n    'aux.shape',\n    'aux.progressBar',\n    'aux.progressBar.color',\n    'aux.progressBar.backgroundColor',\n    'aux.progressBar.anchor',\n    'aux.channel',\n    'aux.channel.locked',\n    'aux.channel.connectedSessions',\n    'aux.channel.maxSessionsAllowed',\n    'aux.whitelist',\n    'aux.blacklist',\n    'aux.iframe',\n    'aux.iframe.x',\n    'aux.iframe.y',\n    'aux.iframe.z',\n    'aux.iframe.size.x',\n    'aux.iframe.size.y',\n    'aux.iframe.rotation.x',\n    'aux.iframe.rotation.y',\n    'aux.iframe.rotation.z',\n    'aux.iframe.element.width',\n    'aux.iframe.scale',\n    'aux.context',\n    'aux.context.color',\n    'aux.context.locked',\n    'aux.context.grid.scale',\n    'aux.context.surface.grid',\n    'aux.context.x',\n    'aux.context.y',\n    'aux.context.z',\n    'aux.context.rotation.x',\n    'aux.context.rotation.y',\n    'aux.context.rotation.z',\n    'aux.context.surface.scale',\n    'aux.context.surface.defaultHeight',\n    'aux.context.surface.size',\n    'aux.context.surface.minimized',\n    'aux.context.surface.movable',\n    'aux.context.visualize',\n    'onClick()',\n    'onAnyBotClicked()',\n    'onCombine()',\n    'onMerge()',\n    'onSaveInput()',\n    'onCloseInput()',\n    'onCreate()',\n    'onDestroy()',\n    'onDropInContext()',\n    'onDragOutOfContext()',\n    'onDropAnyInContext()',\n    'onDragAnyOutOfContext()',\n    'onDropInInventory()',\n    'onDragOutOfInventory()',\n    'onDropAnyInInventory()',\n    'onDragAnyOutOfInventory()',\n    'onTapCode()',\n    'onQRCodeScanned()',\n    'onQRCodeScannerClosed()',\n    'onQRCodeScannerOpened()',\n    'onPointerEnter()',\n    'onPointerExit()',\n    'onConnected()',\n    'onDisconnected()',\n    'onPlayerContextEnter()',\n    'onKeyDown()',\n    'onKeyUp()',\n    'onGridClick()',\n];\n//# sourceMappingURL=File.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/File.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/FileActions.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/FileActions.js ***!
  \*************************************************************************/
/*! exports provided: searchFileState, calculateActionResults, calculateActionEvents, calculateFormulaEvents, calculateDestroyFileEvents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"searchFileState\", function() { return searchFileState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResults\", function() { return calculateActionResults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEvents\", function() { return calculateActionEvents; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaEvents\", function() { return calculateFormulaEvents; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateDestroyFileEvents\", function() { return calculateDestroyFileEvents; });\n/* harmony import */ var _FileCalculations__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FileCalculations */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js\");\n/* harmony import */ var _FileEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FileEvents */ \"./node_modules/@casual-simulation/aux-common/Files/FileEvents.js\");\n/* harmony import */ var _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FileCalculationContextFactories */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculationContextFactories.js\");\n/* harmony import */ var _FilesChannel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FilesChannel */ \"./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n/**\n * Executes the given formula on the given file state and returns the results.\n * @param formula The formula to run.\n * @param state The file state to use.\n * @param options The options.\n */\nfunction searchFileState(formula, state, { includeDestroyed } = {}, createSandbox) {\n    includeDestroyed = includeDestroyed || false;\n    const context = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContextFromState\"])(state, includeDestroyed, createSandbox);\n    const result = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"calculateFormulaValue\"])(context, formula);\n    return result;\n}\nfunction calculateActionResults(state, action, sandboxFactory) {\n    const allObjects = Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"values\"])(state);\n    const calc = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"])(allObjects, action.userId, undefined, sandboxFactory);\n    const { files, objects } = Object(_FilesChannel__WEBPACK_IMPORTED_MODULE_3__[\"getFilesForAction\"])(state, action, calc);\n    const context = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"])(objects, action.userId, undefined, sandboxFactory);\n    const [fileEvents, results] = Object(_FilesChannel__WEBPACK_IMPORTED_MODULE_3__[\"calculateFileActionEvents\"])(state, action, context, files);\n    let events = [...fileEvents, ...context.sandbox.interface.getFileUpdates()];\n    return [events, results];\n}\n/**\n * Calculates the set of events that should be run for the given action.\n * @param state The current file state.\n * @param action The action to process.\n * @param context The calculation context to use.\n * @param sandboxFactory The sandbox factory to use.\n */\nfunction calculateActionEvents(state, action, sandboxFactory) {\n    const allObjects = Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"values\"])(state);\n    const calc = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"])(allObjects, action.userId, undefined, sandboxFactory);\n    const { files, objects } = Object(_FilesChannel__WEBPACK_IMPORTED_MODULE_3__[\"getFilesForAction\"])(state, action, calc);\n    const context = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"])(objects, action.userId, undefined, sandboxFactory);\n    const [fileEvents] = Object(_FilesChannel__WEBPACK_IMPORTED_MODULE_3__[\"calculateFileActionEvents\"])(state, action, context, files);\n    let events = [...fileEvents, ...context.sandbox.interface.getFileUpdates()];\n    return {\n        events,\n        hasUserDefinedEvents: events.length > 0,\n    };\n}\n/**\n * Calculates the set of events that should be run for the given formula.\n * @param state The current file state.\n * @param formula The formula to run.\n * @param userId The ID of the user to run the script as.\n * @param argument The argument to include as the \"that\" variable.\n */\nfunction calculateFormulaEvents(state, formula, userId = null, argument = null, sandboxFactory) {\n    const objects = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"getActiveObjects\"])(state);\n    const context = Object(_FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"])(objects, userId, undefined, sandboxFactory);\n    let [fileEvents] = Object(_FilesChannel__WEBPACK_IMPORTED_MODULE_3__[\"formulaActions\"])(state, context, [], null, [formula]);\n    return [...fileEvents, ...context.sandbox.interface.getFileUpdates()];\n}\n/**\n * Calculates the list of events needed to destroy the given file and all of its decendents.\n * @param calc The file calculation context.\n * @param file The file to destroy.\n */\nfunction calculateDestroyFileEvents(calc, file) {\n    if (!Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"isDestroyable\"])(calc, file)) {\n        return [];\n    }\n    let events = [];\n    let id;\n    if (typeof file === 'object') {\n        id = file.id;\n    }\n    else if (typeof file === 'string') {\n        id = file;\n    }\n    if (id) {\n        events.push(Object(_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileRemoved\"])(id));\n    }\n    destroyChildren(calc, events, id);\n    return events;\n}\nfunction destroyChildren(calc, events, id) {\n    const result = calc.objects.filter(o => Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"calculateFileValue\"])(calc, o, 'aux.creator') === id);\n    result.forEach(child => {\n        if (!Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"isDestroyable\"])(calc, child)) {\n            return;\n        }\n        events.push(Object(_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileRemoved\"])(child.id));\n        destroyChildren(calc, events, child.id);\n    });\n}\n//# sourceMappingURL=FileActions.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/FileActions.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/FileCalculationContextFactories.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/FileCalculationContextFactories.js ***!
  \*********************************************************************************************/
/*! exports provided: createFormulaLibrary, createCalculationContext, createPrecalculatedContext, createCalculationContextFromState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFormulaLibrary\", function() { return createFormulaLibrary; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContext\", function() { return createCalculationContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedContext\", function() { return createPrecalculatedContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContextFromState\", function() { return createCalculationContextFromState; });\n/* harmony import */ var _FileCalculations__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FileCalculations */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js\");\n/* harmony import */ var _FileEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FileEvents */ \"./node_modules/@casual-simulation/aux-common/Files/FileEvents.js\");\n/* harmony import */ var _Formulas_EvalSandbox__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Formulas/EvalSandbox */ \"./node_modules/@casual-simulation/aux-common/Formulas/EvalSandbox.js\");\n/* harmony import */ var _Formulas_formula_lib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Formulas/formula-lib */ \"./node_modules/@casual-simulation/aux-common/Formulas/formula-lib.js\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid/v4 */ \"uuid/v4\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(uuid_v4__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\n\n\n\n\n\n\n\n/**\n * Creates a new formula library.\n */\nfunction createFormulaLibrary(options) {\n    const defaultOptions = {\n        config: { isBuilder: false, isPlayer: false },\n    };\n    const finalOptions = Object(_utils__WEBPACK_IMPORTED_MODULE_6__[\"merge\"])(defaultOptions, options);\n    return Object.assign({}, _Formulas_formula_lib__WEBPACK_IMPORTED_MODULE_3__[\"default\"], { isDesigner: finalOptions.config.isBuilder, isPlayer: finalOptions.config.isPlayer });\n}\n/**\n * Creates a new file calculation context.\n * @param objects The objects that should be included in the context.\n * @param lib The library JavaScript that should be used.\n */\nfunction createCalculationContext(objects, userId = null, lib = _Formulas_formula_lib__WEBPACK_IMPORTED_MODULE_3__[\"default\"], createSandbox = lib => new _Formulas_EvalSandbox__WEBPACK_IMPORTED_MODULE_2__[\"EvalSandbox\"](lib)) {\n    const context = {\n        sandbox: createSandbox(lib),\n        objects: objects,\n    };\n    context.sandbox.interface = new SandboxInterfaceImpl(context, userId);\n    return context;\n}\nfunction createPrecalculatedContext(objects) {\n    const context = {\n        objects: objects,\n    };\n    return context;\n}\n/**\n * Creates a new file calculation context from the given files state.\n * @param state The state to use.\n * @param includeDestroyed Whether to include destroyed files in the context.\n */\nfunction createCalculationContextFromState(state, includeDestroyed = false, createSandbox) {\n    const objects = includeDestroyed ? Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"values\"])(state) : Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"getActiveObjects\"])(state);\n    return createCalculationContext(objects, undefined, undefined, createSandbox);\n}\nclass SandboxInterfaceImpl {\n    constructor(context, userId) {\n        this.objects = Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"sortBy\"])(context.objects, 'id');\n        this.context = context;\n        this._userId = userId;\n        this._fileMap = new Map();\n    }\n    /**\n     * Adds the given file to the calculation context and returns a proxy for it.\n     * @param file The file to add.\n     */\n    addFile(file) {\n        const index = Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"sortedIndexBy\"])(this.objects, file, f => f.id);\n        this.objects.splice(index, 0, file);\n        return file;\n    }\n    /**\n     * Removes the given file from the calculation context.\n     * @param file The file to remove.\n     */\n    removeFile(id) {\n        const index = Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"sortedIndexBy\"])(this.objects, { id }, f => f.id);\n        this.objects.splice(index, 1);\n    }\n    listTagValues(tag, filter, extras) {\n        const tags = this.objects\n            .map(o => this._calculateValue(o, tag))\n            .filter(t => Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"hasValue\"])(t));\n        const filtered = this._filterValues(tags, filter);\n        return filtered;\n    }\n    listObjectsWithTag(tag, filter, extras) {\n        const objs = this.objects.filter(o => Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"hasValue\"])(this._calculateValue(o, tag)));\n        const filtered = this._filterObjects(objs, filter, tag);\n        return filtered;\n    }\n    list(obj, context) {\n        if (!context) {\n            return [];\n        }\n        const x = obj[`${context}.x`];\n        const y = obj[`${context}.y`];\n        if (typeof x !== 'number' || typeof y !== 'number') {\n            return [];\n        }\n        const objs = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"objectsAtContextGridPosition\"])(this.context, context, {\n            x,\n            y,\n        });\n        return objs;\n    }\n    uuid() {\n        return uuid_v4__WEBPACK_IMPORTED_MODULE_4___default()();\n    }\n    userId() {\n        return this._userId;\n    }\n    getTag(file, tag) {\n        const tags = this._getFileTags(file.id);\n        if (tags.hasOwnProperty(tag)) {\n            return tags[tag];\n        }\n        return Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"calculateFileValue\"])(this.context, file, tag);\n    }\n    setTag(file, tag, value) {\n        const tags = this._getFileTags(file.id);\n        tags[tag] = value;\n        return value;\n    }\n    getFileUpdates() {\n        const files = [...this._fileMap.entries()];\n        const updates = files\n            .filter(f => {\n            return Object.keys(f[1]).length > 0;\n        })\n            .map(f => Object(_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileUpdated\"])(f[0], {\n            tags: f[1],\n        }));\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"sortBy\"])(updates, u => u.id);\n    }\n    _filterValues(values, filter) {\n        if (filter) {\n            if (typeof filter === 'function') {\n                return values.filter(filter);\n            }\n            else {\n                return values.filter(t => t === filter);\n            }\n        }\n        else {\n            return values;\n        }\n    }\n    _filterObjects(objs, filter, tag) {\n        if (filter) {\n            if (typeof filter === 'function') {\n                return objs.filter(o => filter(this._calculateValue(o, tag)));\n            }\n            else {\n                return objs.filter(o => this._calculateValue(o, tag) == filter);\n            }\n        }\n        else {\n            return objs;\n        }\n    }\n    _calculateValue(object, tag) {\n        return Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"calculateFileValue\"])(this.context, object, tag);\n    }\n    _getFileTags(id) {\n        if (this._fileMap.has(id)) {\n            return this._fileMap.get(id);\n        }\n        const tags = {};\n        this._fileMap.set(id, tags);\n        return tags;\n    }\n}\n//# sourceMappingURL=FileCalculationContextFactories.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/FileCalculationContextFactories.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js ***!
  \******************************************************************************/
/*! exports provided: isFormulaObjectSymbol, ShortId_Length, COMBINE_ACTION_NAME, DIFF_ACTION_NAME, CREATE_ACTION_NAME, DESTROY_ACTION_NAME, DROP_IN_CONTEXT_ACTION_NAME, DROP_ANY_IN_CONTEXT_ACTION_NAME, DRAG_OUT_OF_CONTEXT_ACTION_NAME, DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME, DRAG_OUT_OF_INVENTORY_ACTION_NAME, DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME, DROP_IN_INVENTORY_ACTION_NAME, DROP_ANY_IN_INVENTORY_ACTION_NAME, ON_QR_CODE_SCANNED_ACTION_NAME, ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME, ON_QR_CODE_SCANNER_OPENED_ACTION_NAME, DEFAULT_ENERGY, hasValue, cleanFile, isMinimized, isContext, isVisibleContext, filterFilesBySelection, fileTags, getAllFileTags, filesFromShortIds, fileFromShortId, getShortId, isHiddenTag, isPrecalculated, calculateFileValue, calculateFormattedFileValue, isFormula, isAssignment, containsFormula, isArray, parseArray, isNumber, isFile, getActiveObjects, isFilterTag, isTagWellKnown, doFilesAppearEqual, validateTag, selectionIdForUser, updateUserSelection, toggleFileSelection, newSelectionId, getUserFileColor, getUserMenuId, getFilesInMenu, getUserAccountFile, getTokensForUserAccount, findMatchingToken, getFileRoles, filesInContext, addToContextDiff, removeFromContextDiff, setPositionDiff, addFileToMenu, removeFileFromMenu, tagsOnFile, getTag, getFileTag, createContextId, createFile, createPrecalculatedFile, createWorkspace, updateFile, calculateGridScale, calculateStateDiff, trimTag, filtersMatchingArguments, filterMatchesArguments, isInUsernameList, getFileUsernameList, getFileStringList, whitelistOrBlacklistAllowsAccess, whitelistAllowsAccess, blacklistAllowsAccess, getFileWhitelist, getFileBlacklist, getFileDesignerList, getFileVersion, getFileIndex, getFilePosition, getFileRotation, getFileInputTarget, getFileInputPlaceholder, getFileShape, getFileLabelAnchor, isConfigForContext, isContextLocked, getFileConfigContexts, getContextValue, getFileDragMode, isFileStackable, isFileMovable, isFileListening, isContextMovable, getContextPosition, getContextRotation, getContextMinimized, getContextColor, getContextSize, getContextVisualizeMode, getBuilderContextGrid, getContextGridHeight, getContextGridScale, getContextScale, getContextDefaultHeight, objectsAtContextGridPosition, isUserFile, objectsAtWorkspace, duplicateFile, filterWellKnownAndContextTags, getContexts, isWellKnownOrContext, isDiff, isMergeable, isPickupable, getDiffUpdate, getDiffTags, simulationIdToString, parseSimulationId, normalizeAUXFileURL, parseFilterTag, getUserMode, getSelectionMode, calculateFileValueAsFile, calculateStringListTagValue, calculateNumericalTagValue, calculateBooleanTagValue, isDestroyable, isEditable, isSimulation, getFileChannel, getChannelFileById, getChannelConnectedDevices, getChannelMaxDevicesAllowed, getMaxDevicesAllowed, getConnectedDevices, isFileInContext, fileContextSortOrder, calculateFormulaValue, isUserActive, shouldDeleteUser, formatValue, calculateValue, calculateCopiableValue, convertToCopiableValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFormulaObjectSymbol\", function() { return isFormulaObjectSymbol; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShortId_Length\", function() { return ShortId_Length; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"COMBINE_ACTION_NAME\", function() { return COMBINE_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DIFF_ACTION_NAME\", function() { return DIFF_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CREATE_ACTION_NAME\", function() { return CREATE_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DESTROY_ACTION_NAME\", function() { return DESTROY_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_CONTEXT_ACTION_NAME\", function() { return DROP_IN_CONTEXT_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_CONTEXT_ACTION_NAME\", function() { return DROP_ANY_IN_CONTEXT_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_CONTEXT_ACTION_NAME\", function() { return DRAG_OUT_OF_CONTEXT_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME\", function() { return DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_INVENTORY_ACTION_NAME\", function() { return DRAG_OUT_OF_INVENTORY_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME\", function() { return DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_INVENTORY_ACTION_NAME\", function() { return DROP_IN_INVENTORY_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_INVENTORY_ACTION_NAME\", function() { return DROP_ANY_IN_INVENTORY_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNED_ACTION_NAME\", function() { return ON_QR_CODE_SCANNED_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME\", function() { return ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_OPENED_ACTION_NAME\", function() { return ON_QR_CODE_SCANNER_OPENED_ACTION_NAME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_ENERGY\", function() { return DEFAULT_ENERGY; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasValue\", function() { return hasValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cleanFile\", function() { return cleanFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMinimized\", function() { return isMinimized; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isContext\", function() { return isContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isVisibleContext\", function() { return isVisibleContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filterFilesBySelection\", function() { return filterFilesBySelection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileTags\", function() { return fileTags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAllFileTags\", function() { return getAllFileTags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filesFromShortIds\", function() { return filesFromShortIds; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileFromShortId\", function() { return fileFromShortId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getShortId\", function() { return getShortId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isHiddenTag\", function() { return isHiddenTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPrecalculated\", function() { return isPrecalculated; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValue\", function() { return calculateFileValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFormattedFileValue\", function() { return calculateFormattedFileValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFormula\", function() { return isFormula; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAssignment\", function() { return isAssignment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"containsFormula\", function() { return containsFormula; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isArray\", function() { return isArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parseArray\", function() { return parseArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isNumber\", function() { return isNumber; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFile\", function() { return isFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getActiveObjects\", function() { return getActiveObjects; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFilterTag\", function() { return isFilterTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTagWellKnown\", function() { return isTagWellKnown; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doFilesAppearEqual\", function() { return doFilesAppearEqual; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"validateTag\", function() { return validateTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"selectionIdForUser\", function() { return selectionIdForUser; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateUserSelection\", function() { return updateUserSelection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toggleFileSelection\", function() { return toggleFileSelection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"newSelectionId\", function() { return newSelectionId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUserFileColor\", function() { return getUserFileColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUserMenuId\", function() { return getUserMenuId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFilesInMenu\", function() { return getFilesInMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUserAccountFile\", function() { return getUserAccountFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTokensForUserAccount\", function() { return getTokensForUserAccount; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findMatchingToken\", function() { return findMatchingToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileRoles\", function() { return getFileRoles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filesInContext\", function() { return filesInContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addToContextDiff\", function() { return addToContextDiff; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeFromContextDiff\", function() { return removeFromContextDiff; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setPositionDiff\", function() { return setPositionDiff; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addFileToMenu\", function() { return addFileToMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeFileFromMenu\", function() { return removeFileFromMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tagsOnFile\", function() { return tagsOnFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTag\", function() { return getTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileTag\", function() { return getFileTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createContextId\", function() { return createContextId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFile\", function() { return createFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedFile\", function() { return createPrecalculatedFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createWorkspace\", function() { return createWorkspace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateFile\", function() { return updateFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateGridScale\", function() { return calculateGridScale; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateStateDiff\", function() { return calculateStateDiff; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"trimTag\", function() { return trimTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filtersMatchingArguments\", function() { return filtersMatchingArguments; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filterMatchesArguments\", function() { return filterMatchesArguments; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isInUsernameList\", function() { return isInUsernameList; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileUsernameList\", function() { return getFileUsernameList; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileStringList\", function() { return getFileStringList; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"whitelistOrBlacklistAllowsAccess\", function() { return whitelistOrBlacklistAllowsAccess; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"whitelistAllowsAccess\", function() { return whitelistAllowsAccess; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"blacklistAllowsAccess\", function() { return blacklistAllowsAccess; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileWhitelist\", function() { return getFileWhitelist; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileBlacklist\", function() { return getFileBlacklist; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileDesignerList\", function() { return getFileDesignerList; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileVersion\", function() { return getFileVersion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileIndex\", function() { return getFileIndex; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFilePosition\", function() { return getFilePosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileRotation\", function() { return getFileRotation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileInputTarget\", function() { return getFileInputTarget; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileInputPlaceholder\", function() { return getFileInputPlaceholder; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileShape\", function() { return getFileShape; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileLabelAnchor\", function() { return getFileLabelAnchor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isConfigForContext\", function() { return isConfigForContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isContextLocked\", function() { return isContextLocked; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileConfigContexts\", function() { return getFileConfigContexts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextValue\", function() { return getContextValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileDragMode\", function() { return getFileDragMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFileStackable\", function() { return isFileStackable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFileMovable\", function() { return isFileMovable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFileListening\", function() { return isFileListening; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isContextMovable\", function() { return isContextMovable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextPosition\", function() { return getContextPosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextRotation\", function() { return getContextRotation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextMinimized\", function() { return getContextMinimized; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextColor\", function() { return getContextColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextSize\", function() { return getContextSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextVisualizeMode\", function() { return getContextVisualizeMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getBuilderContextGrid\", function() { return getBuilderContextGrid; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextGridHeight\", function() { return getContextGridHeight; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextGridScale\", function() { return getContextGridScale; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextScale\", function() { return getContextScale; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextDefaultHeight\", function() { return getContextDefaultHeight; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"objectsAtContextGridPosition\", function() { return objectsAtContextGridPosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isUserFile\", function() { return isUserFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"objectsAtWorkspace\", function() { return objectsAtWorkspace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"duplicateFile\", function() { return duplicateFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filterWellKnownAndContextTags\", function() { return filterWellKnownAndContextTags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContexts\", function() { return getContexts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isWellKnownOrContext\", function() { return isWellKnownOrContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDiff\", function() { return isDiff; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMergeable\", function() { return isMergeable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPickupable\", function() { return isPickupable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDiffUpdate\", function() { return getDiffUpdate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDiffTags\", function() { return getDiffTags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"simulationIdToString\", function() { return simulationIdToString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parseSimulationId\", function() { return parseSimulationId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"normalizeAUXFileURL\", function() { return normalizeAUXFileURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parseFilterTag\", function() { return parseFilterTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUserMode\", function() { return getUserMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSelectionMode\", function() { return getSelectionMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValueAsFile\", function() { return calculateFileValueAsFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateStringListTagValue\", function() { return calculateStringListTagValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateNumericalTagValue\", function() { return calculateNumericalTagValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateBooleanTagValue\", function() { return calculateBooleanTagValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDestroyable\", function() { return isDestroyable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEditable\", function() { return isEditable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSimulation\", function() { return isSimulation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileChannel\", function() { return getFileChannel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getChannelFileById\", function() { return getChannelFileById; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getChannelConnectedDevices\", function() { return getChannelConnectedDevices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getChannelMaxDevicesAllowed\", function() { return getChannelMaxDevicesAllowed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMaxDevicesAllowed\", function() { return getMaxDevicesAllowed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getConnectedDevices\", function() { return getConnectedDevices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFileInContext\", function() { return isFileInContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileContextSortOrder\", function() { return fileContextSortOrder; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaValue\", function() { return calculateFormulaValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isUserActive\", function() { return isUserActive; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shouldDeleteUser\", function() { return shouldDeleteUser; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"formatValue\", function() { return formatValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateValue\", function() { return calculateValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateCopiableValue\", function() { return calculateCopiableValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"convertToCopiableValue\", function() { return convertToCopiableValue; });\n/* harmony import */ var _File__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./File */ \"./node_modules/@casual-simulation/aux-common/Files/File.js\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid/v4 */ \"uuid/v4\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(uuid_v4__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Formulas/formula-lib-globals */ \"./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\n\n\n\n/// <reference path=\"../typings/global.d.ts\" />\n\n\nvar isFormulaObjectSymbol = Symbol('isFormulaObject');\nvar ShortId_Length = 5;\n/**\n * The name of the event that represents two files getting combined.\n */\nconst COMBINE_ACTION_NAME = 'onCombine';\n/**\n * The name of the event that represents a file being diffed into another file.\n */\nconst DIFF_ACTION_NAME = 'onMerge';\n/**\n * The name of the event that represents a file being created.\n */\nconst CREATE_ACTION_NAME = 'onCreate';\n/**\n * The name of the event that represents a file being destroyed.\n */\nconst DESTROY_ACTION_NAME = 'onDestroy';\n/**\n * The name of the event that represents a file being dragged into a context.\n */\nconst DROP_IN_CONTEXT_ACTION_NAME = 'onDropInContext';\n/**\n * The name of the event that represents any file being dragged into a context.\n */\nconst DROP_ANY_IN_CONTEXT_ACTION_NAME = 'onAnyDropInContext';\n/**\n * The name of the event that represents a file being dragged out of a context.\n */\nconst DRAG_OUT_OF_CONTEXT_ACTION_NAME = 'onDragOutOfContext';\n/**\n * The name of the event that represents any file being dragged out of a context.\n */\nconst DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME = 'onAnyDragOutOfContext';\n/**\n * The name of the event that represents a file being dragged out of the user's inventory.\n */\nconst DRAG_OUT_OF_INVENTORY_ACTION_NAME = 'onDragOutOfInventory';\n/**\n * The name of the event that represents any file being dragged out of the user's inventory.\n */\nconst DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME = 'onAnyDragOutOfInventory';\n/**\n * The name of the event that represents a file being dropped into the user's inventory.\n */\nconst DROP_IN_INVENTORY_ACTION_NAME = 'onDropInInventory';\n/**\n * The name of the event that represents any file being dropped into the user's inventory.\n */\nconst DROP_ANY_IN_INVENTORY_ACTION_NAME = 'onAnyDropInInventory';\n/**\n * The name of the event that is triggered when a QR Code is scanned.\n */\nconst ON_QR_CODE_SCANNED_ACTION_NAME = 'onQRCodeScanned';\n/**\n * The name of the event that is triggered when the QR Code scanner is closed.\n */\nconst ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME = 'onQRCodeScannerClosed';\n/**\n * The name of the event that is triggered when the QR Code scanner is opened.\n */\nconst ON_QR_CODE_SCANNER_OPENED_ACTION_NAME = 'onQRCodeScannerOpened';\nconst DEFAULT_ENERGY = 100000;\n/**\n * Determines whether the given tag value is a valid value or if\n * it represents nothing.\n * @param value The value.\n */\nfunction hasValue(value) {\n    return !(value === null || typeof value === 'undefined' || value === '');\n}\n/**\n * Cleans the file by removing any null or undefined properties.\n * @param file The file to clean.\n */\nfunction cleanFile(file) {\n    let cleaned = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"merge\"])({}, file);\n    // Make sure we're not modifying another file's tags\n    let newTags = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"merge\"])({}, cleaned.tags);\n    cleaned.tags = newTags;\n    for (let property in cleaned.tags) {\n        let value = cleaned.tags[property];\n        if (!hasValue(value)) {\n            delete cleaned.tags[property];\n        }\n    }\n    return cleaned;\n}\n/**\n * Determines if the given workspace is currently minimized.\n * @param workspace The workspace.\n */\nfunction isMinimized(calc, workspace) {\n    return getContextMinimized(calc, workspace);\n}\n/**\n * Determines if the given file contains data for a context.\n */\nfunction isContext(calc, contextFile) {\n    return getFileConfigContexts(calc, contextFile).length > 0;\n}\n/**\n * Determines if the given context file is being visualized in the viewport.\n */\nfunction isVisibleContext(calc, contextFile) {\n    const result = calculateFileValue(calc, contextFile, 'aux.context.visualize');\n    if (typeof result === 'string' && hasValue(result)) {\n        return true;\n    }\n    else if (Array.isArray(result)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Filters the given list of files by whether they belong to the given selection.\n * @param files The files to filter.\n * @param selectionId The selection to check.\n */\nfunction filterFilesBySelection(files, selectionId) {\n    return files.filter(f => {\n        if (f.id === selectionId) {\n            return true;\n        }\n        for (let prop in f.tags) {\n            const val = f.tags[prop];\n            if (prop === selectionId && val) {\n                return true;\n            }\n        }\n        return false;\n    });\n}\n/**\n * Gets a list of tags that the given files contain.\n *\n * @param files The array of files that the list of tags should be retrieved\n * for.\n * @param currentTags The current array of tags that is being displayed.\n *                    The new list will try to preserve the order of the tags\n * in this list.\n * @param extraTags The list of tags that should not be removed from the\n * output list.\n * @param includeHidden Whether the hidden tags should be included in the output.\n */\nfunction fileTags(files, currentTags, extraTags, includeHidden = false, tagBlacklist = []) {\n    const fileTags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(files, f => Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(f.tags));\n    // Only keep tags that don't start with an underscore (_)\n    const nonHiddenTags = fileTags.filter(t => includeHidden || !isHiddenTag(t));\n    const tagsToKeep = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"union\"])(nonHiddenTags, extraTags);\n    const allTags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"union\"])(currentTags, tagsToKeep);\n    const onlyTagsToKeep = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"intersection\"])(allTags, tagsToKeep);\n    // if there is a blacklist index and the  first index [all] is not selected\n    if (tagBlacklist != undefined && tagBlacklist.length > 0) {\n        let filteredTags = [];\n        for (let i = tagBlacklist.length - 1; i >= 0; i--) {\n            if (!tagBlacklist[i][1]) {\n                for (let j = 2; j < tagBlacklist[i].length; j++) {\n                    for (let k = onlyTagsToKeep.length - 1; k >= 0; k--) {\n                        if (onlyTagsToKeep[k] === tagBlacklist[i][j]) {\n                            onlyTagsToKeep.splice(k, 1);\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        return onlyTagsToKeep;\n    }\n    else {\n        return onlyTagsToKeep;\n    }\n}\nfunction getAllFileTags(files, includeHidden) {\n    const fileTags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(files, f => Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(f.tags));\n    const nonHiddenTags = fileTags.filter(t => includeHidden || !isHiddenTag(t));\n    return nonHiddenTags;\n}\n/**\n * Find files that match the short ids.\n * @param files The files to search through.\n * @param shortIds The short ids to search for.\n * @returns file array or null if no matches found.\n */\nfunction filesFromShortIds(files, shortIds) {\n    var matches = [];\n    shortIds.forEach(shortId => {\n        var file = this.fileFromShortId(files, shortId);\n        if (file)\n            matches.push(file);\n    });\n    if (matches.length > 0)\n        return matches;\n    else\n        return null;\n}\n/**\n * Find file that matches the short id.\n * @param files The files to search through.\n * @param shortId The short id to search for.\n * @returns file or undefined if no match found.\n */\nfunction fileFromShortId(files, shortId) {\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"find\"])(files, (f) => {\n        return getShortId(f) === shortId;\n    });\n}\n/**\n * Return the short id for the file.\n * @param file The file to get short id for.\n */\nfunction getShortId(file) {\n    let str = file.id.substr(0, ShortId_Length);\n    if (file.id.startsWith('mod-')) {\n        str = 'mod';\n    }\n    if (file.id.startsWith('config')) {\n        str = 'config';\n    }\n    return str;\n}\n/**\n * Determines if the given tag is a hidden tag.\n * @param tag The tag to test.\n */\nfunction isHiddenTag(tag) {\n    return /^_/.test(tag) || /(\\w+)\\._/.test(tag);\n}\nfunction isPrecalculated(file) {\n    return file && file.precalculated === true;\n}\nfunction calculateFileValue(context, object, tag, unwrapProxy) {\n    if (tag === 'id') {\n        return object.id;\n    }\n    else if (isPrecalculated(object)) {\n        return object.values[tag];\n    }\n    else {\n        return calculateValue(context, object, tag, object.tags[tag], unwrapProxy);\n    }\n}\nfunction calculateFormattedFileValue(context, file, tag) {\n    const value = calculateFileValue(context, file, tag);\n    return formatValue(value);\n}\n/**\n * Determines if the given value represents a formula.\n */\nfunction isFormula(value) {\n    return typeof value === 'string' && value.indexOf('=') === 0;\n}\n/**\n * Determines if the given value represents an assignment.\n */\nfunction isAssignment(object) {\n    return typeof object === 'object' && object && !!object._assignment;\n}\n/**\n * Determines if the given value contains a formula.\n * This is different from isFormula() because it checks arrays for containing formulas in their elements.\n * @param value The value to check.\n */\nfunction containsFormula(value) {\n    return (isFormula(value) ||\n        (isArray(value) && Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"some\"])(parseArray(value), v => isFormula(v))));\n}\n/**\n * Determines if the given string value represents an array.\n */\nfunction isArray(value) {\n    return (typeof value === 'string' &&\n        value.indexOf('[') === 0 &&\n        value.lastIndexOf(']') === value.length - 1);\n}\n/**\n * Parses the given string value that represents an array into an actual array.\n * @see isArray\n */\nfunction parseArray(value) {\n    var array = value.slice(1, value.length - 1).split(',');\n    if (array && array.length > 0 && array[0].length > 0) {\n        // trim all entries.\n        return array.map(s => {\n            return s.trim();\n        });\n    }\n    else {\n        return [];\n    }\n}\n/**\n * Determines if the given value represents a number.\n */\nfunction isNumber(value) {\n    return (typeof value === 'string' &&\n        value.length > 0 &&\n        (/^-?\\d*(?:\\.?\\d+)?$/.test(value) ||\n            (typeof value === 'string' && 'infinity' === value.toLowerCase())));\n}\n/**\n * Determines if the given object is a file.\n * @param object The object to check.\n */\nfunction isFile(object) {\n    if (object) {\n        return !!object.id && !!object.tags;\n    }\n    return false;\n}\n/**\n * Gets the array of objects in the given state that are currently active.\n * @param state The state to get the active objects of.\n */\nfunction getActiveObjects(state) {\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"values\"])(state);\n}\n/**\n * Determines if the given tag matches the filter syntax.\n */\nfunction isFilterTag(tag) {\n    const parsed = parseFilterTag(tag);\n    return parsed.success;\n}\n/**\n * Determines if the given tag is \"well known\".\n * @param tag The tag.\n */\nfunction isTagWellKnown(tag) {\n    return isHiddenTag(tag);\n}\n/**\n * Determines if the files are equal disregarding well-known hidden tags\n * and their IDs. File \"appearance equality\" means instead of asking \"are these files exactly the same?\"\n * we ask \"are these files functionally the same?\". In this respect we care about things like color, label, etc.\n * We also care about things like aux.movable but not _position, _index _selection, etc.\n *\n * Well-known hidden tags include:\n * - aux._selection\n * - context._index\n *\n * You can determine if a tag is \"well-known\" by using isWellKnownTag().\n * @param first The first file.\n * @param second The second file.\n */\nfunction doFilesAppearEqual(first, second, options = {}) {\n    if (first === second) {\n        return true;\n    }\n    else if (!first || !second) {\n        return false;\n    }\n    options = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"merge\"])({\n        ignoreSelectionTags: true,\n        ignoreId: false,\n    }, options);\n    if (!options.ignoreId && first.id === second.id) {\n        return true;\n    }\n    const tags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"union\"])(Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(first.tags), Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(second.tags));\n    const usableTags = tags.filter(t => !isTagWellKnown(t));\n    let allEqual = true;\n    for (let t of usableTags) {\n        if (!Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"isEqual\"])(first.tags[t], second.tags[t])) {\n            allEqual = false;\n            break;\n        }\n    }\n    return allEqual;\n}\n/**\n * Validates the given tag and returns any errors for it.\n * @param tag The tag.\n */\nfunction validateTag(tag) {\n    let errors = {\n        valid: true,\n    };\n    if (!tag || !tag.trim()) {\n        errors.valid = false;\n        errors['tag.required'] = {};\n    }\n    else {\n        const filter = parseFilterTag(tag);\n        if (!(filter.success ||\n            (filter.success === false && filter.partialSuccess)) &&\n            tag.indexOf('#') >= 0) {\n            errors.valid = false;\n            errors['tag.invalidChar'] = { char: '#' };\n        }\n    }\n    return errors;\n}\n/**\n * Gets the ID of the selection that the user is using.\n * If the user doesn't have a selection, returns a new selection ID.\n * @param user The user's file.\n */\nfunction selectionIdForUser(user) {\n    if (user && user.tags['aux._selection']) {\n        return { id: user.tags['aux._selection'] || null, newId: null };\n    }\n    else {\n        const id = newSelectionId();\n        return { id: id, newId: id };\n    }\n}\n/**\n * Gets a partial file that updates a user's file to reference the given selection.\n * @param selectionId The ID of the selection.\n * @param fileId The ID of the file that is being selected.\n */\nfunction updateUserSelection(selectionId, fileId) {\n    return {\n        tags: {\n            ['aux._selection']: selectionId,\n            ['aux._editingFile']: fileId,\n        },\n    };\n}\n/**\n * Gets a partial file that toggles whether the given file is apart of the given selection.\n * @param file The file.\n * @param selectionId The ID of the selection.\n * @param userId The User that is adding the file to the selection.\n */\nfunction toggleFileSelection(file, selectionId, userId) {\n    return {\n        tags: {\n            [selectionId]: !file.tags[selectionId],\n        },\n    };\n}\n/**\n * Creates a new selection id.\n */\nfunction newSelectionId() {\n    return `aux._selection_${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"shortUuid\"])()}`;\n}\n/**\n * Gets the color that the given user file should appear as.\n * @param calc The file calculation context.\n * @param userFile The user file.\n * @param globalsFile The globals file.\n * @param domain The domain.\n */\nfunction getUserFileColor(calc, userFile, globalsFile, domain) {\n    if (userFile.tags['aux.color']) {\n        return calculateFileValue(calc, userFile, 'aux.color');\n    }\n    if (domain === 'builder') {\n        return (calculateFileValue(calc, globalsFile, 'aux.scene.user.builder.color') || _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_BUILDER_USER_COLOR\"]);\n    }\n    else {\n        return (calculateFileValue(calc, globalsFile, 'aux.scene.user.player.color') || _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_PLAYER_USER_COLOR\"]);\n    }\n}\n/**\n * Gets the menu ID that is used for the given user.\n * @param userFile The file for the user.\n */\nfunction getUserMenuId(calc, userFile) {\n    return calculateFileValue(calc, userFile, 'aux._userMenuContext');\n}\n/**\n * Gets the list of files that are in the user's menu.\n * @param calc The file calculation context.\n * @param userFile The user file to use.\n */\nfunction getFilesInMenu(calc, userFile) {\n    const context = getUserMenuId(calc, userFile);\n    return filesInContext(calc, context);\n}\n/**\n * Gets the user account file for the given user.\n * @param calc The file calculation context.\n * @param username The username.\n */\nfunction getUserAccountFile(calc, username) {\n    const userFiles = calc.objects.filter(o => calculateFileValue(calc, o, 'aux.account.username') === username);\n    if (userFiles.length > 0) {\n        return userFiles[0];\n    }\n    return null;\n}\n/**\n * Gets the list of token files that match the given username.\n */\nfunction getTokensForUserAccount(calc, username) {\n    return calc.objects.filter(o => calculateFileValue(calc, o, 'aux.token.username') === username);\n}\n/**\n * Finds the first file in the given list of files that matches the token.\n * @param calc The file calculation context.\n * @param files The files to filter.\n * @param token The token to search for.\n */\nfunction findMatchingToken(calc, files, token) {\n    const tokens = files.filter(o => calculateFileValue(calc, o, 'aux.token') === token);\n    if (tokens.length > 0) {\n        return tokens[0];\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Gets the list of roles stored in the aux.account.roles tag.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileRoles(calc, file) {\n    const list = getFileStringList(calc, file, 'aux.account.roles');\n    return new Set(list);\n}\n/**\n * Gets the list of files that are in the given context.\n * @param calc The file calculation context.\n * @param context The context to search for files in.\n */\nfunction filesInContext(calc, context) {\n    const files = calc.objects.filter(f => isFileInContext(calc, f, context));\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(files, f => fileContextSortOrder(calc, f, context));\n}\n/**\n * Gets a diff that adds a file to the given context.\n * If the file is already in the context, then nothing happens.\n * If other files are already at the given position, then the file will be placed at the topmost index.\n * @param calc The file calculation context.\n * @param context The context that the file should be added to.\n * @param x The x position that the file should be placed at.\n * @param y The x position in the context that the file should be placed at.\n * @param index The index that the file should be placed at.\n */\nfunction addToContextDiff(calc, context, x = 0, y = 0, index) {\n    const files = objectsAtContextGridPosition(calc, context, { x, y });\n    return Object.assign({ [context]: true }, setPositionDiff(calc, context, x, y, typeof index === 'undefined' ? files.length : index));\n}\n/**\n * Gets a diff that removes a file from the given context.\n * @param calc The file calculation context.\n * @param context The context that the file should be removed from.\n */\nfunction removeFromContextDiff(calc, context) {\n    return {\n        [context]: null,\n        [`${context}.x`]: null,\n        [`${context}.y`]: null,\n        [`${context}.index`]: null,\n    };\n}\n/**\n * Gets a diff that sets a file's position in the given context.\n * @param calc The file calculation context.\n * @param context The context.\n * @param x The X position.\n * @param y The Y position.\n * @param index The index.\n */\nfunction setPositionDiff(calc, context, x, y, index) {\n    let tags = {};\n    if (typeof x === 'number') {\n        tags[`${context}.x`] = x;\n    }\n    if (typeof y === 'number') {\n        tags[`${context}.y`] = y;\n    }\n    if (typeof index === 'number') {\n        tags[`${context}.index`] = index;\n    }\n    return tags;\n}\n/**\n * Gets the file update needed to add the given file to the given user's menu.\n * @param calc The calculation context.\n * @param userFile The file of the user.\n * @param id The ID that should be used for the menu item. This is separate from file ID.\n * @param index The index that the file should be added to. Positive infinity means add at the end. 0 means add at the beginning.\n */\nfunction addFileToMenu(calc, userFile, id, index = Infinity) {\n    const context = getUserMenuId(calc, userFile);\n    const files = getFilesInMenu(calc, userFile);\n    const idx = isFinite(index) ? index : files.length;\n    return {\n        tags: {\n            [`${context}.id`]: id,\n            [`${context}.index`]: idx,\n            [context]: true,\n        },\n    };\n}\n/**\n * Gets the file update needed to remove a file from the given user's menu.\n * @param calc The file calculation context.\n * @param userFile The file of the user.\n */\nfunction removeFileFromMenu(calc, userFile) {\n    const context = getUserMenuId(calc, userFile);\n    return {\n        tags: {\n            [context]: null,\n            [`${context}.id`]: null,\n            [`${context}.index`]: null,\n        },\n    };\n}\n/**\n * Gets the list of tags that are on the given file.\n * @param file\n */\nfunction tagsOnFile(file) {\n    let tags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(file.tags);\n    return tags;\n}\n/**\n * Gets the specified tag value from the specified file.\n * @param file The file that the tag should be retrieved from.\n * @param tag The tag to retrieve.\n */\nfunction getTag(file, tag) {\n    return file.tags[tag];\n}\n/**\n * Gets the specified tag from the specified file.\n * @param file The file that the tag should be retrieved from.\n * @param tag The tag to retrieve.\n */\nfunction getFileTag(file, tag) {\n    return getTag(file, tag);\n}\n/**\n * Creates a new context ID.\n */\nfunction createContextId() {\n    return `${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"shortUuid\"])()}`;\n}\n/**\n * Creates a file with a new ID and the given tags.\n * @param id\n * @param tags\n */\nfunction createFile(id = uuid_v4__WEBPACK_IMPORTED_MODULE_1___default()(), tags = {}) {\n    const file = { id: id, tags: tags };\n    return file;\n}\nfunction createPrecalculatedFile(id = uuid_v4__WEBPACK_IMPORTED_MODULE_1___default()(), values = {}, tags) {\n    return {\n        id: id,\n        precalculated: true,\n        tags: tags || values,\n        values: values,\n    };\n}\n/**\n * Creates a new Workspace with default values.\n * @param id The ID of the new workspace.\n * @param builderContextId The tag that should be used for contexts stored on this workspace.\n * @param locked Whether the context is allowed to be accessed via AUX Player.\n */\nfunction createWorkspace(id = uuid_v4__WEBPACK_IMPORTED_MODULE_1___default()(), builderContextId = createContextId(), locked = false) {\n    // checks if given context string is empty or just whitespace\n    if (builderContextId.length === 0 || /^\\s*$/.test(builderContextId)) {\n        builderContextId = createContextId();\n    }\n    if (locked) {\n        return {\n            id: id,\n            tags: {\n                'aux.context.x': 0,\n                'aux.context.y': 0,\n                'aux.context.z': 0,\n                'aux.context.visualize': 'surface',\n                'aux.context.locked': true,\n                'aux.context': builderContextId,\n            },\n        };\n    }\n    else {\n        return {\n            id: id,\n            tags: {\n                'aux.context.x': 0,\n                'aux.context.y': 0,\n                'aux.context.z': 0,\n                'aux.context.visualize': 'surface',\n                'aux.context': builderContextId,\n            },\n        };\n    }\n}\n/**\n * Performs a pre-process step for updating the given file by nulling out falsy tags and also calculating assignments.\n * @param file The file to update.\n * @param userId The ID of the file whose user edited this file.\n * @param newData The new data to assign to the file.\n * @param createContext A function that, when called, returns a new FileCalculationContext that can be used to calculate formulas for assignment expressions.\n */\nfunction updateFile(file, userId, newData, createContext) {\n    if (newData.tags) {\n        if (userId) {\n            newData.tags['aux._lastEditedBy'] = userId;\n        }\n        // Cleanup/preprocessing\n        for (let property in newData.tags) {\n            let value = newData.tags[property];\n            if (value) {\n                if (_isAssignmentFormula(value)) {\n                    const assignment = _convertToAssignment(value);\n                    const result = _calculateFormulaValue(createContext(), file, property, assignment.formula);\n                    newData.tags[property] = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"assign\"])(assignment, {\n                        value: result.result,\n                    });\n                }\n            }\n        }\n    }\n}\n/**\n * Calculates the grid scale for the given workspace.\n * @param workspace\n */\nfunction calculateGridScale(calc, workspace) {\n    if (workspace) {\n        const scale = calculateNumericalTagValue(calc, workspace, `aux.context.surface.scale`, _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SCALE\"]);\n        const gridScale = calculateNumericalTagValue(calc, workspace, `aux.context.grid.scale`, _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_GRID_SCALE\"]);\n        return scale * gridScale;\n    }\n    else {\n        return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SCALE\"] * _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_GRID_SCALE\"];\n    }\n}\n/**\n * Calculates the difference between the two given states.\n * In particular, it calculates which operations need to be performed on prev in order to get current.\n * The returned object contains the files that were added, removed, and/or updated between the two states.\n * This operation runs in O(n) time where n is the number of files.\n * @param prev The previous state.\n * @param current The current state.\n * @param events If provided, this event will be used to help short-circut the diff calculation to be O(1) whenever the event is a 'file_added', 'file_removed', or 'file_updated' event.\n */\nfunction calculateStateDiff(prev, current, events) {\n    prev = prev || {};\n    current = current || {};\n    let diff = {\n        addedFiles: [],\n        removedFiles: [],\n        updatedFiles: [],\n    };\n    const ids = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"union\"])(Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(prev), Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(current));\n    ids.forEach(id => {\n        const prevVal = prev[id];\n        const currVal = current[id];\n        if (prevVal && !currVal) {\n            diff.removedFiles.push(prevVal.id);\n        }\n        else if (!prevVal && currVal) {\n            diff.addedFiles.push(currVal);\n        }\n        else if (!Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"isEqual\"])(prevVal, currVal)) {\n            diff.updatedFiles.push(currVal);\n        }\n    });\n    return diff;\n}\n/**\n * Trims the leading # symbol off the given tag.\n */\nfunction trimTag(tag) {\n    if (tag.indexOf('#') === 0) {\n        return tag.substring(1);\n    }\n    return tag;\n}\n/**\n * Gets a list of tags from the given object that match the given event name and arguments.\n * @param file The file to find the tags that match the arguments.\n * @param eventName The event name to test.\n * @param other The arguments to match against.\n */\nfunction filtersMatchingArguments(context, file, eventName, args) {\n    if (file === undefined) {\n        return;\n    }\n    const tags = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(file.tags);\n    return tags\n        .map(t => parseFilterTag(t))\n        .filter(t => filterMatchesArguments(context, t, eventName, args));\n}\n/**\n * Determines if the given tag matches the given object and event.\n * @param tag The tag.\n * @param file The file to test.\n * @param eventName The event to test for.\n */\nfunction filterMatchesArguments(context, filter, eventName, args) {\n    if (filter.success && filter.eventName === eventName) {\n        if (!!filter.filter) {\n            const arg = args.length > 0 ? args[0] : null;\n            if (arg) {\n                const calculatedValue = calculateFileValue(context, arg, filter.filter.tag);\n                return (calculatedValue === filter.filter.value ||\n                    (Array.isArray(filter.filter.value) &&\n                        Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"isEqual\"])(arg.tags[filter.filter.tag], filter.filter.value)));\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Determines if the given username is in the username list in the given file and tag.\n * @param calc The file calculation context.\n * @param file The file.\n * @param tag The tag.\n * @param username The username to check.\n */\nfunction isInUsernameList(calc, file, tag, username) {\n    const list = getFileUsernameList(calc, file, tag);\n    return list.indexOf(username) >= 0;\n}\n/**\n * Gets a list of usernames from the given file and tag.\n * @param calc The file calculation context.\n * @param file The file.\n * @param tag The tag.\n */\nfunction getFileUsernameList(calc, file, tag) {\n    let value = calculateFileValue(calc, file, tag);\n    if (value && !Array.isArray(value)) {\n        value = [value];\n    }\n    if (value) {\n        for (let i = 0; i < value.length; i++) {\n            let v = value[i];\n            if (isFile(v)) {\n                value[i] = v.tags['aux._user'] || v.id;\n            }\n        }\n    }\n    return value;\n}\n/**\n * Gets a list of strings from the given file and tag.\n * @param calc The file calculation context.\n * @param file The file.\n * @param tag The tag.\n */\nfunction getFileStringList(calc, file, tag) {\n    let value = calculateFileValue(calc, file, tag);\n    if (value && !Array.isArray(value)) {\n        value = [value];\n    }\n    return value;\n}\n/**\n * Determines if the whitelist and blacklist on the given file allows the given username.\n * If the username exists in both, then the whitelist wins.\n */\nfunction whitelistOrBlacklistAllowsAccess(calc, file, username) {\n    const whitelist = getFileWhitelist(calc, file);\n    if (whitelist) {\n        return isInUsernameList(calc, file, 'aux.whitelist', username);\n    }\n    else {\n        const blacklist = getFileBlacklist(calc, file);\n        if (blacklist) {\n            return !isInUsernameList(calc, file, 'aux.blacklist', username);\n        }\n    }\n    return true;\n}\n/**\n * Determines if the whitelist on the given file allows the given username.\n * Whitelists work by allowing only the usernames that are explicitly listed.\n * If the whitelist is empty, then everything is allowed.\n * @param calc The file calculation context.\n * @param file The file.\n * @param username The username to check.\n */\nfunction whitelistAllowsAccess(calc, file, username) {\n    const list = getFileWhitelist(calc, file);\n    if (list) {\n        return isInUsernameList(calc, file, 'aux.whitelist', username);\n    }\n    return true;\n}\n/**\n * Determines if the whitelist on the given file allows the given username.\n * Blacklists work by denying only the usernames that are explicitly listed.\n * If the blacklist is empty, then everything is allowed.\n * @param calc The file calculation context.\n * @param file The file.\n * @param username The username to check.\n */\nfunction blacklistAllowsAccess(calc, file, username) {\n    const list = getFileBlacklist(calc, file);\n    if (list) {\n        return !isInUsernameList(calc, file, 'aux.blacklist', username);\n    }\n    return true;\n}\n/**\n * Gets the aux.whitelist tag from the given file.\n * Always returns an array of strings.\n * If any files returned by the formula, then the aux._user tag will be used from the file.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileWhitelist(calc, file) {\n    return getFileUsernameList(calc, file, 'aux.whitelist');\n}\n/**\n * Gets the aux.blacklist tag from the given file.\n * Always returns an array of strings.\n * If any files returned by the formula, then the aux._user tag will be used from the file.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileBlacklist(calc, file) {\n    return getFileUsernameList(calc, file, 'aux.blacklist');\n}\n/**\n * Gets the aux.designers tag from the given file.\n * Always returns an array of strings.\n * If any files returned by the formula, then the aux._user tag will be used from the file.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileDesignerList(calc, file) {\n    return getFileUsernameList(calc, file, 'aux.designers');\n}\n/**\n * Gets the AUX_FILE_VERSION number that the given file was created with.\n * If not specified, then undefined is returned.\n * @param calc The file calculation context.\n * @param file THe file.\n */\nfunction getFileVersion(calc, file) {\n    return calculateNumericalTagValue(calc, file, 'aux.version', undefined);\n}\n/**\n * Gets the index that the given file is at in the given context.\n * @param calc The calculation context to use.\n * @param file The file.\n * @param workspaceId The context.\n */\nfunction getFileIndex(calc, file, context) {\n    return calculateNumericalTagValue(calc, file, `${context}.index`, 0);\n}\n/**\n * Gets the position that the given file is at in the given context.\n * @param calc The calculation context to use.\n * @param file The file.\n * @param context The context.\n */\nfunction getFilePosition(calc, file, context) {\n    return {\n        x: calculateNumericalTagValue(calc, file, `${context}.x`, 0),\n        y: calculateNumericalTagValue(calc, file, `${context}.y`, 0),\n        z: calculateNumericalTagValue(calc, file, `${context}.z`, 0),\n    };\n}\n/**\n * Gets the rotation that the given file is at in the given context.\n * @param calc The calculation context to use.\n * @param file The file.\n * @param context The context.\n */\nfunction getFileRotation(calc, file, context) {\n    return {\n        x: calculateNumericalTagValue(calc, file, `${context}.rotation.x`, 0),\n        y: calculateNumericalTagValue(calc, file, `${context}.rotation.y`, 0),\n        z: calculateNumericalTagValue(calc, file, `${context}.rotation.z`, 0),\n    };\n}\n/**\n * Gets the file that the given file is using as the input target.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileInputTarget(calc, file) {\n    return calculateFileValueAsFile(calc, file, 'aux.input.target', file);\n}\n/**\n * Gets the placeholder to use for a file's input box.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getFileInputPlaceholder(calc, file) {\n    return calculateFormattedFileValue(calc, file, 'aux.input.placeholder');\n}\n/**\n * Gets the shape of the file.\n * @param calc The calculation context to use.\n * @param file The file.\n */\nfunction getFileShape(calc, file) {\n    if (isDiff(calc, file)) {\n        return 'sphere';\n    }\n    const shape = calculateFileValue(calc, file, 'aux.shape');\n    if (shape === 'cube' || shape === 'sphere' || shape === 'sprite') {\n        return shape;\n    }\n    return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_FILE_SHAPE\"];\n}\n/**\n * Gets the anchor position for the file's label.\n * @param calc The calculation context to use.\n * @param file The file.\n */\nfunction getFileLabelAnchor(calc, file) {\n    const anchor = calculateFileValue(calc, file, 'aux.label.anchor');\n    if (anchor === 'back' ||\n        anchor === 'floating' ||\n        anchor === 'front' ||\n        anchor === 'left' ||\n        anchor === 'right' ||\n        anchor === 'top') {\n        return anchor;\n    }\n    return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_LABEL_ANCHOR\"];\n}\n/**\n * Determines if the given file is a config file for the given context.\n * @param calc The calculation context.\n * @param file The file to check.\n * @param context The context to check if the file is the config of.\n */\nfunction isConfigForContext(calc, file, context) {\n    const contexts = getFileConfigContexts(calc, file);\n    return contexts.indexOf(context) >= 0;\n}\n/**\n * Gets whether the context(s) that the given file represents are locked.\n * Uses at the aux.context.locked tag to determine whether it is locked.\n * Defaults to false if the file is a context. Otherwise it defaults to true.\n * @param calc The calculation context.\n * @param file The file.\n */\nfunction isContextLocked(calc, file) {\n    if (isContext(calc, file)) {\n        return calculateBooleanTagValue(calc, file, 'aux.context.locked', false);\n    }\n    return true;\n}\n/**\n * Gets the list of contexts that the given file is a config file for.\n * @param calc The calculation context.\n * @param file The file that represents the context.\n */\nfunction getFileConfigContexts(calc, file) {\n    const result = calculateFileValue(calc, file, 'aux.context');\n    if (typeof result === 'string' && hasValue(result)) {\n        return [result];\n    }\n    else if (Array.isArray(result)) {\n        return result;\n    }\n    return [];\n}\n/**\n * Gets a value from the given context file.\n * @param calc The calculation context.\n * @param contextFile The file that represents the context.\n * @param name The name of the value to get.\n */\nfunction getContextValue(calc, contextFile, name) {\n    return calculateFileValue(calc, contextFile, `aux.context.${name}`);\n}\n/**\n * Gets the drag mode for the file.\n * @param calc The file calculation context.\n * @param file The file to check.\n */\nfunction getFileDragMode(calc, file) {\n    const val = calculateFileValue(calc, file, 'aux.movable');\n    if (typeof val === 'boolean') {\n        return val ? 'all' : 'none';\n    }\n    if (val === 'clone' ||\n        val === 'pickup' ||\n        val === 'drag' ||\n        val === 'cloneMod') {\n        return val;\n    }\n    else {\n        return 'all';\n    }\n}\n/**\n * Gets whether the given file is stackable.\n * @param calc The calculation context.\n * @param file The file to check.\n */\nfunction isFileStackable(calc, file) {\n    return calculateBooleanTagValue(calc, file, 'aux.stackable', true);\n}\n/**\n * Gets whether the given file is movable.\n * @param calc The calculation context.\n * @param file The file to check.\n */\nfunction isFileMovable(calc, file) {\n    // checks if file is movable, but we should also allow it if it is pickupable so we can drag it into inventory if movable is false\n    return calculateBooleanTagValue(calc, file, 'aux.movable', true);\n}\n/**\n * Gets whether the given file is listening for shouts or whispers.\n * @param calc The calculation context.\n * @param file The file to check.\n */\nfunction isFileListening(calc, file) {\n    // checks if file is movable, but we should also allow it if it is pickupable so we can drag it into inventory if movable is false\n    return calculateBooleanTagValue(calc, file, 'aux.listening', true);\n}\n/**\n * Gets whether the given file's context is movable.\n * @param calc The calculation context.\n * @param file The file to check.\n */\nfunction isContextMovable(calc, file) {\n    return calculateBooleanTagValue(calc, file, 'aux.context.surface.movable', true);\n}\n/**\n * Gets the position that the context should be at using the given file.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextPosition(calc, contextFile) {\n    return {\n        x: calculateNumericalTagValue(calc, contextFile, `aux.context.x`, 0),\n        y: calculateNumericalTagValue(calc, contextFile, `aux.context.y`, 0),\n        z: calculateNumericalTagValue(calc, contextFile, `aux.context.z`, 0),\n    };\n}\n/**\n * Gets the rotation that the context should be at using the given file.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextRotation(calc, contextFile) {\n    return {\n        x: calculateNumericalTagValue(calc, contextFile, `aux.context.rotation.x`, 0),\n        y: calculateNumericalTagValue(calc, contextFile, `aux.context.rotation.y`, 0),\n        z: calculateNumericalTagValue(calc, contextFile, `aux.context.rotation.z`, 0),\n    };\n}\n/**\n * Gets whether the context is minimized.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextMinimized(calc, contextFile) {\n    return getContextValue(calc, contextFile, 'surface.minimized');\n}\n/**\n * Gets the color of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextColor(calc, contextFile) {\n    return getContextValue(calc, contextFile, 'color');\n}\n/**\n * Gets the size of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextSize(calc, contextFile) {\n    if (getContextVisualizeMode(calc, contextFile) === 'surface') {\n        return calculateNumericalTagValue(calc, contextFile, `aux.context.surface.size`, _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SIZE\"]);\n    }\n    return 0;\n}\n/**\n * Gets the aux.context.visualize mode from the given file.\n * @param calc The calculation context.\n * @param file The file.\n */\nfunction getContextVisualizeMode(calc, file) {\n    const val = calculateFileValue(calc, file, 'aux.context.visualize');\n    if (typeof val === 'boolean') {\n        return val;\n    }\n    if (val === 'surface') {\n        return val;\n    }\n    else {\n        return false;\n    }\n}\n/**\n * Gets the grid of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getBuilderContextGrid(calc, contextFile) {\n    const tags = tagsOnFile(contextFile);\n    const gridTags = tags.filter(t => t.indexOf('aux.context.surface.grid.') === 0 && t.indexOf(':') > 0);\n    let val = {};\n    for (let tag of gridTags) {\n        val[tag.substr('aux.context.surface.grid.'.length)] = calculateNumericalTagValue(calc, contextFile, tag, undefined);\n    }\n    return val;\n}\n/**\n * Gets the height of the specified grid on the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n * @param key The key for the grid position to lookup in the context grid.\n */\nfunction getContextGridHeight(calc, contextFile, key) {\n    let contextGrid = getBuilderContextGrid(calc, contextFile);\n    if (contextGrid && contextGrid[key]) {\n        if (contextGrid[key]) {\n            return contextGrid[key];\n        }\n    }\n    return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_HEIGHT\"];\n}\n/**\n * Gets the grid scale of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextGridScale(calc, contextFile) {\n    return getContextValue(calc, contextFile, 'grid.scale');\n}\n/**\n * Gets the scale of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextScale(calc, contextFile) {\n    return (getContextValue(calc, contextFile, 'surface.scale') ||\n        _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SCALE\"]);\n}\n/**\n * Gets the default height of the context.\n * @param calc The calculation context to use.\n * @param contextFile The file that represents the context.\n */\nfunction getContextDefaultHeight(calc, contextFile) {\n    return getContextValue(calc, contextFile, 'defaultHeight');\n}\n/**\n * Filters the given list of objects to those matching the given workspace ID and grid position.\n * The returned list is in the order of their indexes.\n * @param calc The file calculation context to use.\n * @param context The ID of the context that the objects need to be on.\n * @param position The position that the objects need to be at.\n */\nfunction objectsAtContextGridPosition(calc, context, position) {\n    const objects = calc.objects;\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(objects.filter(o => {\n        if (!isUserFile(o) && isFileInContext(calc, o, context)) {\n            const pos = getFilePosition(calc, o, context);\n            return pos && position.x === pos.x && position.y === pos.y;\n        }\n        return false;\n    }), o => getFileIndex(calc, o, context), o => o.id);\n}\n/**\n * Determines if the given file is for a user.\n */\nfunction isUserFile(file) {\n    return !!file.tags['aux._user'];\n}\n/**\n * Filters the given list of objects to those that are assigned to the given workspace ID.\n * @param objects The objects to filter.\n * @param workspaceId The ID of the workspace that the objects need to be on,\n */\nfunction objectsAtWorkspace(objects, workspaceId) {\n    return objects.filter(o => {\n        return o.tags._workspace === workspaceId;\n    });\n}\n/**\n * Duplicates the given file and returns a new file with a new ID but the same tags.\n * The file will be exactly the same as the previous except for 3 things.\n * First, it will have a different ID.\n * Second, it will never be marked as destroyed.\n * Third, it will not have any well known tags. (see isTagWellKnown())\n * @param calc The file calculation context.\n * @param file The file to duplicate.\n * @param data The optional data that should override the existing file data.\n */\nfunction duplicateFile(calc, file, data) {\n    let copy = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"cloneDeep\"])(file);\n    const tags = tagsOnFile(copy);\n    const tagsToKeep = getDiffTags(calc, file);\n    const tagsToRemove = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"difference\"])(filterWellKnownAndContextTags(calc, tags), tagsToKeep);\n    tagsToRemove.forEach(t => {\n        delete copy.tags[t];\n    });\n    let newFile = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"merge\"])(copy, data || {});\n    newFile.id = uuid_v4__WEBPACK_IMPORTED_MODULE_1___default()();\n    return cleanFile(newFile);\n}\n/**\n * Filters the given list of tags by whether they are well known or used in a context.\n * @param calc The file calculation context.\n * @param tags The list of tags to filter.\n */\nfunction filterWellKnownAndContextTags(calc, tags) {\n    const contextsToRemove = getContexts(calc);\n    const tagsToRemove = tags.filter(t => isWellKnownOrContext(t, contextsToRemove));\n    return tagsToRemove;\n}\n/**\n * Gets the list of contexts that the given calculation context contains.\n * @param calc The file calculation context.\n */\nfunction getContexts(calc) {\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"union\"])(...calc.objects.map(o => getFileConfigContexts(calc, o)));\n}\n/**\n * Determines if the given tag is well known or in one of the given contexts.\n * @param tag The tag to check.\n * @param contexts The contexts to check the tag against.\n */\nfunction isWellKnownOrContext(tag, contexts) {\n    return isTagWellKnown(tag) || contexts.some(c => tag.indexOf(c) === 0);\n}\n/**\n * Determines if the given file represents a diff.\n * @param file The file to check.\n */\nfunction isDiff(calc, file) {\n    if (calc) {\n        return !!file && calculateBooleanTagValue(calc, file, 'aux.mod', false);\n    }\n    else {\n        return !!file && !!file.tags['aux.mod'];\n    }\n}\n/**\n * Determines if the given file allows for merging.\n * @param file The file to check.\n */\nfunction isMergeable(calc, file) {\n    return (!!file && calculateBooleanTagValue(calc, file, 'aux.mergeable', true));\n}\n/**\n * Determines if the given file allows for the file to be place in inventory.\n * @param file The file to check.\n */\nfunction isPickupable(calc, file) {\n    if (!!file && isFileMovable(calc, file)) {\n        const mode = getFileDragMode(calc, file);\n        return mode === 'pickup' || mode === 'all';\n    }\n    return false;\n}\n/**\n * Gets a partial file that can be used to apply the diff that the given file represents.\n * A diff file is any file that has `aux.mod` set to `true` and `aux.mod.mergeTags` set to a list of tag names.\n * @param calc The file calculation context.\n * @param file The file that represents the diff.\n */\nfunction getDiffUpdate(calc, file) {\n    if (isDiff(calc, file)) {\n        let update = {\n            tags: {},\n        };\n        let tags = tagsOnFile(file);\n        let diffTags = getDiffTags(calc, file);\n        for (let i = 0; i < tags.length; i++) {\n            let tag = tags[i];\n            if (tag === 'aux.mod' ||\n                tag === 'aux.mod.mergeTags' ||\n                tag === 'aux.movable.mod.tags' ||\n                diffTags.indexOf(tag) < 0) {\n                continue;\n            }\n            let val = file.tags[tag];\n            if (hasValue(val)) {\n                update.tags[tag] = val;\n            }\n        }\n        return update;\n    }\n    return null;\n}\nfunction getDiffTags(calc, file) {\n    let diffTags = calculateFileValue(calc, file, 'aux.movable.mod.tags') ||\n        calculateFileValue(calc, file, 'aux.mod.mergeTags');\n    if (!diffTags) {\n        return [];\n    }\n    if (!Array.isArray(diffTags)) {\n        diffTags = [diffTags];\n    }\n    return diffTags\n        .filter((a) => a !== null && typeof a !== 'undefined')\n        .map((a) => {\n        if (typeof a !== 'string') {\n            return a.toString();\n        }\n        else {\n            return a;\n        }\n    });\n}\nfunction simulationIdToString(id) {\n    let str = '';\n    if (id.host) {\n        str += `${id.host}/*/`;\n    }\n    if (id.channel) {\n        str += `${id.channel}`;\n    }\n    return str;\n}\nfunction parseSimulationId(id) {\n    try {\n        let uri = new URL(id);\n        const split = uri.pathname.slice(1).split('/');\n        if (split.length === 1) {\n            if (split[0]) {\n                return {\n                    success: true,\n                    host: uri.host,\n                    context: split[0],\n                };\n            }\n            else {\n                return {\n                    success: true,\n                    host: uri.host,\n                };\n            }\n        }\n        else {\n            return {\n                success: true,\n                host: uri.host,\n                context: split[0],\n                channel: split.slice(1).join('/'),\n            };\n        }\n    }\n    catch (ex) {\n        const split = id.split('/');\n        if (split.length === 1) {\n            return {\n                success: true,\n                channel: id,\n            };\n        }\n        else {\n            const firstSlashIndex = id.indexOf('/');\n            const firstDotIndex = id.indexOf('.');\n            if (firstDotIndex >= 0 && firstDotIndex < firstSlashIndex) {\n                return {\n                    success: true,\n                    host: split[0],\n                    context: split[1],\n                    channel: split.slice(2).join('/'),\n                };\n            }\n            else {\n                return {\n                    success: true,\n                    context: split[0],\n                    channel: split.slice(1).join('/'),\n                };\n            }\n        }\n    }\n}\n/**\n * Normalizes the given URL so that it will load the AUX file instead of the web application.\n * @param url The URL.\n */\nfunction normalizeAUXFileURL(url) {\n    const parsed = new URL(url);\n    if (parsed.pathname.indexOf('.aux') !==\n        parsed.pathname.length - '.aux'.length) {\n        parsed.pathname = `${parsed.pathname}.aux`;\n        return parsed.href;\n    }\n    return url;\n}\n/**\n * Parses the given tag filter into its components.\n * @param tag\n */\nfunction parseFilterTag(tag) {\n    let originalTag = tag;\n    tag = tag.replace(/[]/g, '\"');\n    const firstParenIndex = tag.indexOf('(');\n    const tagIndex = tag.indexOf('#');\n    if (firstParenIndex > 0 && (tagIndex > firstParenIndex || tagIndex < 0)) {\n        const eventName = tag.slice(0, firstParenIndex).trim();\n        if (eventName) {\n            const colonIndex = tag.indexOf(':');\n            if (colonIndex > tagIndex) {\n                const tagName = tag.slice(tagIndex + 1, colonIndex).trim();\n                if (tagName && tagIndex > 0) {\n                    let firstQuote = tag.indexOf('\"');\n                    if (firstQuote < 0) {\n                        firstQuote = colonIndex;\n                    }\n                    let lastQuote = tag.lastIndexOf('\"');\n                    if (lastQuote < 0) {\n                        lastQuote = tag.lastIndexOf(')');\n                        if (lastQuote < 0) {\n                            lastQuote = tag.length;\n                        }\n                    }\n                    else if (lastQuote === firstQuote) {\n                        lastQuote = tag.length;\n                    }\n                    const value = tag.slice(firstQuote + 1, lastQuote);\n                    const finalValue = _parseFilterValue(value);\n                    return {\n                        success: true,\n                        eventName: eventName,\n                        tag: originalTag,\n                        filter: {\n                            tag: tagName,\n                            value: finalValue,\n                        },\n                    };\n                }\n            }\n            let lastParen = tag.lastIndexOf(')');\n            if (lastParen > firstParenIndex) {\n                let between = tag.slice(firstParenIndex + 1, lastParen);\n                // Only whitespace is allowed\n                if (/^\\s*$/.test(between)) {\n                    return {\n                        success: true,\n                        eventName: eventName,\n                        tag: originalTag,\n                        filter: null,\n                    };\n                }\n            }\n            return {\n                success: false,\n                partialSuccess: true,\n                tag: originalTag,\n                eventName: eventName,\n            };\n        }\n    }\n    return {\n        success: false,\n        partialSuccess: false,\n        tag: originalTag,\n        eventName: null,\n    };\n}\n/**\n * Gets the user mode value from the given file.\n * @param object The file.\n */\nfunction getUserMode(object) {\n    return object.tags['aux._mode'] || _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_MODE\"];\n}\n/**\n * Gets the user selection mode value from the given file.\n * @param file The file.\n */\nfunction getSelectionMode(file) {\n    return file.tags['aux._selectionMode'] || _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_SELECTION_MODE\"];\n}\n/**\n * Calculates the value of the given tag on the given file. If the result is not a file, then the given default value\n * is returned.\n * @param context The context.\n * @param file The file.\n * @param tag The tag.\n * @param defaultValue The default value to use if the tag doesn't exist or the result is not a file.\n */\nfunction calculateFileValueAsFile(context, file, tag, defaultValue) {\n    if (file.tags[tag]) {\n        const result = calculateFileValue(context, file, tag);\n        if (isFile(result)) {\n            return result;\n        }\n    }\n    return defaultValue;\n}\n/**\n * Calculates the value of the given tag on the given file as a list of strings.\n * @param context The calculation context.\n * @param file The file.\n * @param tag The tag.\n * @param defaultValue The default value.\n */\nfunction calculateStringListTagValue(context, file, tag, defaultValue) {\n    let value = calculateFileValue(context, file, tag);\n    if (typeof value === 'undefined' || value === null || value === '') {\n        return defaultValue;\n    }\n    else if (!Array.isArray(value)) {\n        value = [value];\n    }\n    if (value) {\n        for (let i = 0; i < value.length; i++) {\n            let v = value[i];\n            if (typeof v !== 'undefined' && v !== null) {\n                value[i] = v.toString();\n            }\n        }\n    }\n    return value;\n}\n/**\n * Calculates the value of the given tag on the given file. If the result is not a number, then the given default value\n * is returned.\n * @param fileManager The file manager.\n * @param file The file.\n * @param tag The tag.\n * @param defaultValue The default value to use if the tag doesn't exist or the result is not a number.\n */\nfunction calculateNumericalTagValue(context, file, tag, defaultValue) {\n    if (typeof file.tags[tag] !== 'undefined') {\n        const result = calculateFileValue(context, file, tag);\n        if (typeof result === 'number' && result !== null) {\n            return result;\n        }\n    }\n    return defaultValue;\n}\n/**\n * Calculates the value of the given tag on the given file. If the result is not a boolean, then the given default value is returned.\n * @param context The context.\n * @param file The file.\n * @param tag The tag.\n * @param defaultValue The default value to use.\n */\nfunction calculateBooleanTagValue(context, file, tag, defaultValue) {\n    if (typeof file.tags[tag] !== 'undefined') {\n        const result = calculateFileValue(context, file, tag);\n        if (typeof result === 'boolean' && result !== null) {\n            return result;\n        }\n    }\n    return defaultValue;\n}\n/**\n * Determines if the given file is able to be destroyed.\n * Defaults to true.\n * @param calc The file calculation context.\n * @param file The file to check.\n */\nfunction isDestroyable(calc, file) {\n    return calculateBooleanTagValue(calc, file, 'aux.destroyable', true);\n}\n/**\n * Determines if the given file is able to be edited by the file sheet.\n * Defaults to true.\n * @param calc The file calculation context.\n * @param file The file to check.\n */\nfunction isEditable(calc, file) {\n    return calculateBooleanTagValue(calc, file, 'aux.editable', true);\n}\n/**\n * Determines if the given file is trying to load a simulation.\n * @param calc The calculation context.\n * @param file The file to check.\n */\nfunction isSimulation(calc, file) {\n    return !!getFileChannel(calc, file);\n}\n/**\n * Gets the aux.channel tag from the given file.\n * @param calc The file calculation context to use.\n * @param file The file.\n */\nfunction getFileChannel(calc, file) {\n    return calculateFileValue(calc, file, 'aux.channel');\n}\n/**\n * Gets the first file which is in the aux.channels context that has the aux.channel tag set to the given ID.\n * @param calc The file calculation context.\n * @param id The ID to search for.\n */\nfunction getChannelFileById(calc, id) {\n    const files = calc.objects.filter(o => {\n        return (isFileInContext(calc, o, 'aux.channels') &&\n            calculateFileValue(calc, o, 'aux.channel') === id);\n    });\n    if (files.length > 0) {\n        return files[0];\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Gets the number of connected devices that are connected to the channel that\n * the given file is for.\n * @param calc The file calculation context.\n * @param file The file.\n */\nfunction getChannelConnectedDevices(calc, file) {\n    return calculateNumericalTagValue(calc, file, 'aux.channel.connectedSessions', 0);\n}\n/**\n * Gets the maximum number of devices that are allowed to connect to the channel simultaniously.\n * @param calc The file calculation context.\n * @param file The channel file.\n */\nfunction getChannelMaxDevicesAllowed(calc, file) {\n    return calculateNumericalTagValue(calc, file, 'aux.channel.maxSessionsAllowed', null);\n}\n/**\n * Gets the maximum number of devices that are allowed to connect to the channel simultaniously.\n * @param calc The file calculation context.\n * @param file The channel file.\n */\nfunction getMaxDevicesAllowed(calc, file) {\n    return calculateNumericalTagValue(calc, file, 'aux.maxSessionsAllowed', null);\n}\n/**\n * Gets the number of connected devices that are connected from the given globals file.\n * @param calc The file calculation context.\n * @param file The globals file.\n */\nfunction getConnectedDevices(calc, file) {\n    return calculateNumericalTagValue(calc, file, 'aux.connectedSessions', 0);\n}\n/**\n * Returns wether or not the given file resides in the given context id.\n * @param context The file calculation context to run formulas with.\n * @param file The file.\n * @param contextId The id of the context that we are asking if the file is in.\n */\nfunction isFileInContext(context, file, contextId) {\n    if (!contextId)\n        return false;\n    let result;\n    let contextValue = calculateFileValue(context, file, contextId.valueOf());\n    if (typeof contextValue === 'object' &&\n        typeof contextValue.valueOf === 'function') {\n        contextValue = contextValue.valueOf();\n    }\n    if (typeof contextValue === 'string') {\n        result = contextValue === 'true';\n    }\n    else if (typeof contextValue === 'number') {\n        result = true;\n    }\n    else {\n        result = contextValue === true;\n    }\n    if (!result && hasValue(file.tags['aux._user'])) {\n        const userContextValue = calculateFileValue(context, file, 'aux._userContext');\n        result = userContextValue == contextId;\n    }\n    return result;\n}\n/**\n * Gets the sort order that the given file should appear in the given context.\n * @param context The file calculation context.\n * @param file The file.\n * @param contextId The ID of the context that we're getting the sort order for.\n */\nfunction fileContextSortOrder(context, file, contextId) {\n    if (!contextId)\n        return NaN;\n    const contextValue = calculateFileValue(context, file, `${contextId}.index`);\n    if (typeof contextValue === 'string') {\n        return contextValue;\n    }\n    else if (typeof contextValue === 'number') {\n        return contextValue;\n    }\n    else {\n        return 0;\n    }\n}\n/**\n * Calculates the given formula and returns the result.\n * @param context The file calculation context to run formulas with.\n * @param formula The formula to use.\n * @param extras The extra data to include in callbacks to the interface implementation.\n * @param thisObj The object that should be used for the this keyword in the formula.\n */\nfunction calculateFormulaValue(context, formula, extras = {}, thisObj = null) {\n    const prevCalc = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"getCalculationContext\"])();\n    const prevEnergy = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"getEnergy\"])();\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setCalculationContext\"])(context);\n    // TODO: Allow configuring energy per formula\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setEnergy\"])(DEFAULT_ENERGY);\n    const result = context.sandbox.run(formula, extras, context);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setCalculationContext\"])(prevCalc);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setEnergy\"])(prevEnergy);\n    return result;\n}\nfunction isUserActive(file) {\n    const lastActiveTime = file.tags[`aux._lastActiveTime`];\n    if (lastActiveTime) {\n        const milisecondsFromNow = Date.now() - lastActiveTime;\n        return milisecondsFromNow < _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_INACTIVE_TIME\"];\n    }\n    else {\n        return false;\n    }\n}\nfunction shouldDeleteUser(file) {\n    const lastActiveTime = file.tags[`aux._lastActiveTime`];\n    if (lastActiveTime) {\n        const milisecondsFromNow = Date.now() - lastActiveTime;\n        return milisecondsFromNow > _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_DELETION_TIME\"];\n    }\n    else {\n        return false;\n    }\n}\nfunction _parseFilterValue(value) {\n    if (isArray(value)) {\n        const split = parseArray(value);\n        return split.map(v => _parseFilterValue(v));\n    }\n    else if (isNumber(value)) {\n        return parseFloat(value);\n    }\n    else if (value === 'true') {\n        return true;\n    }\n    else if (value === 'false') {\n        return false;\n    }\n    else {\n        return value;\n    }\n}\nfunction _convertToAssignment(object) {\n    if (isAssignment(object)) {\n        return object;\n    }\n    return {\n        _assignment: true,\n        editing: true,\n        formula: object,\n    };\n}\n/**\n * Determines if the given value is an assignment expression or an assignment object.\n */\nfunction _isAssignmentFormula(value) {\n    if (typeof value === 'string') {\n        return value.indexOf(':') === 0 && value.indexOf('=') === 1;\n    }\n    else {\n        return isAssignment(value);\n    }\n}\n/**\n * Formats the given value and returns a string representing it.\n * @param value The value to format.\n */\nfunction formatValue(value) {\n    if (typeof value === 'object') {\n        if (!value) {\n            return null;\n        }\n        else if (Array.isArray(value)) {\n            return `[${value.map(v => formatValue(v)).join(',')}]`;\n        }\n        else if (value instanceof Error) {\n            return value.toString();\n        }\n        else {\n            if (value.id) {\n                return getShortId(value);\n            }\n            else {\n                return JSON.stringify(value);\n            }\n        }\n    }\n    else if (typeof value !== 'undefined' && value !== null) {\n        return value.toString();\n    }\n    else {\n        return value;\n    }\n}\n/**\n * Calculates the value of the given formula as if it was on the given file (object) and tag.\n * @param context The calculation context to use.\n * @param object The file that the formula was from.\n * @param tag The tag that the formula was from.\n * @param formula The formula.\n * @param unwrapProxy (Optional) Whether to unwrap proxies. Defaults to true.\n */\nfunction calculateValue(context, object, tag, formula, unwrapProxy) {\n    if (isFormula(formula)) {\n        const result = _calculateFormulaValue(context, object, tag, formula, unwrapProxy);\n        if (result.success) {\n            return result.result;\n        }\n        else {\n            return result.error;\n        }\n    }\n    else if (isAssignment(formula)) {\n        const obj = formula;\n        return obj.value;\n    }\n    else if (isArray(formula)) {\n        const split = parseArray(formula);\n        return split.map(s => calculateValue(context, object, tag, s.trim(), unwrapProxy));\n    }\n    else if (isNumber(formula)) {\n        return parseFloat(formula);\n    }\n    else if (formula === 'true') {\n        return true;\n    }\n    else if (formula === 'false') {\n        return false;\n    }\n    else {\n        return formula;\n    }\n}\n/**\n * Calculates the value of the given formula and ensures that the result is a transferrable value.\n * @param context The file calculation context to use.\n * @param object The object that the formula was from.\n * @param tag The tag that the formula was from.\n * @param formula The formula to calculate the value of.\n */\nfunction calculateCopiableValue(context, object, tag, formula) {\n    const value = calculateValue(context, object, tag, formula);\n    return convertToCopiableValue(value);\n}\n/**\n * Converts the given value to a copiable value.\n * Copiable values are strings, numbers, booleans, arrays, and objects made of any of those types.\n * Non-copiable values are functions and errors.\n * @param value\n */\nfunction convertToCopiableValue(value) {\n    if (typeof value === 'function') {\n        return `[Function ${value.name}]`;\n    }\n    else if (value instanceof Error) {\n        return `${value.name}: ${value.message}`;\n    }\n    else if (typeof value === 'object') {\n        if (isFile(value)) {\n            return {\n                id: value.id,\n                tags: value.tags,\n            };\n        }\n        else if (Array.isArray(value)) {\n            return value.map(val => convertToCopiableValue(val));\n        }\n        else {\n            return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"mapValues\"])(value, val => convertToCopiableValue(val));\n        }\n    }\n    return value;\n}\nfunction _calculateFormulaValue(context, object, tag, formula, unwrapProxy = true) {\n    const prevCalc = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"getCalculationContext\"])();\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setCalculationContext\"])(context);\n    // NOTE: The energy should not get reset\n    // here because then infinite formula loops would be possible.\n    const result = context.sandbox.run(formula, {\n        formula,\n        tag,\n        context,\n    }, object);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_3__[\"setCalculationContext\"])(prevCalc);\n    return result;\n}\n//# sourceMappingURL=FileCalculations.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/FileEvents.js":
/*!************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/FileEvents.js ***!
  \************************************************************************/
/*! exports provided: fileAdded, fileRemoved, fileUpdated, transaction, action, addState, pasteState, toast, tweenTo, openQRCodeScanner, showQRCode, loadSimulation, unloadSimulation, superShout, goToContext, importAUX, showInputForTag, setForcedOffline, goToURL, openURL, sayHello, echo, grantRole, revokeRole, shell, openConsole */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileAdded\", function() { return fileAdded; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileRemoved\", function() { return fileRemoved; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileUpdated\", function() { return fileUpdated; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"transaction\", function() { return transaction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"action\", function() { return action; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addState\", function() { return addState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pasteState\", function() { return pasteState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toast\", function() { return toast; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tweenTo\", function() { return tweenTo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"openQRCodeScanner\", function() { return openQRCodeScanner; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showQRCode\", function() { return showQRCode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"loadSimulation\", function() { return loadSimulation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unloadSimulation\", function() { return unloadSimulation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"superShout\", function() { return superShout; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"goToContext\", function() { return goToContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"importAUX\", function() { return importAUX; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showInputForTag\", function() { return showInputForTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setForcedOffline\", function() { return setForcedOffline; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"goToURL\", function() { return goToURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"openURL\", function() { return openURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sayHello\", function() { return sayHello; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"echo\", function() { return echo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"grantRole\", function() { return grantRole; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"revokeRole\", function() { return revokeRole; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shell\", function() { return shell; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"openConsole\", function() { return openConsole; });\n/**\n * Creates a new FileAddedEvent.\n * @param file The file that was added.\n */\nfunction fileAdded(file) {\n    return {\n        type: 'file_added',\n        id: file.id,\n        file: file,\n    };\n}\n/**\n * Creates a new FileRemovedEvent.\n * @param fileId The ID of the file that was removed.\n */\nfunction fileRemoved(fileId) {\n    return {\n        type: 'file_removed',\n        id: fileId,\n    };\n}\n/**\n * Creates a new FileUpdatedEvent.\n * @param id The ID of the file that was updated.\n * @param update The update that was applied to the file.\n */\nfunction fileUpdated(id, update) {\n    return {\n        type: 'file_updated',\n        id: id,\n        update: update,\n    };\n}\n/**\n * Creates a new FileTransactionEvent.\n * @param events The events to contain in the transaction.\n */\nfunction transaction(events) {\n    return {\n        type: 'transaction',\n        events: events,\n    };\n}\n/**\n * Creates a new Action.\n * @param eventName The name of the event.\n * @param fileIds The IDs of the files that the event should be sent to. If null then the event is sent to every file.\n * @param userId The ID of the file for the current user.\n * @param arg The optional argument to provide.\n * @param sortIds Whether the files should be processed in order of their File IDs.\n */\nfunction action(eventName, fileIds = null, userId = null, arg, sortIds = true) {\n    return {\n        type: 'action',\n        fileIds,\n        eventName,\n        userId,\n        argument: arg,\n        sortFileIds: sortIds,\n    };\n}\n/**\n * Creates a new ApplyStateEvent.\n * @param state The state to apply.\n */\nfunction addState(state) {\n    return {\n        type: 'apply_state',\n        state: state,\n    };\n}\n/**\n * Creates a new PasteStateEvent.\n * @param state The state to paste.\n * @param x The X position of the new worksurface.\n * @param y The Y position of the new worksurface.\n * @param z The Z position of the new worksurface.\n */\nfunction pasteState(state, x, y, z) {\n    return {\n        type: 'paste_state',\n        state: state,\n        x: x,\n        y: y,\n        z: z,\n    };\n}\n/**\n * Creates a new ShowToastEvent.\n * @param message The message to show with the event.\n */\nfunction toast(message) {\n    return {\n        type: 'local',\n        name: 'show_toast',\n        message: message,\n    };\n}\n/**\n * Creates a new TweenToEvent.\n * @param fileId The ID of the file to tween to.\n * @param zoomValue The zoom value to use.\n */\nfunction tweenTo(fileId, zoomValue = -1, rotX = null, rotY = null) {\n    if (rotY != null && rotX != null && rotY > 0 && rotX === 0) {\n        rotX = 1;\n    }\n    if (rotX === null || rotY === null) {\n        return {\n            type: 'local',\n            name: 'tween_to',\n            fileId: fileId,\n            zoomValue: zoomValue,\n            rotationValue: null,\n        };\n    }\n    else {\n        return {\n            type: 'local',\n            name: 'tween_to',\n            fileId: fileId,\n            zoomValue: zoomValue,\n            rotationValue: {\n                x: rotX / 180,\n                y: rotY / 180,\n            },\n        };\n    }\n}\n/**\n * Creates a new OpenQRCodeScannerEvent.\n * @param open Whether the QR Code scanner should be open or closed.\n */\nfunction openQRCodeScanner(open) {\n    return {\n        type: 'local',\n        name: 'show_qr_code_scanner',\n        open: open,\n    };\n}\n/**\n * Creates a new ShowQRCodeEvent.\n * @param open Whether the QR Code should be visible.\n * @param code The code that should be shown.\n */\nfunction showQRCode(open, code) {\n    return {\n        type: 'local',\n        name: 'show_qr_code',\n        open: open,\n        code: code,\n    };\n}\n/**\n * Creates a new LoadSimulationEvent.\n * @param id The ID of the simulation to load.\n */\nfunction loadSimulation(id) {\n    return {\n        type: 'local',\n        name: 'load_simulation',\n        id: id,\n    };\n}\n/**\n * Creates a new UnloadSimulationEvent.\n * @param id The ID of the simulation to unload.\n */\nfunction unloadSimulation(id) {\n    return {\n        type: 'local',\n        name: 'unload_simulation',\n        id: id,\n    };\n}\n/**\n * Creates a new SuperShoutEvent.\n * @param eventName The name of the event.\n * @param arg The argument to send as the \"that\" variable to scripts.\n */\nfunction superShout(eventName, arg) {\n    return {\n        type: 'local',\n        name: 'super_shout',\n        eventName: eventName,\n        argument: arg,\n    };\n}\n/**\n * Creates a new GoToContextEvent.\n * @param simulationOrContext The simulation ID or context to go to. If a simulation ID is being provided, then the context parameter must also be provided.\n * @param context\n */\nfunction goToContext(context) {\n    return {\n        type: 'local',\n        name: 'go_to_context',\n        context: context,\n    };\n}\n/**\n * Creates a new ImportAUXEvent.\n * @param url The URL that should be loaded.\n */\nfunction importAUX(url) {\n    return {\n        type: 'local',\n        name: 'import_aux',\n        url: url,\n    };\n}\n/**\n * Creates a new ShowInputForTagEvent.\n * @param fileId The ID of the file to edit.\n * @param tag The tag to edit.\n */\nfunction showInputForTag(fileId, tag, options) {\n    return {\n        type: 'local',\n        name: 'show_input_for_tag',\n        fileId: fileId,\n        tag: tag,\n        options: options || {},\n    };\n}\n/**\n * Creates a new SetForcedOfflineEvent event.\n * @param offline Whether the connection should be offline.\n */\nfunction setForcedOffline(offline) {\n    return {\n        type: 'local',\n        name: 'set_offline_state',\n        offline: offline,\n    };\n}\n/**\n * Creates a new GoToURLEvent.\n * @param url The URL to go to.\n */\nfunction goToURL(url) {\n    return {\n        type: 'local',\n        name: 'go_to_url',\n        url: url,\n    };\n}\n/**\n * Creates a new OpenURLEvent.\n * @param url The URL to go to.\n */\nfunction openURL(url) {\n    return {\n        type: 'local',\n        name: 'open_url',\n        url: url,\n    };\n}\n/**\n * Creates a new SayHelloEvent.\n */\nfunction sayHello() {\n    return {\n        type: 'local',\n        name: 'say_hello',\n    };\n}\n/**\n * Creates an new EchoEvent.\n */\nfunction echo(message) {\n    return {\n        type: 'local',\n        name: 'echo',\n        message,\n    };\n}\n/**\n * Creates a new GrantRoleEvent.\n * @param username The username of the user that the role should be granted to.\n * @param role The role to grant.\n * @param grant The token that is used to authorize the operation.\n */\nfunction grantRole(username, role, grant) {\n    return {\n        type: 'local',\n        name: 'grant_role',\n        role: role,\n        username: username,\n        grant: grant,\n    };\n}\n/**\n * Creates a new RevokeRoleEvent.\n * @param username The username of the user that the role should be revoked from.\n * @param role The role to revoke.\n * @param grant The token that is used to authorize the operation.\n */\nfunction revokeRole(username, role, grant) {\n    return {\n        type: 'local',\n        name: 'revoke_role',\n        role: role,\n        username: username,\n        grant: grant,\n    };\n}\n/**\n * Creates a new ShellEvent.\n * @param script The script that should be run.\n */\nfunction shell(script) {\n    return {\n        type: 'local',\n        name: 'shell',\n        script: script,\n    };\n}\n/**\n * Creates a new ToggleConsoleEvent.\n */\nfunction openConsole() {\n    return {\n        type: 'local',\n        name: 'open_console',\n        open: true,\n    };\n}\n//# sourceMappingURL=FileEvents.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/FileEvents.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js ***!
  \**************************************************************************/
/*! exports provided: calculateActionEventsUsingContext, calculateActionResultsUsingContext, getFilesForAction, calculateFileActionEvents, formulaActions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEventsUsingContext\", function() { return calculateActionEventsUsingContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResultsUsingContext\", function() { return calculateActionResultsUsingContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFilesForAction\", function() { return getFilesForAction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateFileActionEvents\", function() { return calculateFileActionEvents; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"formulaActions\", function() { return formulaActions; });\n/* harmony import */ var _FileCalculations__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FileCalculations */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js\");\n/* harmony import */ var _Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Formulas/formula-lib-globals */ \"./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n/**\n * Calculates the set of events that should be run as the result of the given action using the given context.\n * The returned events are only events that were added directly from the scripts and not any events that were added via setTag() calls.\n */\nfunction calculateActionEventsUsingContext(state, action, context) {\n    let [events] = calculateActionResultsUsingContext(state, action, context);\n    return events;\n}\n/**\n * Calculates the results of the given action run against the given state in the given context.\n * @param state The current files state that the action should use.\n * @param action The action to run.\n * @param context The context that the action should be run in.\n */\nfunction calculateActionResultsUsingContext(state, action, context) {\n    const { files, objects } = getFilesForAction(state, action, context);\n    return calculateFileActionEvents(state, action, context, files);\n}\nfunction getFilesForAction(state, action, calc) {\n    //here\n    const objects = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"getActiveObjects\"])(state);\n    let files = !!action.fileIds\n        ? action.fileIds.map(id => state[id])\n        : objects;\n    files = action.sortFileIds ? Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(files, f => f.id) : files;\n    for (let i = files.length - 1; i >= 0; i--) {\n        if (Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"isFileListening\"])(calc, files[i]) == false) {\n            files.splice(i, 1);\n        }\n    }\n    return { files, objects };\n}\nfunction calculateFileActionEvents(state, action, context, files) {\n    let events = [];\n    let results = [];\n    for (let f of files) {\n        const [e, r] = eventActions(state, files, context, f, action.eventName, action.argument);\n        events.push(...e);\n        results.push(...r);\n    }\n    return [events, results];\n}\nfunction eventActions(state, objects, context, file, eventName, argument) {\n    if (file === undefined) {\n        return;\n    }\n    const otherObjects = objects.filter(o => o !== file);\n    const sortedObjects = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(objects, o => o !== file);\n    const filters = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"filtersMatchingArguments\"])(context, file, eventName, otherObjects);\n    const scripts = filters\n        .map(f => {\n        const result = Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"calculateFileValue\"])(context, file, f.tag);\n        if (result) {\n            return `(function() { ${result.toString()} }).call(this)`;\n        }\n        else {\n            return result;\n        }\n    })\n        .filter(r => Object(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"hasValue\"])(r));\n    const result = formulaActions(state, context, sortedObjects, argument, scripts);\n    return result;\n}\nfunction formulaActions(state, context, sortedObjects, argument, scripts) {\n    let previous = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"getActions\"])();\n    let prevContext = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"getCalculationContext\"])();\n    let prevState = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"getFileState\"])();\n    let prevUserId = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"getUserId\"])();\n    let prevEnergy = Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"getEnergy\"])();\n    let actions = [];\n    let vars = {};\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setActions\"])(actions);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setFileState\"])(state);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setCalculationContext\"])(context);\n    // TODO: Allow configuring energy per action\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setEnergy\"])(_FileCalculations__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_ENERGY\"]);\n    if (typeof argument === 'undefined') {\n        sortedObjects.forEach((obj, index) => {\n            if (index === 1) {\n                vars['that'] = obj;\n            }\n            vars[`arg${index}`] = obj;\n        });\n    }\n    else {\n        vars['that'] = argument;\n    }\n    let results = [];\n    for (let script of scripts) {\n        const result = context.sandbox.run(script, {}, sortedObjects[0], vars);\n        if (result.error) {\n            throw result.error;\n        }\n        results.push(result.result);\n    }\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setActions\"])(previous);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setFileState\"])(prevState);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setCalculationContext\"])(prevContext);\n    Object(_Formulas_formula_lib_globals__WEBPACK_IMPORTED_MODULE_1__[\"setEnergy\"])(prevEnergy);\n    return [actions, results];\n}\n//# sourceMappingURL=FilesChannel.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Files/index.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Files/index.js ***!
  \*******************************************************************/
/*! exports provided: DEFAULT_USER_MODE, DEFAULT_SELECTION_MODE, DEFAULT_FILE_SHAPE, DEFAULT_LABEL_ANCHOR, DEFAULT_WORKSPACE_HEIGHT, DEFAULT_WORKSPACE_SIZE, DEFAULT_WORKSPACE_SCALE, DEFAULT_MINI_WORKSPACE_SCALE, DEFAULT_WORKSPACE_GRID_SCALE, DEFAULT_WORKSPACE_HEIGHT_INCREMENT, DEFAULT_WORKSPACE_MIN_HEIGHT, DEFAULT_WORKSPACE_COLOR, DEFAULT_SCENE_BACKGROUND_COLOR, DEFAULT_BUILDER_USER_COLOR, DEFAULT_PLAYER_USER_COLOR, DEFAULT_USER_INACTIVE_TIME, DEFAULT_USER_DELETION_TIME, GLOBALS_FILE_ID, AUX_FILE_VERSION, KNOWN_TAGS, fileAdded, fileRemoved, fileUpdated, transaction, action, addState, pasteState, toast, tweenTo, openQRCodeScanner, showQRCode, loadSimulation, unloadSimulation, superShout, goToContext, importAUX, showInputForTag, setForcedOffline, goToURL, openURL, sayHello, echo, grantRole, revokeRole, shell, openConsole, isFormulaObjectSymbol, ShortId_Length, COMBINE_ACTION_NAME, DIFF_ACTION_NAME, CREATE_ACTION_NAME, DESTROY_ACTION_NAME, DROP_IN_CONTEXT_ACTION_NAME, DROP_ANY_IN_CONTEXT_ACTION_NAME, DRAG_OUT_OF_CONTEXT_ACTION_NAME, DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME, DRAG_OUT_OF_INVENTORY_ACTION_NAME, DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME, DROP_IN_INVENTORY_ACTION_NAME, DROP_ANY_IN_INVENTORY_ACTION_NAME, ON_QR_CODE_SCANNED_ACTION_NAME, ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME, ON_QR_CODE_SCANNER_OPENED_ACTION_NAME, DEFAULT_ENERGY, hasValue, cleanFile, isMinimized, isContext, isVisibleContext, filterFilesBySelection, fileTags, getAllFileTags, filesFromShortIds, fileFromShortId, getShortId, isHiddenTag, isPrecalculated, calculateFileValue, calculateFormattedFileValue, isFormula, isAssignment, containsFormula, isArray, parseArray, isNumber, isFile, getActiveObjects, isFilterTag, isTagWellKnown, doFilesAppearEqual, validateTag, selectionIdForUser, updateUserSelection, toggleFileSelection, newSelectionId, getUserFileColor, getUserMenuId, getFilesInMenu, getUserAccountFile, getTokensForUserAccount, findMatchingToken, getFileRoles, filesInContext, addToContextDiff, removeFromContextDiff, setPositionDiff, addFileToMenu, removeFileFromMenu, tagsOnFile, getTag, getFileTag, createContextId, createFile, createPrecalculatedFile, createWorkspace, updateFile, calculateGridScale, calculateStateDiff, trimTag, filtersMatchingArguments, filterMatchesArguments, isInUsernameList, getFileUsernameList, getFileStringList, whitelistOrBlacklistAllowsAccess, whitelistAllowsAccess, blacklistAllowsAccess, getFileWhitelist, getFileBlacklist, getFileDesignerList, getFileVersion, getFileIndex, getFilePosition, getFileRotation, getFileInputTarget, getFileInputPlaceholder, getFileShape, getFileLabelAnchor, isConfigForContext, isContextLocked, getFileConfigContexts, getContextValue, getFileDragMode, isFileStackable, isFileMovable, isFileListening, isContextMovable, getContextPosition, getContextRotation, getContextMinimized, getContextColor, getContextSize, getContextVisualizeMode, getBuilderContextGrid, getContextGridHeight, getContextGridScale, getContextScale, getContextDefaultHeight, objectsAtContextGridPosition, isUserFile, objectsAtWorkspace, duplicateFile, filterWellKnownAndContextTags, getContexts, isWellKnownOrContext, isDiff, isMergeable, isPickupable, getDiffUpdate, getDiffTags, simulationIdToString, parseSimulationId, normalizeAUXFileURL, parseFilterTag, getUserMode, getSelectionMode, calculateFileValueAsFile, calculateStringListTagValue, calculateNumericalTagValue, calculateBooleanTagValue, isDestroyable, isEditable, isSimulation, getFileChannel, getChannelFileById, getChannelConnectedDevices, getChannelMaxDevicesAllowed, getMaxDevicesAllowed, getConnectedDevices, isFileInContext, fileContextSortOrder, calculateFormulaValue, isUserActive, shouldDeleteUser, formatValue, calculateValue, calculateCopiableValue, convertToCopiableValue, createFormulaLibrary, createCalculationContext, createPrecalculatedContext, createCalculationContextFromState, calculateActionEventsUsingContext, calculateActionResultsUsingContext, getFilesForAction, calculateFileActionEvents, formulaActions, searchFileState, calculateActionResults, calculateActionEvents, calculateFormulaEvents, calculateDestroyFileEvents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _File__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./File */ \"./node_modules/@casual-simulation/aux-common/Files/File.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_MODE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_MODE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SELECTION_MODE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_SELECTION_MODE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_FILE_SHAPE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_FILE_SHAPE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_LABEL_ANCHOR\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_LABEL_ANCHOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_HEIGHT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SIZE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SIZE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SCALE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_MINI_WORKSPACE_SCALE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_MINI_WORKSPACE_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_GRID_SCALE\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_GRID_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT_INCREMENT\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_HEIGHT_INCREMENT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_MIN_HEIGHT\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_MIN_HEIGHT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_COLOR\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_WORKSPACE_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SCENE_BACKGROUND_COLOR\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_SCENE_BACKGROUND_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_BUILDER_USER_COLOR\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_BUILDER_USER_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_PLAYER_USER_COLOR\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_PLAYER_USER_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_INACTIVE_TIME\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_INACTIVE_TIME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_DELETION_TIME\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_DELETION_TIME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GLOBALS_FILE_ID\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"GLOBALS_FILE_ID\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AUX_FILE_VERSION\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"AUX_FILE_VERSION\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"KNOWN_TAGS\", function() { return _File__WEBPACK_IMPORTED_MODULE_0__[\"KNOWN_TAGS\"]; });\n\n/* harmony import */ var _FileEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FileEvents */ \"./node_modules/@casual-simulation/aux-common/Files/FileEvents.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileAdded\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileAdded\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileRemoved\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileRemoved\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileUpdated\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileUpdated\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"transaction\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"transaction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"action\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"action\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addState\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"addState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pasteState\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"pasteState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"toast\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"toast\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tweenTo\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"tweenTo\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openQRCodeScanner\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openQRCodeScanner\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"showQRCode\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"showQRCode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"loadSimulation\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"loadSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"unloadSimulation\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"unloadSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"superShout\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"superShout\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"goToContext\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"goToContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"importAUX\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"importAUX\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"showInputForTag\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"showInputForTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setForcedOffline\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"setForcedOffline\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"goToURL\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"goToURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openURL\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"sayHello\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"sayHello\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"echo\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"echo\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"grantRole\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"grantRole\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"revokeRole\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"revokeRole\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"shell\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"shell\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openConsole\", function() { return _FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openConsole\"]; });\n\n/* harmony import */ var _FileCalculations__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FileCalculations */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFormulaObjectSymbol\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFormulaObjectSymbol\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ShortId_Length\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"ShortId_Length\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"COMBINE_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"COMBINE_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DIFF_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DIFF_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CREATE_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"CREATE_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DESTROY_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DESTROY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_CONTEXT_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DROP_IN_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_CONTEXT_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DROP_ANY_IN_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_CONTEXT_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_OUT_OF_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_INVENTORY_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_OUT_OF_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_INVENTORY_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DROP_IN_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_INVENTORY_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DROP_ANY_IN_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNED_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_OPENED_ACTION_NAME\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNER_OPENED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_ENERGY\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_ENERGY\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"hasValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"hasValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"cleanFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"cleanFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isMinimized\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isMinimized\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isVisibleContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isVisibleContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterFilesBySelection\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filterFilesBySelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileTags\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"fileTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAllFileTags\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getAllFileTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filesFromShortIds\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filesFromShortIds\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileFromShortId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"fileFromShortId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getShortId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getShortId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isHiddenTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isHiddenTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isPrecalculated\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isPrecalculated\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateFileValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormattedFileValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateFormattedFileValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFormula\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFormula\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isAssignment\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isAssignment\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"containsFormula\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"containsFormula\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isArray\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseArray\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"parseArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isNumber\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isNumber\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getActiveObjects\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getActiveObjects\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFilterTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFilterTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isTagWellKnown\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isTagWellKnown\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"doFilesAppearEqual\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"doFilesAppearEqual\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"validateTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"validateTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"selectionIdForUser\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"selectionIdForUser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"updateUserSelection\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"updateUserSelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"toggleFileSelection\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"toggleFileSelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"newSelectionId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"newSelectionId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserFileColor\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getUserFileColor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserMenuId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getUserMenuId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesInMenu\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFilesInMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserAccountFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getUserAccountFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTokensForUserAccount\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getTokensForUserAccount\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"findMatchingToken\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"findMatchingToken\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileRoles\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileRoles\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filesInContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filesInContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addToContextDiff\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"addToContextDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"removeFromContextDiff\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"removeFromContextDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setPositionDiff\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"setPositionDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addFileToMenu\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"addFileToMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"removeFileFromMenu\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"removeFileFromMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tagsOnFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"tagsOnFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createContextId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"createContextId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"createFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"createPrecalculatedFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createWorkspace\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"createWorkspace\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"updateFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"updateFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateGridScale\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateGridScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateStateDiff\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateStateDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"trimTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"trimTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filtersMatchingArguments\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filtersMatchingArguments\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterMatchesArguments\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filterMatchesArguments\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isInUsernameList\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isInUsernameList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileUsernameList\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileUsernameList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileStringList\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileStringList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"whitelistOrBlacklistAllowsAccess\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"whitelistOrBlacklistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"whitelistAllowsAccess\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"whitelistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"blacklistAllowsAccess\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"blacklistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileWhitelist\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileWhitelist\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileBlacklist\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileBlacklist\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileDesignerList\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileDesignerList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileVersion\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileIndex\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileIndex\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilePosition\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFilePosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileRotation\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileRotation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileInputTarget\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileInputTarget\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileInputPlaceholder\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileInputPlaceholder\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileShape\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileShape\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileLabelAnchor\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileLabelAnchor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isConfigForContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isConfigForContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContextLocked\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isContextLocked\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileConfigContexts\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileConfigContexts\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileDragMode\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileDragMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileStackable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFileStackable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileMovable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFileMovable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileListening\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFileListening\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContextMovable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isContextMovable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextPosition\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextPosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextRotation\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextRotation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextMinimized\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextMinimized\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextColor\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextColor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextSize\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextSize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextVisualizeMode\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextVisualizeMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getBuilderContextGrid\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getBuilderContextGrid\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextGridHeight\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextGridHeight\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextGridScale\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextGridScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextScale\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextDefaultHeight\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContextDefaultHeight\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"objectsAtContextGridPosition\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"objectsAtContextGridPosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isUserFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isUserFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"objectsAtWorkspace\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"objectsAtWorkspace\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"duplicateFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"duplicateFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterWellKnownAndContextTags\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"filterWellKnownAndContextTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContexts\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getContexts\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isWellKnownOrContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isWellKnownOrContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isDiff\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isMergeable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isMergeable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isPickupable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isPickupable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getDiffUpdate\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getDiffUpdate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getDiffTags\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getDiffTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"simulationIdToString\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"simulationIdToString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseSimulationId\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"parseSimulationId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"normalizeAUXFileURL\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"normalizeAUXFileURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseFilterTag\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"parseFilterTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserMode\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getUserMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getSelectionMode\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getSelectionMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValueAsFile\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateFileValueAsFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateStringListTagValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateStringListTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateNumericalTagValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateNumericalTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateBooleanTagValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateBooleanTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isDestroyable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isDestroyable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isEditable\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isEditable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isSimulation\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileChannel\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getFileChannel\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelFileById\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getChannelFileById\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelConnectedDevices\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getChannelConnectedDevices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelMaxDevicesAllowed\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getChannelMaxDevicesAllowed\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getMaxDevicesAllowed\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getMaxDevicesAllowed\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getConnectedDevices\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"getConnectedDevices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileInContext\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isFileInContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileContextSortOrder\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"fileContextSortOrder\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateFormulaValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isUserActive\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"isUserActive\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"shouldDeleteUser\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"shouldDeleteUser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formatValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"formatValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateCopiableValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"calculateCopiableValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"convertToCopiableValue\", function() { return _FileCalculations__WEBPACK_IMPORTED_MODULE_2__[\"convertToCopiableValue\"]; });\n\n/* harmony import */ var _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FileCalculationContextFactories */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculationContextFactories.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createFormulaLibrary\", function() { return _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_3__[\"createFormulaLibrary\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContext\", function() { return _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_3__[\"createCalculationContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedContext\", function() { return _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_3__[\"createPrecalculatedContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContextFromState\", function() { return _FileCalculationContextFactories__WEBPACK_IMPORTED_MODULE_3__[\"createCalculationContextFromState\"]; });\n\n/* harmony import */ var _FilesChannel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./FilesChannel */ \"./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEventsUsingContext\", function() { return _FilesChannel__WEBPACK_IMPORTED_MODULE_4__[\"calculateActionEventsUsingContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResultsUsingContext\", function() { return _FilesChannel__WEBPACK_IMPORTED_MODULE_4__[\"calculateActionResultsUsingContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesForAction\", function() { return _FilesChannel__WEBPACK_IMPORTED_MODULE_4__[\"getFilesForAction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileActionEvents\", function() { return _FilesChannel__WEBPACK_IMPORTED_MODULE_4__[\"calculateFileActionEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formulaActions\", function() { return _FilesChannel__WEBPACK_IMPORTED_MODULE_4__[\"formulaActions\"]; });\n\n/* harmony import */ var _FileActions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./FileActions */ \"./node_modules/@casual-simulation/aux-common/Files/FileActions.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"searchFileState\", function() { return _FileActions__WEBPACK_IMPORTED_MODULE_5__[\"searchFileState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResults\", function() { return _FileActions__WEBPACK_IMPORTED_MODULE_5__[\"calculateActionResults\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEvents\", function() { return _FileActions__WEBPACK_IMPORTED_MODULE_5__[\"calculateActionEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaEvents\", function() { return _FileActions__WEBPACK_IMPORTED_MODULE_5__[\"calculateFormulaEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateDestroyFileEvents\", function() { return _FileActions__WEBPACK_IMPORTED_MODULE_5__[\"calculateDestroyFileEvents\"]; });\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Files/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/Dependencies.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/Dependencies.js ***!
  \*****************************************************************************/
/*! exports provided: Dependencies */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Dependencies\", function() { return Dependencies; });\n/* harmony import */ var _Transpiler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Transpiler */ \"./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js\");\n/* harmony import */ var estraverse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! estraverse */ \"estraverse\");\n/* harmony import */ var estraverse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(estraverse__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Files__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Files */ \"./node_modules/@casual-simulation/aux-common/Files/index.js\");\n\n\n\n\nclass Dependencies {\n    constructor() {\n        this._transpiler = new _Transpiler__WEBPACK_IMPORTED_MODULE_0__[\"Transpiler\"]();\n    }\n    /**\n     * Calculates which tags and files the given code is dependent on.\n     */\n    calculateAuxDependencies(code) {\n        try {\n            const tree = this.dependencyTree(code);\n            const simple = this.simplify(tree);\n            const replaced = this.replaceAuxDependencies(simple);\n            const flat = this.flatten(replaced);\n            return (flat.filter(f => f.type === 'all' ||\n                f.type === 'tag' ||\n                f.type === 'file' ||\n                f.type === 'this' ||\n                f.type === 'tag_value'));\n        }\n        catch (e) {\n            if (e instanceof SyntaxError) {\n                return [];\n            }\n            else {\n                throw e;\n            }\n        }\n    }\n    /**\n     * Gets a dependency tree for the given code.\n     * @param code The code to parse into a dependency tree.\n     */\n    dependencyTree(code) {\n        const node = this._transpiler.parse(code);\n        return this._expressionDependencies(node);\n    }\n    /**\n     * Reduces the given Dependency Tree to a list of simplified dependencies.\n     * Useful to reduce the amount of information that the tree contains and make it easier to process.\n     * @param node The root node of the dependency tree.\n     */\n    simplify(node) {\n        if (node.type === 'expression') {\n            return this._simpleExpressionDependencies(node);\n        }\n        else if (node.type === 'file' || node.type === 'tag') {\n            return this._simpleTagDependencies(node);\n        }\n        else if (node.type === 'call') {\n            return this._simpleFunctionDependencies(node);\n        }\n        else if (node.type === 'member') {\n            return this._simpleMemberDependencies(node);\n        }\n        else if (node.type === 'literal') {\n            return this._simpleLiteralDependencies(node);\n        }\n        return [];\n    }\n    /**\n     * Flattens the given list to make it easy to de-duplicate dependencies.\n     * @param nodes The nodes to flatten.\n     */\n    flatten(nodes) {\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(nodes, n => {\n            if (n.type === 'file' ||\n                n.type === 'tag' ||\n                n.type === 'function' ||\n                n.type === 'tag_value') {\n                return [n, ...this.flatten(n.dependencies)];\n            }\n            return n;\n        });\n    }\n    /**\n     * Replaces all dependencies on AUX functions with their related dependencies on files/tags.\n     * @param nodes The nodes to perform the replacements on.\n     */\n    replaceAuxDependencies(nodes) {\n        return this.replaceDependencies(nodes, auxDependencies(this));\n    }\n    /**\n     * Replaces matching function calls in the given list of simplified dependencies with their actual dependencies.\n     * This is useful to be able to match functions like getFilesInContext(\"context_a\") to the actual dependency.\n     */\n    replaceDependencies(nodes, replacements) {\n        return [...iterator.call(this)];\n        function* iterator() {\n            for (let node of nodes) {\n                let replaced = false;\n                if (node.type !== 'literal' &&\n                    node.type !== 'all' &&\n                    node.type !== 'this') {\n                    const replacement = replacements[node.name];\n                    if (replacement) {\n                        yield* replacement(node);\n                        replaced = true;\n                    }\n                }\n                if (!replaced) {\n                    if (node.type === 'function' ||\n                        node.type === 'file' ||\n                        node.type === 'tag') {\n                        yield Object.assign({}, node, { dependencies: this.replaceDependencies(node.dependencies, replacements) });\n                    }\n                    else {\n                        yield node;\n                    }\n                }\n            }\n        }\n    }\n    _simpleMemberDependencies(node) {\n        let root = this._rootMembers(node);\n        if (root) {\n            return this._simpleRootDependencies(root);\n        }\n        const name = this.getMemberName(node);\n        if (name.indexOf('this') === 0) {\n            return [{ type: 'this' }];\n        }\n        return [\n            {\n                type: 'member',\n                name: name,\n            },\n        ];\n    }\n    _rootMembers(node) {\n        let current = node;\n        while (current) {\n            if (current.type === 'member') {\n                current = current.object;\n            }\n            else if (current.type === 'call') {\n                return current;\n            }\n            else {\n                return current;\n            }\n        }\n        return null;\n    }\n    _simpleRootDependencies(root) {\n        if (root.type === 'file' || root.type === 'tag') {\n            return this._simpleTagDependencies(root);\n        }\n        else if (root.type === 'call') {\n            return this._simpleFunctionDependencies(root);\n        }\n        else {\n            return [];\n        }\n    }\n    _simpleFunctionDependencies(node) {\n        let current = this._rootMembers(node.identifier);\n        if (current) {\n            return [\n                ...this._simpleRootDependencies(current),\n                ...Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(node.dependencies, d => this.simplify(d)),\n            ];\n        }\n        return [\n            {\n                type: 'function',\n                name: this.getMemberName(node.identifier),\n                dependencies: Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(node.dependencies, d => this.simplify(d)),\n            },\n        ];\n    }\n    _simpleTagDependencies(node) {\n        return [\n            {\n                type: node.type,\n                name: this.getMemberName(node),\n                dependencies: Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(node.dependencies, d => this.simplify(d)),\n            },\n        ];\n    }\n    _simpleExpressionDependencies(node) {\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(node.dependencies, d => this.simplify(d));\n    }\n    _simpleLiteralDependencies(node) {\n        return [node];\n    }\n    /**\n     * Gets the full name of the given member node.\n     * @param node The node.\n     */\n    getMemberName(node) {\n        let stack = [];\n        let current = node;\n        while (current) {\n            if (current.type === 'member') {\n                stack.unshift(current.identifier);\n                current = current.object;\n            }\n            else if (current.type === 'call') {\n                stack.unshift('()');\n                current = current.identifier;\n            }\n            else {\n                stack.unshift(`${current.name}`);\n                current = null;\n            }\n        }\n        return stack.join('.');\n    }\n    _expressionDependencies(node) {\n        let tags = [];\n        Object(estraverse__WEBPACK_IMPORTED_MODULE_1__[\"traverse\"])(node, {\n            enter: (node, parent) => {\n                const dep = this._nodeDependency(node, parent);\n                if (dep) {\n                    tags.push(dep);\n                    return estraverse__WEBPACK_IMPORTED_MODULE_1__[\"VisitorOption\"].Skip;\n                }\n            },\n            keys: {\n                ObjectValue: ['identifier'],\n                TagValue: ['identifier'],\n            },\n        });\n        return {\n            type: 'expression',\n            dependencies: tags,\n        };\n    }\n    _nodeDependency(node, parent) {\n        if (parent &&\n            (parent.type === 'ArrowFunctionExpression' ||\n                parent.type === 'FunctionExpression')) {\n            return null;\n        }\n        if (node.type === 'MemberExpression') {\n            return this._memberDependency(node);\n        }\n        else if (node.type === 'ThisExpression') {\n            return this._thisDependency(node);\n        }\n        else if (node.type === 'TagValue' || node.type === 'ObjectValue') {\n            return this._tagDependency(node);\n        }\n        else if (node.type === 'CallExpression') {\n            return this._callDependency(node);\n        }\n        else if (node.type === 'Literal') {\n            return this._literalDependency(node);\n        }\n        else if (node.type === 'Identifier') {\n            return this._identifierDependency(node);\n        }\n        return null;\n    }\n    _literalDependency(node) {\n        return {\n            type: 'literal',\n            value: node.value,\n        };\n    }\n    _callDependency(node) {\n        return {\n            type: 'call',\n            identifier: this._objectDependency(node.callee, node),\n            dependencies: node.arguments\n                .map((arg) => this._nodeDependency(arg, node) ||\n                this._expressionDependencies(arg))\n                .filter((arg) => !!arg),\n        };\n    }\n    _tagDependency(node) {\n        const { tag, args, nodes } = this._transpiler.getTagNodeValues(node);\n        return {\n            type: node.type === 'TagValue' ? 'tag' : 'file',\n            name: tag,\n            dependencies: args\n                .map(a => {\n                const dep = this._nodeDependency(a, node);\n                if (dep) {\n                    return dep;\n                }\n                return this._expressionDependencies(a);\n            })\n                .filter(e => e.type === 'expression' ? e.dependencies.length > 0 : true),\n        };\n    }\n    _memberDependency(node) {\n        return {\n            type: 'member',\n            identifier: this._getIdentifier(node),\n            object: this._objectDependency(node.object, node),\n        };\n    }\n    _objectDependency(node, parent) {\n        if (node.type === 'Identifier') {\n            return this._identifierDependency(node);\n        }\n        else {\n            const dependency = this._nodeDependency(node, parent);\n            if (dependency.type === 'member' ||\n                dependency.type === 'tag' ||\n                dependency.type === 'file' ||\n                dependency.type === 'call') {\n                return dependency;\n            }\n        }\n        return null;\n    }\n    _identifierDependency(node) {\n        return {\n            type: 'member',\n            identifier: node.name,\n            object: null,\n        };\n    }\n    _thisDependency(node) {\n        return {\n            type: 'member',\n            identifier: 'this',\n            object: null,\n        };\n    }\n    _getIdentifier(node) {\n        if (!node.computed && node.property.type === 'Identifier') {\n            return node.property.name;\n        }\n        else if (node.property.type === 'Literal') {\n            return node.property.value;\n        }\n        else {\n            return null;\n        }\n    }\n}\nfunction auxDependencies(dependencies) {\n    function replace(nodes) {\n        return dependencies.replaceDependencies(nodes, auxDependencies(dependencies));\n    }\n    return {\n        getTag: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 2) {\n                const extras = node.dependencies.slice(1);\n                return extras.map((n, i) => {\n                    const name = getTagName(n);\n                    if (!name) {\n                        return { type: 'all' };\n                    }\n                    return {\n                        type: 'tag_value',\n                        name: name,\n                        dependencies: i === 0 ? replace([node.dependencies[0]]) : [],\n                    };\n                });\n            }\n            return [];\n        },\n        getBot: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 1) {\n                const name = getTagName(node.dependencies[0]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'file',\n                        name: name,\n                        dependencies: replace(node.dependencies.slice(1)),\n                    },\n                ];\n            }\n            return [];\n        },\n        getBots: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 1) {\n                const name = getTagName(node.dependencies[0]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'file',\n                        name: name,\n                        dependencies: replace(node.dependencies.slice(1)),\n                    },\n                ];\n            }\n            return [];\n        },\n        getBotTagValues: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 1) {\n                const name = getTagName(node.dependencies[0]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'tag',\n                        name: name,\n                        dependencies: replace(node.dependencies.slice(1)),\n                    },\n                ];\n            }\n            return [];\n        },\n        getBotsInContext: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 1) {\n                const name = getNodeValue(node.dependencies[0]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'file',\n                        name: name,\n                        dependencies: [],\n                    },\n                ];\n            }\n            return [];\n        },\n        getBotsInStack: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 2) {\n                const name = getNodeValue(node.dependencies[1]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'file',\n                        name: name,\n                        dependencies: [],\n                    },\n                    {\n                        type: 'file',\n                        name: name + '.x',\n                        dependencies: [],\n                    },\n                    {\n                        type: 'file',\n                        name: name + '.y',\n                        dependencies: [],\n                    },\n                ];\n            }\n            return [];\n        },\n        getNeighboringBots: (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            if (node.dependencies.length >= 2) {\n                const name = getNodeValue(node.dependencies[1]);\n                if (!name) {\n                    return [{ type: 'all' }];\n                }\n                return [\n                    {\n                        type: 'file',\n                        name: name,\n                        dependencies: [],\n                    },\n                    {\n                        type: 'file',\n                        name: name + '.x',\n                        dependencies: [],\n                    },\n                    {\n                        type: 'file',\n                        name: name + '.y',\n                        dependencies: [],\n                    },\n                ];\n            }\n            return [];\n        },\n        'player.isDesigner': (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            return [\n                {\n                    type: 'tag',\n                    name: 'aux.designers',\n                    dependencies: [],\n                },\n            ];\n        },\n        'player.currentContext': (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            return [\n                {\n                    type: 'tag',\n                    name: 'aux._userContext',\n                    dependencies: [],\n                },\n            ];\n        },\n        'player.getMenuContext': (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            return [\n                {\n                    type: 'tag',\n                    name: 'aux._userMenuContext',\n                    dependencies: [],\n                },\n            ];\n        },\n        'player.getInventoryContext': (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            return [\n                {\n                    type: 'tag',\n                    name: 'aux._userInventoryContext',\n                    dependencies: [],\n                },\n            ];\n        },\n        'player.hasFileInInventory': (node) => {\n            if (node.type !== 'function') {\n                return [node];\n            }\n            return [\n                {\n                    type: 'all',\n                },\n            ];\n        },\n    };\n}\nfunction getTagName(node) {\n    const val = getNodeValue(node);\n    if (val) {\n        return Object(_Files__WEBPACK_IMPORTED_MODULE_3__[\"trimTag\"])(val);\n    }\n    return null;\n}\nfunction getNodeValue(node) {\n    if (node.type === 'literal') {\n        return node.value.toString();\n    }\n    return null;\n}\n//# sourceMappingURL=Dependencies.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/Dependencies.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/EvalSandbox.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/EvalSandbox.js ***!
  \****************************************************************************/
/*! exports provided: EvalSandbox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EvalSandbox\", function() { return EvalSandbox; });\n/* harmony import */ var _Transpiler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Transpiler */ \"./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n/**\n * Defines a formula sandbox that uses JavaScript's eval function to run code.\n * Not a real sandbox BTW. No security is gained from using this right now.\n */\nclass EvalSandbox {\n    constructor(lib, interface_) {\n        this._recursionCounter = 0;\n        this._transpiler = new _Transpiler__WEBPACK_IMPORTED_MODULE_0__[\"Transpiler\"]();\n        this._lib = lib;\n        this.interface = interface_;\n    }\n    static get messages() {\n        return EvalSandbox._messages;\n    }\n    /**\n     * Gets the library that the sandbox is using.\n     */\n    get library() {\n        return this._lib;\n    }\n    /**\n     * Runs the given formula JavaScript and returns the result.\n     * @param formula The formula to run inside the sandbox.\n     * @param extras The extra data to include in the run. These extras are passed to the interface during execution.\n     * @param context The object that should be mapped to \"this\" during execution. Enables usage of \"this\" inside formulas.\n     */\n    run(formula, extras, context, variables = {}) {\n        return this._runJs(formula, extras, context, variables);\n    }\n    _runJs(__js, __extras, __context, __variables) {\n        const __this = this;\n        // This works because even though we never decrement\n        // the counter we are recreating the sandbox a lot and that\n        // resets the counter. Overall, this should behave as a\n        // safeguard against infinite loops.\n        if (__this._recursionCounter > 1000) {\n            return {\n                success: false,\n                extras: __extras,\n                error: new Error('Ran out of energy'),\n                logs: [],\n            };\n        }\n        // Using underscores to make these functions and parameters not collide\n        // with other stuff the user might use.\n        function _listTagValues(tag, filter) {\n            return __this.interface.listTagValues(tag, filter, __extras);\n        }\n        function _listObjectsWithTag(tag, filter) {\n            return __this.interface.listObjectsWithTag(tag, filter, __extras);\n        }\n        function uuid() {\n            return __this.interface.uuid();\n        }\n        function list(obj, context) {\n            return __this.interface.list(obj, context);\n        }\n        function __evalWrapper(js) {\n            const finalVars = Object(_utils__WEBPACK_IMPORTED_MODULE_2__[\"merge\"])(__this._lib, __variables);\n            const final = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"keys\"])(finalVars)\n                .map(v => `var ${v} = finalVars[\"${v}\"];`)\n                .join('\\n') +\n                '\\n' +\n                js;\n            return eval(final);\n        }\n        let logs = [];\n        try {\n            this._recursionCounter += 1;\n            const __transpiled = this._transpile(__js);\n            const prevLog = EvalSandbox._wrap('log', 'script', logs);\n            const prevWarn = EvalSandbox._wrap('warn', 'script', logs);\n            const prevError = EvalSandbox._wrap('error', 'script', logs);\n            try {\n                const result = __context\n                    ? __evalWrapper.call(__context, __transpiled)\n                    : __evalWrapper(__transpiled);\n                return {\n                    success: true,\n                    extras: __extras,\n                    result,\n                    logs: logs,\n                };\n            }\n            finally {\n                console.log = prevLog;\n                console.warn = prevWarn;\n                console.error = prevError;\n            }\n        }\n        catch (e) {\n            if (e instanceof Error) {\n                const msg = {\n                    type: 'error',\n                    messages: [e.toString()],\n                    stack: e.stack,\n                    source: 'script',\n                };\n                logs.push(msg);\n                EvalSandbox._messages.next(msg);\n            }\n            return {\n                success: false,\n                extras: __extras,\n                error: e,\n                logs: logs,\n            };\n        }\n        finally {\n            this._recursionCounter -= 1;\n        }\n    }\n    _transpile(exJs) {\n        return this._transpiler.transpile(exJs);\n    }\n    static _wrap(type, source, logs) {\n        let prev = console[type];\n        console[type] = function () {\n            let msg = {\n                type: type,\n                messages: [...arguments],\n                stack: new Error().stack,\n                source: source,\n            };\n            logs.push(msg);\n            EvalSandbox._messages.next(msg);\n            return prev.apply(this, arguments);\n        };\n        return prev;\n    }\n}\nEvalSandbox._messages = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n//# sourceMappingURL=EvalSandbox.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/EvalSandbox.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js ***!
  \***************************************************************************/
/*! exports provided: anyArgument, Transpiler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"anyArgument\", function() { return anyArgument; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Transpiler\", function() { return Transpiler; });\n/* harmony import */ var acorn__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! acorn */ \"acorn\");\n/* harmony import */ var acorn__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(acorn__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var astring__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! astring */ \"astring\");\n/* harmony import */ var astring__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(astring__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lru-cache */ \"lru-cache\");\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lru_cache__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var estraverse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! estraverse */ \"estraverse\");\n/* harmony import */ var estraverse__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(estraverse__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n/**\n * The symbol that is used in script dependencies to represent any argument.\n */\nconst anyArgument = Symbol('anyArgument');\nconst exJsGenerator = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"assign\"])({}, astring__WEBPACK_IMPORTED_MODULE_1__[\"baseGenerator\"], {});\n/**\n * Defines a class that is able to compile code from AUX's custom JavaScript dialect\n * into pure ES6 JavaScript. Does not preserve spacing or comments.\n *\n * See https://docs.google.com/document/d/1WQXQPjdXxyx_lau15WPpwTTYvt66_wPCu3x-08rpLoY/edit?usp=sharing\n */\nclass Transpiler {\n    constructor() {\n        /**\n         * The list of macros that the sandbox uses on the input code before transpiling it.\n         */\n        this.macros = [\n            {\n                test: /^(?:\\=|\\:\\=)/g,\n                replacement: val => '',\n            },\n            {\n                test: /(?:[])/g,\n                replacement: val => '\"',\n            },\n            {\n                test: /(?:[])/g,\n                replacement: val => \"'\",\n            },\n        ];\n        this._cache = new lru_cache__WEBPACK_IMPORTED_MODULE_3___default.a({\n            max: 1000,\n        });\n        this._parser = acorn__WEBPACK_IMPORTED_MODULE_0__[\"Parser\"];\n    }\n    /**\n     * Transpiles the given code into ES6 JavaScript Code.\n     */\n    transpile(code) {\n        const cached = this._cache.get(code);\n        if (cached) {\n            return cached;\n        }\n        const node = this.parse(code);\n        const replaced = this._replace(node);\n        const final = this.toJs(replaced);\n        this._cache.set(code, final);\n        return final;\n    }\n    /**\n     * Parses the given code into a syntax tree.\n     * @param code\n     */\n    parse(code) {\n        const macroed = this._replaceMacros(code);\n        const node = this._parser.parse(macroed);\n        return node;\n    }\n    /**\n     * Adds the given macro to the list of macros that are run on the code\n     * before execution.\n     */\n    addMacro(macro) {\n        this.macros.push(macro);\n    }\n    getTagNodeValues(n) {\n        let currentNode = n.identifier;\n        let identifier;\n        let args = [];\n        let nodes = [];\n        while (currentNode.type === 'MemberExpression') {\n            currentNode = currentNode.object;\n        }\n        if (currentNode.type === 'CallExpression') {\n            identifier = currentNode.callee;\n            args = currentNode.arguments;\n            currentNode = n.identifier;\n            while (currentNode.type === 'MemberExpression') {\n                nodes.unshift(currentNode);\n                currentNode = currentNode.object;\n            }\n        }\n        else {\n            identifier = n.identifier;\n        }\n        let tag;\n        if (identifier.type === 'MemberExpression') {\n            tag = this.toJs(identifier);\n        }\n        else {\n            tag = identifier.name || identifier.value;\n        }\n        return { tag, args, nodes };\n    }\n    toJs(node) {\n        return Object(astring__WEBPACK_IMPORTED_MODULE_1__[\"generate\"])(node, {\n            generator: exJsGenerator,\n        });\n    }\n    _replace(node) {\n        if (!node) {\n            return node;\n        }\n        return Object(estraverse__WEBPACK_IMPORTED_MODULE_4__[\"replace\"])(node, {\n            enter: ((n, parent) => {\n                if (n.type === 'WhileStatement') {\n                    return this._replaceWhileStatement(n);\n                }\n                else if (n.type === 'DoWhileStatement') {\n                    return this._replaceDoWhileStatement(n);\n                }\n                else if (n.type === 'ForStatement') {\n                    return this._replaceForStatement(n);\n                }\n                else if (n.type === 'ForInStatement') {\n                    return this._replaceForInStatement(n);\n                }\n                else if (n.type === 'ForOfStatement') {\n                    return this._replaceForOfStatement(n);\n                }\n            }),\n        });\n    }\n    _replaceWhileStatement(node) {\n        let replacedBody = node.body;\n        let existingStatements = [];\n        if (replacedBody.type === 'BlockStatement') {\n            existingStatements = replacedBody.body;\n        }\n        else {\n            existingStatements = [replacedBody];\n        }\n        return {\n            type: 'WhileStatement',\n            test: node.test,\n            body: {\n                type: 'BlockStatement',\n                body: [this._energyCheckCall(), ...existingStatements],\n            },\n        };\n    }\n    _replaceDoWhileStatement(node) {\n        let replacedBody = node.body;\n        let existingStatements = [];\n        if (replacedBody.type === 'BlockStatement') {\n            existingStatements = replacedBody.body;\n        }\n        else {\n            existingStatements = [replacedBody];\n        }\n        return {\n            type: 'DoWhileStatement',\n            test: node.test,\n            body: {\n                type: 'BlockStatement',\n                body: [this._energyCheckCall(), ...existingStatements],\n            },\n        };\n    }\n    _replaceForStatement(node) {\n        let replacedBody = node.body;\n        let existingStatements = [];\n        if (replacedBody.type === 'BlockStatement') {\n            existingStatements = replacedBody.body;\n        }\n        else {\n            existingStatements = [replacedBody];\n        }\n        return {\n            type: 'ForStatement',\n            init: node.init,\n            test: node.test,\n            update: node.update,\n            body: {\n                type: 'BlockStatement',\n                body: [this._energyCheckCall(), ...existingStatements],\n            },\n        };\n    }\n    _replaceForInStatement(node) {\n        let replacedBody = node.body;\n        let existingStatements = [];\n        if (replacedBody.type === 'BlockStatement') {\n            existingStatements = replacedBody.body;\n        }\n        else {\n            existingStatements = [replacedBody];\n        }\n        return {\n            type: 'ForInStatement',\n            left: node.left,\n            right: node.right,\n            body: {\n                type: 'BlockStatement',\n                body: [this._energyCheckCall(), ...existingStatements],\n            },\n        };\n    }\n    _replaceForOfStatement(node) {\n        let replacedBody = node.body;\n        let existingStatements = [];\n        if (replacedBody.type === 'BlockStatement') {\n            existingStatements = replacedBody.body;\n        }\n        else {\n            existingStatements = [replacedBody];\n        }\n        return {\n            type: 'ForOfStatement',\n            left: node.left,\n            right: node.right,\n            body: {\n                type: 'BlockStatement',\n                body: [this._energyCheckCall(), ...existingStatements],\n            },\n        };\n    }\n    _energyCheckCall() {\n        return {\n            type: 'ExpressionStatement',\n            expression: {\n                type: 'CallExpression',\n                callee: {\n                    type: 'Identifier',\n                    name: '__energyCheck',\n                },\n                arguments: [],\n            },\n        };\n    }\n    _replaceMacros(formula) {\n        if (!formula) {\n            return formula;\n        }\n        for (let m of this.macros) {\n            formula = formula.replace(m.test, m.replacement);\n        }\n        return formula;\n    }\n}\n//# sourceMappingURL=Transpiler.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js ***!
  \************************************************************************************/
/*! exports provided: setActions, getActions, setFileState, getFileState, setCalculationContext, getCalculationContext, getUserId, getEnergy, setEnergy */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setActions\", function() { return setActions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getActions\", function() { return getActions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setFileState\", function() { return setFileState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFileState\", function() { return getFileState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setCalculationContext\", function() { return setCalculationContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCalculationContext\", function() { return getCalculationContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUserId\", function() { return getUserId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEnergy\", function() { return getEnergy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setEnergy\", function() { return setEnergy; });\nlet actions = [];\nlet state = null;\nlet calc = null;\nlet currentEnergy = 0;\nfunction setActions(value) {\n    actions = value;\n}\nfunction getActions() {\n    return actions;\n}\nfunction setFileState(value) {\n    state = value;\n}\nfunction getFileState() {\n    return state;\n}\nfunction setCalculationContext(context) {\n    calc = context;\n}\nfunction getCalculationContext() {\n    return calc;\n}\nfunction getUserId() {\n    if (calc) {\n        return calc.sandbox.interface.userId();\n    }\n    else {\n        return null;\n    }\n}\nfunction getEnergy() {\n    return currentEnergy;\n}\nfunction setEnergy(energy) {\n    currentEnergy = energy;\n}\n//# sourceMappingURL=formula-lib-globals.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/formula-lib.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/formula-lib.js ***!
  \****************************************************************************/
/*! exports provided: sum, avg, sqrt, abs, stdDev, sort, randomInt, random, join, destroyFile, destroy, removeTags, mod, player, server, math, data, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sum\", function() { return sum; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"avg\", function() { return avg; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sqrt\", function() { return sqrt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"abs\", function() { return abs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"stdDev\", function() { return stdDev; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sort\", function() { return sort; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"randomInt\", function() { return randomInt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"random\", function() { return random; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"join\", function() { return join; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"destroyFile\", function() { return destroyFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"destroy\", function() { return destroy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeTags\", function() { return removeTags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mod\", function() { return mod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"player\", function() { return player; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"server\", function() { return server; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"math\", function() { return math; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"data\", function() { return data; });\n/* harmony import */ var _Files_File__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Files/File */ \"./node_modules/@casual-simulation/aux-common/Files/File.js\");\n/* harmony import */ var _Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Files/FileEvents */ \"./node_modules/@casual-simulation/aux-common/Files/FileEvents.js\");\n/* harmony import */ var _Files_FilesChannel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Files/FilesChannel */ \"./node_modules/@casual-simulation/aux-common/Files/FilesChannel.js\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid/v4 */ \"uuid/v4\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(uuid_v4__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Files/FileCalculations */ \"./node_modules/@casual-simulation/aux-common/Files/FileCalculations.js\");\n/* harmony import */ var _polyfill_Array_first_polyfill__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../polyfill/Array.first.polyfill */ \"./node_modules/@casual-simulation/aux-common/polyfill/Array.first.polyfill.js\");\n/* harmony import */ var _polyfill_Array_first_polyfill__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_polyfill_Array_first_polyfill__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _polyfill_Array_last_polyfill__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../polyfill/Array.last.polyfill */ \"./node_modules/@casual-simulation/aux-common/polyfill/Array.last.polyfill.js\");\n/* harmony import */ var _polyfill_Array_last_polyfill__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_polyfill_Array_last_polyfill__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./formula-lib-globals */ \"./node_modules/@casual-simulation/aux-common/Formulas/formula-lib-globals.js\");\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n\n\n\n\n\n\n\n\n\n\n/**\n * Sums the given array of numbers and returns the result.\n * If any value in the list is not a number, it will be converted to one.\n * If the given value is not an array, then it will be converted to a number and returned.\n *\n * @param list The value that should be summed. If it is a list, then the result will be the sum of the items in the list.\n *             If it is not a list, then the result will be the value converted to a number.\n */\nfunction sum(list) {\n    if (!Array.isArray(list)) {\n        return parseFloat(list);\n    }\n    let carry = 0;\n    for (let i = 0; i < list.length; i++) {\n        const l = list[i];\n        if (!Array.isArray(l)) {\n            carry += parseFloat(l);\n        }\n        else {\n            carry += sum(l);\n        }\n    }\n    return carry;\n}\n/**\n * Calculates the average of the numbers in the given list and returns the result.\n * @param list The value that should be averaged.\n *             If it is a list, then the result will be sum(list)/list.length.\n *             If it is not a list, then the result will be the value converted to a number.\n */\nfunction avg(list) {\n    if (!Array.isArray(list)) {\n        return parseFloat(list);\n    }\n    let total = sum(list);\n    let count = list.length;\n    return total / count;\n}\n/**\n * Calculates the square root of the given number.\n * @param value The number.\n */\nfunction sqrt(value) {\n    return Math.sqrt(parseFloat(value));\n}\n/**\n * Calculates the absolute value of a number.\n * @param number The number to get the absolute value of.\n */\nfunction abs(number) {\n    return Math.abs(parseFloat(number));\n}\n/**\n * Calculates the standard deviation of the numbers in the given list and returns the result.\n *\n * @param list The value that the standard deviation should be calculated for.\n */\nfunction stdDev(list) {\n    if (!Array.isArray(list)) {\n        list = [parseFloat(list)];\n    }\n    let mean = avg(list);\n    let numbersMinusMean = list.map((l) => (l - mean) * (l - mean));\n    let standardMean = avg(numbersMinusMean);\n    return sqrt(standardMean);\n}\n/**\n * Sorts the given array in ascending order and returns the sorted values in a new array.\n * @param array The array of numbers to sort.\n */\nfunction sort(array, direction = 'ASC') {\n    let newArray = array.slice();\n    let isAscending = direction.toUpperCase() !== 'DESC';\n    if (isAscending) {\n        return newArray.sort((a, b) => a - b);\n    }\n    else {\n        return newArray.sort((a, b) => b - a);\n    }\n}\n/**\n * Generates a random integer number between min and max.\n * @param min The smallest allowed value.\n * @param max The largest allowed value.\n */\nfunction randomInt(min = 0, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    const rand = Math.random();\n    if (max) {\n        return Math.floor(rand * (max - min)) + min;\n    }\n    else {\n        return Math.floor(rand) + min;\n    }\n}\n/**\n * Generates a random number between min and max.\n * @param min The smallest allowed value.\n * @param max The largest allowed value.\n */\nfunction random(min = 0, max) {\n    const rand = Math.random();\n    if (max) {\n        return rand * (max - min) + min;\n    }\n    else {\n        return rand + min;\n    }\n}\n/**\n * Joins the given list of values into a single string.\n * @param values The values to make the string out of.\n * @param separator The separator used to separate values.\n */\nfunction join(values, separator = ',') {\n    if (Array.isArray(values)) {\n        return values.join(separator);\n    }\n    else {\n        return values;\n    }\n}\n/**\n * Removes the given file or file ID from the simulation.\n * @param file The file or file ID to remove from the simulation.\n */\nfunction destroyFile(file) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    let id;\n    if (typeof file === 'object') {\n        id = file.id;\n    }\n    else if (typeof file === 'string') {\n        id = file;\n    }\n    if (typeof id === 'object') {\n        id = id.valueOf();\n    }\n    const realFile = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getFileState\"])()[id];\n    if (!realFile) {\n        return;\n    }\n    if (!Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isDestroyable\"])(calc, realFile)) {\n        return;\n    }\n    if (id) {\n        event(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"DESTROY_ACTION_NAME\"], [id]);\n        let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n        actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileRemoved\"])(id));\n        calc.sandbox.interface.removeFile(id);\n    }\n    destroyChildren(id);\n}\n/**\n * Destroys the given file, file ID, or list of files.\n * @param file The file, file ID, or list of files to destroy.\n */\nfunction destroy(file) {\n    if (typeof file === 'object' && Array.isArray(file)) {\n        file.forEach(f => destroyFile(f));\n    }\n    else {\n        destroyFile(file);\n    }\n}\n/**\n * Destroys the given file section, file ID, or list of files.\n * @param file The file, file ID, or list of files to destroy the tag sections of.\n * @param tagSection The tag section to remove on the file.\n */\nfunction removeTags(file, tagSection) {\n    if (typeof file === 'object' && Array.isArray(file)) {\n        let fileList = file;\n        for (let h = 0; h < file.length; h++) {\n            let tags = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"tagsOnFile\"])(fileList[h]);\n            for (let i = tags.length - 1; i >= 0; i--) {\n                if (tagSection instanceof RegExp) {\n                    if (tagSection.test(tags[i])) {\n                        fileList[h][tags[i]] = null;\n                    }\n                }\n                else if (tags[i].includes(tagSection)) {\n                    let doRemoveTag = false;\n                    if (tags[i].includes('.')) {\n                        if (tags[i].split('.')[0] === tagSection) {\n                            doRemoveTag = true;\n                        }\n                    }\n                    else {\n                        if (tags[i] === tagSection) {\n                            doRemoveTag = true;\n                        }\n                    }\n                    if (doRemoveTag) {\n                        fileList[h][tags[i]] = null;\n                    }\n                }\n            }\n        }\n    }\n    else {\n        let tags = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"tagsOnFile\"])(file);\n        for (let i = tags.length - 1; i >= 0; i--) {\n            // if the tag section is relevant to the curretn tag at all\n            if (tagSection instanceof RegExp) {\n                if (tagSection.test(tags[i])) {\n                    setTag(file, tags[i], null);\n                }\n            }\n            else if (tags[i].includes(tagSection)) {\n                let doRemoveTag = false;\n                // if this tag has a period in it, check for first word to match\n                if (tags[i].includes('.')) {\n                    if (tags[i].split('.')[0] === tagSection) {\n                        doRemoveTag = true;\n                    }\n                }\n                else {\n                    // check if tag is equal to the tag section and that it doesn't just have the tagsection as a part of its\n                    if (tags[i] === tagSection) {\n                        doRemoveTag = true;\n                    }\n                }\n                // if it has been verified that the tag matches the tag section for removal\n                if (doRemoveTag) {\n                    setTag(file, tags[i], null);\n                }\n            }\n        }\n    }\n}\nfunction destroyChildren(id) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    const children = calc.sandbox.interface.listObjectsWithTag('aux.creator', id);\n    children.forEach(child => {\n        if (!Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isDestroyable\"])(calc, child)) {\n            return;\n        }\n        let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n        actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileRemoved\"])(child.id));\n        calc.sandbox.interface.removeFile(child.id);\n        destroyChildren(child.id);\n    });\n}\n/**\n * Creates a new file that contains the given tags.\n * @param diffs The diffs that specify what tags to set on the file.\n */\nfunction create(...diffs) {\n    let variants = new Array(1);\n    variants[0] = [];\n    for (let i = 0; i < diffs.length; i++) {\n        let diff = diffs[i];\n        if (Array.isArray(diff)) {\n            let newVariants = new Array(variants.length * diff.length);\n            for (let b = 0; b < newVariants.length; b++) {\n                let diffIdx = Math.floor(b / variants.length);\n                let d = diff[diffIdx];\n                let variantIdx = b % variants.length;\n                let newVariant = variants[variantIdx].slice();\n                newVariant.push(d);\n                newVariants[b] = newVariant;\n            }\n            variants = newVariants;\n        }\n        else {\n            for (let b = 0; b < variants.length; b++) {\n                variants[b].push(diff);\n            }\n        }\n    }\n    let files = variants.map(v => {\n        let file = {\n            id: uuid_v4__WEBPACK_IMPORTED_MODULE_3___default()(),\n            tags: {},\n        };\n        applyDiff(file.tags, ...v);\n        return file;\n    });\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(...files.map(f => Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"fileAdded\"])(f)));\n    let ret = new Array(files.length);\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    for (let i = 0; i < files.length; i++) {\n        ret[i] = calc.sandbox.interface.addFile(files[i]);\n        Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"setFileState\"])(Object.assign({}, Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getFileState\"])(), {\n            [files[i].id]: files[i],\n        }));\n    }\n    event(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"CREATE_ACTION_NAME\"], files);\n    if (ret.length === 1) {\n        return ret[0];\n    }\n    else {\n        return ret;\n    }\n}\n/**\n * Gets the file ID from the given file.\n * @param file The file or string.\n */\nfunction getFileId(file) {\n    if (typeof file === 'string') {\n        return file;\n    }\n    else if (file) {\n        return file.id;\n    }\n}\n/**\n * Creates a new file that is a child of the given file.\n * @param parent The file that should be the parent of the new file.\n * @param data The object that specifies the new file's tag values.\n */\nfunction createFrom(parent, ...datas) {\n    let parentId = getFileId(parent);\n    let parentDiff = parentId\n        ? {\n            'aux.creator': parentId,\n        }\n        : {};\n    return create(...datas, parentDiff);\n}\n/**\n * Combines the two given files.\n * @param first The first file.\n * @param second The second file.\n */\nfunction combine(first, second) {\n    event(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"COMBINE_ACTION_NAME\"], [first, second]);\n}\n/**\n * Runs an event on the given files.\n * @param name The name of the event to run.\n * @param files The files that the event should be executed on. If null, then the event will be run on every file.\n * @param arg The argument to pass.\n * @param sort Whether to sort the Files before processing. Defaults to true.\n */\nfunction event(name, files, arg, sort) {\n    const state = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getFileState\"])();\n    if (!!state) {\n        let ids = !!files\n            ? files.map(file => {\n                return typeof file === 'string' ? file : file.id;\n            })\n            : null;\n        let [events, results] = Object(_Files_FilesChannel__WEBPACK_IMPORTED_MODULE_2__[\"calculateActionResultsUsingContext\"])(state, Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"action\"])(name, ids, Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getUserId\"])(), arg, sort), Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])());\n        let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n        actions.push(...events);\n        return results;\n    }\n}\n/**\n * Shouts the given event to every file.\n * @param name The event name.\n */\nfunction shout(name, arg) {\n    return event(name, null, arg);\n}\n/**\n * Shouts the given event to every file in every loaded simulation.\n * @param eventName The name of the event to shout.\n * @param arg The argument to shout. This gets passed as the `that` variable to the other scripts.\n */\nfunction superShout(eventName, arg) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"superShout\"])(eventName, arg));\n}\n/**\n * Sends the given event to the given file.\n * @param file The file to send the event to.\n * @param eventName The name of the event to send.\n * @param arg The argument to pass.\n */\nfunction whisper(file, eventName, arg) {\n    let files;\n    if (Array.isArray(file)) {\n        files = file;\n    }\n    else {\n        files = [file];\n    }\n    return event(eventName, files, arg, false);\n}\n/**\n * Redirects the user to the given context.\n * @param context The context to go to.\n */\nfunction goToContext(context) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"goToContext\"])(context));\n}\n/**\n * Redirects the user to the given URL.\n * @param url The URL to go to.\n */\nfunction goToURL(url) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"goToURL\"])(url));\n}\n/**\n * Redirects the user to the given URL.\n * @param url The URL to go to.\n */\nfunction openURL(url) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openURL\"])(url));\n}\nfunction showInputForTag(file, tag, options) {\n    const id = typeof file === 'string' ? file : file.id;\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"showInputForTag\"])(id, Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tag), options));\n}\n/**\n * Determines whether the current player is allowed to load AUX Builder.\n */\nfunction isBuilder() {\n    const globals = getGlobals();\n    const user = getUser();\n    if (globals && user) {\n        const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n        const list = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"getFileUsernameList\"])(calc, globals, 'aux.designers');\n        if (list) {\n            return Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isInUsernameList\"])(calc, globals, 'aux.designers', getTag(user, 'aux._user'));\n        }\n    }\n    return true;\n}\n/**\n * Derermines whether the player is in the given context.\n * @param context The context.\n */\nfunction isInContext(givenContext) {\n    return currentContext() === givenContext;\n}\n/**\n * Gets the context that the player is currently in.\n */\nfunction currentContext() {\n    const user = getUser();\n    if (user) {\n        const context = getTag(user, 'aux._userContext');\n        return context || undefined;\n    }\n    return undefined;\n}\n/**\n * Determines whether the player has the given file in their inventory.\n * @param files The file or files to check.\n */\nfunction hasFileInInventory(files) {\n    if (!Array.isArray(files)) {\n        files = [files];\n    }\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"every\"])(files, f => Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFileInContext\"])(Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])(), f, getUserInventoryContext()));\n}\n/**\n * Gets the current user's file.\n */\nfunction getUser() {\n    if (!Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getUserId\"])()) {\n        return null;\n    }\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    const user = calc.sandbox.interface.listObjectsWithTag('id', Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getUserId\"])());\n    if (Array.isArray(user)) {\n        if (user.length === 1) {\n            return user[0];\n        }\n        else {\n            return null;\n        }\n    }\n    return user || null;\n}\n/**\n * Gets the current globals file.\n */\nfunction getGlobals() {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    const globals = calc.sandbox.interface.listObjectsWithTag('id', _Files_File__WEBPACK_IMPORTED_MODULE_0__[\"GLOBALS_FILE_ID\"]);\n    if (Array.isArray(globals)) {\n        if (globals.length === 1) {\n            return globals[0];\n        }\n        else {\n            return null;\n        }\n    }\n    return globals || null;\n}\n/**\n * Gets the name of the context that is used for the current user's menu.\n */\nfunction getUserMenuContext() {\n    const user = getUser();\n    if (user) {\n        return getTag(user, 'aux._userMenuContext');\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Gets the name of the context that is used for the current user's inventory.\n */\nfunction getUserInventoryContext() {\n    const user = getUser();\n    if (user) {\n        return getTag(user, 'aux._userInventoryContext');\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Gets the first bot that has the given tag which matches the given filter value.\n * @param tag The tag.\n * @param filter The optional filter.\n */\nfunction getBot(tag, filter) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return calc.sandbox.interface\n        .listObjectsWithTag(Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tag), filter)\n        .first();\n}\n/**\n * Gets the list of bots that have the given tag matching the given filter value.\n * @param tag The tag.\n * @param filter The optional filter.\n */\nfunction getBots(tag, filter) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return calc.sandbox.interface.listObjectsWithTag(Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tag), filter);\n}\n/**\n * Gets the list of tag values from bots that have the given tag.\n * @param tag The tag.\n * @param filter THe optional filter to use for the values.\n */\nfunction getBotTagValues(tag, filter) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return calc.sandbox.interface.listTagValues(Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tag), filter);\n}\n/**\n * Gets the value of the given tag stored in the given file.\n * @param file The file.\n * @param tag The tag.\n */\nfunction getTag(file, ...tags) {\n    let current = file;\n    for (let i = 0; i < tags.length; i++) {\n        if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(current)) {\n            const tag = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tags[i]);\n            const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n            if (calc) {\n                current = calc.sandbox.interface.getTag(current, tag);\n            }\n            else {\n                current = file.tags[tag];\n            }\n        }\n        else {\n            return current;\n        }\n    }\n    return current;\n}\n/**\n * Gets weather the current tag exists on the given file.\n * @param file The file.\n * @param tag The tag to check.\n */\nfunction hasTag(file, ...tags) {\n    let current = file;\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    for (let i = 0; i < tags.length; i++) {\n        if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(current)) {\n            const tag = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tags[i]);\n            if (calc) {\n                current = calc.sandbox.interface.getTag(current, tag);\n            }\n            else {\n                current = file.tags[tag];\n            }\n        }\n        else {\n            if (current != null && current != undefined && current != '') {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    }\n    if (current != null && current != undefined && current != '') {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n/**\n * Sets the value of the given tag stored in the given file.\n * @param file The file.\n * @param tag The tag to set.\n * @param value The value to set.\n */\nfunction setTag(file, tag, value) {\n    tag = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"trimTag\"])(tag);\n    if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(file)) {\n        const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n        return calc.sandbox.interface.setTag(file, tag, value);\n    }\n    else {\n        file[tag] = value;\n        return value;\n    }\n}\n/**\n * Gets the list of files that are in the given context.\n * @param context The context.\n */\nfunction getBotsInContext(context) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    const result = calc.sandbox.interface.listObjectsWithTag(context, true);\n    if (Array.isArray(result)) {\n        return result;\n    }\n    else {\n        return [result];\n    }\n}\n/**\n * Gets the list of files that are at the same position in the given context as the given file.\n * @param file A file in the stack of files.\n * @param context The context that the stack of files exists in.\n */\nfunction getBotsInStack(file, context) {\n    return getFilesAtPosition(context, getTag(file, `${context}.x`), getTag(file, `${context}.y`));\n}\n/**\n * Gets the stack of files in the given context at the given position.\n * @param context The context that the files are in.\n * @param x The X position of the stack.\n * @param y The Y position of the stack.\n */\nfunction getFilesAtPosition(context, x, y) {\n    const result = getBotsInContext(context);\n    const filtered = result.filter(f => {\n        return (getTag(f, `${context}.x`) === x && getTag(f, `${context}.y`) === y);\n    });\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"sortBy\"])(filtered, f => getTag(f, `${context}.index`) || 0);\n}\nfunction getNeighboringBots(file, context, position) {\n    if (!position) {\n        return {\n            front: getNeighboringBots(file, context, 'front'),\n            back: getNeighboringBots(file, context, 'back'),\n            left: getNeighboringBots(file, context, 'left'),\n            right: getNeighboringBots(file, context, 'right'),\n        };\n    }\n    const offsetX = position === 'left' ? 1 : position === 'right' ? -1 : 0;\n    const offsetY = position === 'back' ? 1 : position === 'front' ? -1 : 0;\n    const x = getTag(file, `${context}.x`);\n    const y = getTag(file, `${context}.y`);\n    return getFilesAtPosition(context, x + offsetX, y + offsetY);\n}\nfunction loadDiff(file, ...tags) {\n    if (typeof file === 'string') {\n        file = JSON.parse(file);\n    }\n    let diff = {};\n    let tagsObj = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(file) ? file.tags : file;\n    let fileTags = Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(file) ? Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"tagsOnFile\"])(file) : Object.keys(file);\n    for (let fileTag of fileTags) {\n        let add = false;\n        if (tags.length > 0) {\n            for (let tag of tags) {\n                if (tag instanceof RegExp) {\n                    if (tag.test(fileTag)) {\n                        add = true;\n                        break;\n                    }\n                }\n                else {\n                    if (tag === fileTag) {\n                        add = true;\n                        break;\n                    }\n                }\n            }\n        }\n        else {\n            add = true;\n        }\n        if (add) {\n            diff[fileTag] = tagsObj[fileTag];\n        }\n    }\n    return diff;\n}\n/**\n * Saves the given diff to a string of JSON.\n * @param file The diff to save.\n */\nfunction saveDiff(file) {\n    if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(file)) {\n        return JSON.stringify(file.tags);\n    }\n    else {\n        return JSON.stringify(file);\n    }\n}\n/**\n * Applies the given diff to the given file.\n * @param file The file.\n * @param diff The diff to apply.\n */\nfunction applyDiff(file, ...diffs) {\n    let appliedDiffs = [];\n    diffs.forEach(diff => {\n        if (!diff) {\n            return;\n        }\n        let tags;\n        if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(diff)) {\n            tags = diff.tags;\n        }\n        else {\n            tags = diff;\n        }\n        appliedDiffs.push(tags);\n        for (let key in tags) {\n            setTag(file, key, tags[key]);\n        }\n    });\n    if (Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"isFile\"])(file)) {\n        event(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"DIFF_ACTION_NAME\"], [file], {\n            diffs: appliedDiffs,\n        });\n    }\n}\n/**\n * Gets a diff that adds a file to the given context.\n * @param context The context.\n * @param x The X position that the file should be added at.\n * @param y The Y position that the file should be added at.\n * @param index The index that the file should be added at.\n */\nfunction addToContextDiff(context, x = 0, y = 0, index) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"addToContextDiff\"])(calc, context, x, y, index);\n}\n/**\n * Gets a diff that removes a file from the given context.\n * @param context The context.\n */\nfunction removeFromContextDiff(context) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"removeFromContextDiff\"])(calc, context);\n}\n/**\n * Gets a diff that sets the position of a file in the given context when applied.\n * @param context The context.\n * @param x The X position.\n * @param y The Y position.\n * @param index The index.\n */\nfunction setPositionDiff(context, x, y, index) {\n    const calc = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getCalculationContext\"])();\n    return Object(_Files_FileCalculations__WEBPACK_IMPORTED_MODULE_5__[\"setPositionDiff\"])(calc, context, x, y, index);\n}\n/**\n * Gets a diff that adds a file to the current user's menu.\n */\nfunction addToMenuDiff() {\n    const context = getUserMenuContext();\n    return Object.assign({}, addToContextDiff(context), { [`${context}.id`]: uuid_v4__WEBPACK_IMPORTED_MODULE_3___default()() });\n}\n/**\n * Gets a diff that removes a file from the current user's menu.\n */\nfunction removeFromMenuDiff() {\n    const context = getUserMenuContext();\n    return Object.assign({}, removeFromContextDiff(context), { [`${context}.id`]: null });\n}\n/**\n * Shows a toast message to the user.\n * @param message The message to show.\n */\nfunction toast(message) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"toast\"])(message));\n}\n/**\n * Tweens the user's camera to view the given file.\n * @param file The file to view.\n * @param zoomValue The zoom value to use.\n */\nfunction tweenTo(file, zoomValue, rotX, rotY) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"tweenTo\"])(getFileId(file), zoomValue, rotX, rotY));\n}\n/**\n * Opens the QR Code Scanner.\n */\nfunction openQRCodeScanner() {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openQRCodeScanner\"])(true));\n}\n/**\n * Closes the QR Code Scanner.\n */\nfunction closeQRCodeScanner() {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openQRCodeScanner\"])(false));\n}\n/**\n * Shows the given QR Code.\n * @param code The code to show.\n */\nfunction showQRCode(code) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"showQRCode\"])(true, code));\n}\n/**\n * Hides the QR Code.\n */\nfunction hideQRCode() {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"showQRCode\"])(false));\n}\n/**\n * Loads the channel with the given ID.\n * @param id The ID of the channel to load.\n */\nfunction loadChannel(id) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"loadSimulation\"])(id));\n}\n/**\n * Unloads the channel with the given ID.\n * @param id The ID of the channel to unload.\n */\nfunction unloadChannel(id) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"unloadSimulation\"])(id));\n}\n/**\n * Imports the AUX at the given URL.\n * @param url The URL to load.\n */\nfunction importAUX(url) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"importAUX\"])(url));\n}\n/**\n * Sends a \"hello\" event to the server.\n */\nfunction sayHello() {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__[\"remote\"])(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"sayHello\"])()));\n}\n/**\n * Sends an echo event to the server.\n */\nfunction echo(message) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__[\"remote\"])(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"echo\"])(message)));\n}\nfunction grantRole(username, role) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__[\"remote\"])(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"grantRole\"])(username, role)));\n}\nfunction revokeRole(username, role) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__[\"remote\"])(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"revokeRole\"])(username, role)));\n}\nfunction shell(script) {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_9__[\"remote\"])(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"shell\"])(script)));\n}\nfunction openDevConsole() {\n    let actions = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getActions\"])();\n    actions.push(Object(_Files_FileEvents__WEBPACK_IMPORTED_MODULE_1__[\"openConsole\"])());\n}\n/**\n * Determines if the user is currently connected to the server.\n */\nfunction isConnected() {\n    const user = getUser();\n    if (user) {\n        const val = getTag(user, 'aux.connected');\n        if (val) {\n            return val.valueOf() || false;\n        }\n    }\n    return false;\n}\nfunction __energyCheck() {\n    let current = Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"getEnergy\"])();\n    current -= 1;\n    Object(_formula_lib_globals__WEBPACK_IMPORTED_MODULE_8__[\"setEnergy\"])(current);\n    if (current <= 0) {\n        throw new Error('Ran out of energy');\n    }\n}\n/**\n * Defines a set of functions that are able to make File Diffs.\n */\nconst mod = {\n    addToContext: addToContextDiff,\n    removeFromContext: removeFromContextDiff,\n    addToMenu: addToMenuDiff,\n    removeFromMenu: removeFromMenuDiff,\n    setPosition: setPositionDiff,\n    import: loadDiff,\n    export: saveDiff,\n    apply: applyDiff,\n};\n/**\n * Defines a set of functions that relate to common player operations.\n */\nconst player = {\n    isInContext,\n    goToContext,\n    goToURL,\n    openURL,\n    getBot: getUser,\n    getMenuContext: getUserMenuContext,\n    getInventoryContext: getUserInventoryContext,\n    toast,\n    tweenTo,\n    openQRCodeScanner,\n    closeQRCodeScanner,\n    loadChannel,\n    unloadChannel,\n    importAUX,\n    hasFileInInventory,\n    showQRCode,\n    hideQRCode,\n    isConnected,\n    currentContext,\n    isDesigner: isBuilder,\n    showInputForTag,\n    openDevConsole,\n};\nconst server = {\n    sayHello,\n    grantRole,\n    revokeRole,\n    shell,\n    echo,\n};\n/**\n * Defines a set of functions that relate to common math operations.\n */\nconst math = {\n    sum,\n    avg,\n    sqrt,\n    abs,\n    stdDev,\n    randomInt,\n    random,\n};\n/**\n * Defines a set of functions that relate to common data operations.\n */\nconst data = {\n    sort,\n    join,\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    // Namespaces\n    data,\n    mod,\n    math,\n    player,\n    server,\n    // Global functions\n    combine,\n    create: createFrom,\n    destroy,\n    event,\n    getBotsInContext,\n    getBotsInStack,\n    getNeighboringBots,\n    shout,\n    superShout,\n    whisper,\n    getBot,\n    getBots,\n    getBotTagValues,\n    getTag,\n    hasTag,\n    setTag,\n    removeTags,\n    // Engine functions\n    __energyCheck,\n});\n//# sourceMappingURL=formula-lib.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/formula-lib.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/Formulas/index.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/Formulas/index.js ***!
  \**********************************************************************/
/*! exports provided: EvalSandbox, anyArgument, Transpiler, Dependencies */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _EvalSandbox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EvalSandbox */ \"./node_modules/@casual-simulation/aux-common/Formulas/EvalSandbox.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"EvalSandbox\", function() { return _EvalSandbox__WEBPACK_IMPORTED_MODULE_0__[\"EvalSandbox\"]; });\n\n/* harmony import */ var _Transpiler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Transpiler */ \"./node_modules/@casual-simulation/aux-common/Formulas/Transpiler.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"anyArgument\", function() { return _Transpiler__WEBPACK_IMPORTED_MODULE_1__[\"anyArgument\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Transpiler\", function() { return _Transpiler__WEBPACK_IMPORTED_MODULE_1__[\"Transpiler\"]; });\n\n/* harmony import */ var _Dependencies__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Dependencies */ \"./node_modules/@casual-simulation/aux-common/Formulas/Dependencies.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Dependencies\", function() { return _Dependencies__WEBPACK_IMPORTED_MODULE_2__[\"Dependencies\"]; });\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/Formulas/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js ***!
  \***************************************************************************/
/*! exports provided: root, file, tag, value, insert, del, op */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"root\", function() { return root; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"file\", function() { return file; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tag\", function() { return tag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"value\", function() { return value; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"insert\", function() { return insert; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"del\", function() { return del; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"op\", function() { return op; });\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n\n\n/**\n * Creates a root atom op.\n */\nfunction root() {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].root, {});\n}\n/**\n * Creates a file atom op.\n */\nfunction file(id) {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].file, {\n        id,\n    });\n}\n/**\n * Creates a tag atom op.\n */\nfunction tag(name) {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].tag, {\n        name,\n    });\n}\n/**\n * Creates a value op.\n * @param value The initial value for the tag.\n */\nfunction value(value) {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].value, {\n        value,\n    });\n}\n/**\n * Creates an insert op.\n * @param index The index to insert the text at.\n * @param text The text to insert.\n */\nfunction insert(index, text) {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].insert, {\n        index,\n        text,\n    });\n}\n/**\n * Creates a delete op.\n * @param index The index to insert the text at.\n */\nfunction del(start, end) {\n    return op(_AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].delete, {\n        start,\n        end,\n    });\n}\nfunction op(type, extra) {\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"assign\"])({\n        type: type,\n        unix: Date.now(),\n    }, extra);\n}\n//# sourceMappingURL=AuxAtoms.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTree.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTree.js ***!
  \********************************************************************************/
/*! exports provided: AuxCausalTree, getFilesStateFromStoredTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxCausalTree\", function() { return AuxCausalTree; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFilesStateFromStoredTree\", function() { return getFilesStateFromStoredTree; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n/* harmony import */ var _Files__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Files */ \"./node_modules/@casual-simulation/aux-common/Files/index.js\");\n/* harmony import */ var _AuxReducer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuxReducer */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js\");\n/* harmony import */ var _AuxAtoms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuxAtoms */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js\");\n/* harmony import */ var _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AuxTreeCalculations */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\n\n\n/**\n * Defines a Causal Tree for aux files.\n */\nclass AuxCausalTree extends _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"CausalTree\"] {\n    /**\n     * Creates a new AUX Causal Tree.\n     * @param tree The stored tree that this object should be constructed from.\n     * @param options The options to use.\n     */\n    constructor(tree, options) {\n        super(tree, new _AuxReducer__WEBPACK_IMPORTED_MODULE_3__[\"AuxReducer\"](), options);\n    }\n    /**\n     * Creates a new root atom and adds it to the tree.\n     */\n    root() {\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"root\"])(), null);\n    }\n    /**\n     * Creates a new file atom and adds it to the tree.\n     * @param id The ID of the file.\n     */\n    file(id) {\n        if (this.weave.atoms.length === 0) {\n            throw new Error('Cannot add a file atom without a root atom.');\n        }\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"file\"])(id), this.weave.atoms[0]);\n    }\n    /**\n     * Creates a new tag for a file and adds it to the tree.\n     * @param name The initial name for the tag.\n     * @param fileAtom The atom that this tag should be attached to.\n     */\n    tag(name, fileAtom) {\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"tag\"])(name), fileAtom);\n    }\n    /**\n     * Creates a new value for a tag and adds it to the tree.\n     * @param val The initial value for the tag.\n     * @param tagAtom The atom that this value should be attached to.\n     */\n    val(val, tagAtom) {\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"value\"])(val), tagAtom, 1);\n    }\n    /**\n     * Creates a new delete operation for the given file, insertion, or value and adds it to the tree.\n     * @param atom The parent atom that should be (partially) deleted.\n     * @param start The start index of the deletion. If not provided then the entire parent will be deleted.\n     * @param end The end index of the deletion.\n     */\n    delete(atom, start, end) {\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"del\"])(start, end), atom, 1);\n    }\n    /**\n     * Creates a new insert operation for the given value or insertion and adds it to the tree.\n     * @param index The index of the parent that this text should be inserted at.\n     * @param text The text to insert.\n     * @param atom The atom that the text should be inserted at.\n     */\n    insert(index, text, atom) {\n        return this.create(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_4__[\"insert\"])(index, text), atom);\n    }\n    /**\n     * Inserts the given text into the given tag or value on the given file.\n     * @param file The file that the text should be inserted into.\n     * @param tag The tag that the text should be inserted into.\n     * @param text The text that should be inserted.\n     * @param index The index that the text should be inserted at.\n     */\n    insertIntoTagValue(file, tag, text, index) {\n        const precalc = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"insertIntoTagValue\"])(file, tag, text, index);\n        return this.createFromPrecalculated(precalc);\n    }\n    /**\n     * Inserts the given text into the given tag name.\n     * Note that after inserting the text the tag name will change.\n     * @param tag The tag whose name should be updated.\n     * @param text The text to insert into the tag name.\n     * @param index The index that the text should be inserted at.\n     */\n    insertIntoTagName(file, tag, text, index) {\n        const precalc = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"insertIntoTagName\"])(file, tag, text, index);\n        return this.createFromPrecalculated(precalc);\n    }\n    /**\n     * Deletes a segment of text from the given tag's value.\n     * @param file The file that the text should be deleted from.\n     * @param tag The tag that the text should be deleted from.\n     * @param index The index that the text should be deleted at.\n     * @param length The number of characters to delete.\n     */\n    deleteFromTagValue(file, tag, index, length) {\n        const precalc = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"deleteFromTagValue\"])(file, tag, index, length);\n        return this.createManyFromPrecalculated(precalc);\n    }\n    /**\n     * Deletes a segment of text from the given tag's name.\n     * Note that after inserting the text the tag name will change.\n     * @param tag The tag whose name should be updated.\n     * @param index The index that the characters should be deleted from.\n     * @param length The number of characters to delete.\n     */\n    deleteFromTagName(file, tag, index, length) {\n        const precalc = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"deleteFromTagName\"])(file, tag, index, length);\n        return this.createManyFromPrecalculated(precalc);\n    }\n    /**\n     * Adds the given events to the tree.\n     * @param events The events to add to the tree.\n     * @param value The optional precalculated value to use for resolving tree references.\n     */\n    addEvents(events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.batch(() => __awaiter(this, void 0, void 0, function* () {\n                let added = [];\n                let rejected = [];\n                let archived = [];\n                for (let i = 0; i < events.length; i++) {\n                    let e = events[i];\n                    let batch;\n                    if (e.type === 'file_updated') {\n                        const file = this.value[e.id];\n                        batch = yield this.updateFile(file, e.update);\n                    }\n                    else if (e.type === 'file_added') {\n                        batch = yield this.addFile(e.file);\n                    }\n                    else if (e.type === 'file_removed') {\n                        const file = this.value[e.id];\n                        batch = yield this.removeFile(file);\n                    }\n                    else if (e.type === 'transaction') {\n                        batch = yield this.addEvents(e.events);\n                    }\n                    else if (e.type === 'apply_state') {\n                        batch = yield this.applyState(e.state, this.value);\n                    }\n                    if (batch) {\n                        added.push(...batch.added);\n                        rejected.push(...batch.rejected);\n                        archived.push(...batch.archived);\n                    }\n                }\n                return {\n                    added,\n                    rejected,\n                    archived,\n                };\n            }));\n        });\n    }\n    /**\n     * Removes the given file from the state by marking it as deleted.\n     * @param file The file to remove.\n     */\n    removeFile(file) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!file) {\n                return {\n                    added: [],\n                    rejected: [],\n                    archived: [],\n                };\n            }\n            const result = yield this.delete(file.metadata.ref);\n            if (result.added) {\n                return {\n                    added: [result.added],\n                    rejected: [],\n                    archived: [],\n                };\n            }\n            else {\n                return {\n                    added: [],\n                    rejected: [result.rejected],\n                    archived: [],\n                };\n            }\n        });\n    }\n    /**\n     * Adds the given file to the tree.\n     * @param file The file to add to the tree.\n     */\n    addFile(file) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.batch(() => __awaiter(this, void 0, void 0, function* () {\n                const f = yield this.file(file.id);\n                if (f.rejected) {\n                    return {\n                        added: [],\n                        rejected: [f.rejected],\n                        archived: [],\n                    };\n                }\n                let tags = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"tagsOnFile\"])(file);\n                let promises = tags.map((t) => __awaiter(this, void 0, void 0, function* () {\n                    const tag = yield this.tag(t, f.added);\n                    if (tag.rejected) {\n                        return [tag];\n                    }\n                    const val = yield this.val(file.tags[t], tag.added);\n                    return [tag, val];\n                }));\n                const results = yield Promise.all(promises);\n                const refs = Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"flatMap\"])(results);\n                return Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"mergeIntoBatch\"])([f, ...refs]);\n            }));\n        });\n    }\n    /**\n     * Updates the given file.\n     * @param file The file to update.\n     * @param newData The new data to include in the file.\n     */\n    updateFile(file, newData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!file) {\n                return { added: [], rejected: [], archived: [] };\n            }\n            return yield this.batch(() => __awaiter(this, void 0, void 0, function* () {\n                let tags = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"tagsOnFile\"])(newData);\n                let promises = tags.map((t) => __awaiter(this, void 0, void 0, function* () {\n                    const tagMeta = file.metadata.tags[t];\n                    let newVal = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"getTag\"])(newData, t);\n                    if (tagMeta) {\n                        const oldVal = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileTag\"])(file, t);\n                        if (newVal &&\n                            oldVal &&\n                            typeof newVal === 'object' &&\n                            typeof oldVal === 'object' &&\n                            !Array.isArray(newVal) &&\n                            !Array.isArray(oldVal)) {\n                            newVal = Object(_utils__WEBPACK_IMPORTED_MODULE_7__[\"merge\"])(oldVal, newVal);\n                        }\n                        const hasOld = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"hasValue\"])(oldVal);\n                        const hasNew = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"hasValue\"])(newVal);\n                        if (!Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"isEqual\"])(oldVal, newVal) && (hasOld || hasNew)) {\n                            // tag is on the file\n                            const val = yield this.val(newVal, tagMeta.ref);\n                            return [val];\n                        }\n                        else {\n                            return [];\n                        }\n                    }\n                    else {\n                        const tag = yield this.tag(t, file.metadata.ref);\n                        if (tag.rejected) {\n                            return [tag];\n                        }\n                        const val = yield this.val(newVal, tag.added);\n                        return [tag, val];\n                    }\n                }));\n                let results = yield Promise.all(promises);\n                let refs = Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"flatMap\"])(results);\n                let added = refs.map(r => r.added).filter(a => a);\n                let rejected = refs.map(r => r.rejected).filter(a => a);\n                return {\n                    added,\n                    rejected,\n                    archived: [],\n                };\n            }));\n        });\n    }\n    /**\n     * Applies the given state to the tree.\n     * This is like running a batch update file operation.\n     * @param state The state to add/update in the tree.\n     * @param value The optional precalculated value to use for resolving tree references.\n     */\n    applyState(state, value) {\n        return __awaiter(this, void 0, void 0, function* () {\n            value = value || this.value;\n            const files = Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"keys\"])(state);\n            const promises = files.map(id => {\n                const existing = value[id];\n                const newFile = state[id];\n                if (existing) {\n                    return this.updateFile(existing, newFile);\n                }\n                else {\n                    return this.addFile(newFile);\n                }\n            });\n            const results = yield Promise.all(promises);\n            let added = Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"flatMap\"])(results, r => r.added);\n            let rejected = Object(lodash__WEBPACK_IMPORTED_MODULE_6__[\"flatMap\"])(results, r => r.rejected);\n            return {\n                added,\n                rejected,\n                archived: [],\n            };\n        });\n    }\n    fork() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = this.export();\n            const tree = new AuxCausalTree(stored, this._options);\n            yield tree.import(stored);\n            return tree;\n        });\n    }\n    collectGarbage(refs) {\n        let removed = [];\n        for (let i = 0; i < refs.length; i++) {\n            const atom = refs[i];\n            let newlyRemoved = [];\n            if (atom.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].value) {\n                newlyRemoved = this.weave.removeBefore(atom);\n                checkRemovedAtoms(atom, newlyRemoved, _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].value);\n            }\n            else if (atom.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].delete) {\n                if (typeof atom.value.start === 'undefined') {\n                    newlyRemoved = this.weave.removeBefore(atom);\n                    checkRemovedAtoms(atom, newlyRemoved, _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].tag);\n                }\n            }\n            removed.push(...newlyRemoved);\n        }\n        return removed;\n    }\n}\nfunction checkRemovedAtoms(atom, newlyRemoved, type) {\n    for (let j = 0; j < newlyRemoved.length; j++) {\n        const r = newlyRemoved[j];\n        if (r.value.type < type) {\n            console.error(`[AuxCausalTree] Removed atom of type: ${r.value.type} (${Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(r.id)}) incorrectly.`);\n            console.error(`[AuxCausalTree] This happened while removing ${Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(atom.id)}`);\n            debugger;\n        }\n    }\n}\n/**\n * Gets the file state from the given stored causal tree.\n * @param stored The stored tree to load.\n */\nfunction getFilesStateFromStoredTree(stored) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let value;\n        if (stored.site && stored.knownSites && stored.weave) {\n            console.log('[AppManager] Importing Weave.');\n            // Don't try to import the tree because it's like trying to\n            // import an unrelated Git repo. Git handles this by allowing\n            // multiple root nodes but we dont allow multiple roots.\n            const tree = new AuxCausalTree(stored);\n            yield tree.import(stored);\n            value = tree.value;\n        }\n        else {\n            console.log('[AppManager] Old file detected, adding state.');\n            value = stored;\n        }\n        return value;\n    });\n}\n//# sourceMappingURL=AuxCausalTree.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTree.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTreeFactory.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTreeFactory.js ***!
  \***************************************************************************************/
/*! exports provided: auxCausalTreeFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"auxCausalTreeFactory\", function() { return auxCausalTreeFactory; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _AuxCausalTree__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxCausalTree */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTree.js\");\n\n\n/**\n * Creates a new Causal Tree Factory that can create all the tree types required for AUX applications.\n */\nfunction auxCausalTreeFactory() {\n    return new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"CausalTreeFactory\"]({\n        aux: (tree, options) => new _AuxCausalTree__WEBPACK_IMPORTED_MODULE_1__[\"AuxCausalTree\"](tree, options),\n    });\n}\n//# sourceMappingURL=AuxCausalTreeFactory.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTreeFactory.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js ***!
  \*****************************************************************************/
/*! exports provided: AuxOpType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxOpType\", function() { return AuxOpType; });\n/**\n * The list of operation types.\n */\nvar AuxOpType;\n(function (AuxOpType) {\n    AuxOpType[AuxOpType[\"root\"] = 0] = \"root\";\n    AuxOpType[AuxOpType[\"file\"] = 1] = \"file\";\n    AuxOpType[AuxOpType[\"tag\"] = 2] = \"tag\";\n    AuxOpType[AuxOpType[\"value\"] = 3] = \"value\";\n    AuxOpType[AuxOpType[\"delete\"] = 4] = \"delete\";\n    AuxOpType[AuxOpType[\"insert\"] = 5] = \"insert\";\n})(AuxOpType || (AuxOpType = {}));\n//# sourceMappingURL=AuxOpTypes.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxRealtimeTreeCalculations.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxRealtimeTreeCalculations.js ***!
  \**********************************************************************************************/
/*! exports provided: fileChangeObservables */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fileChangeObservables\", function() { return fileChangeObservables; });\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Files__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Files */ \"./node_modules/@casual-simulation/aux-common/Files/index.js\");\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n/* harmony import */ var _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuxTreeCalculations */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js\");\n\n\n\n\n\n/**\n * Builds the fileAdded, fileRemoved, and fileUpdated observables from the given channel connection.\n * @param connection The channel connection.\n */\nfunction fileChangeObservables(tree) {\n    const stateDiffs = tree.onUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"startWith\"])(tree.tree.weave.atoms), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(events => {\n        let addedIds = {};\n        let addedFiles = [];\n        let updatedFiles = new Map();\n        let deletedFiles = [];\n        events.forEach((e) => {\n            if (e.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_3__[\"AuxOpType\"].file) {\n                const id = e.value.id;\n                const val = tree.tree.value[id];\n                const existing = addedIds[id];\n                if (!existing && val) {\n                    addedFiles.push(val);\n                    addedIds[id] = true;\n                }\n                return;\n            }\n            else if (e.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_3__[\"AuxOpType\"].delete) {\n                let cause = tree.tree.weave.getAtom(e.cause);\n                if (cause.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_3__[\"AuxOpType\"].file) {\n                    const id = cause.value.id;\n                    deletedFiles.push(id);\n                    return;\n                }\n            }\n            // Some update happened\n            const file = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_4__[\"getAtomFile\"])(tree.tree.weave, e);\n            if (file) {\n                const id = file.value.id;\n                const val = tree.tree.value[id];\n                const tag = Object(_AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_4__[\"getAtomTag\"])(tree.tree.weave, e);\n                if (tag) {\n                    const update = updatedFiles.get(id);\n                    if (update) {\n                        if (update.tags.indexOf(tag.value.name) < 0) {\n                            update.tags.push(tag.value.name);\n                        }\n                    }\n                    else {\n                        updatedFiles.set(id, {\n                            file: val,\n                            tags: [tag.value.name],\n                        });\n                    }\n                }\n            }\n        });\n        let diff = {\n            addedFiles: addedFiles,\n            removedFiles: deletedFiles,\n            updatedFiles: [...updatedFiles.values()],\n        };\n        return diff;\n    }), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"share\"])());\n    const filesAdded = stateDiffs.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(diff => {\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"sortBy\"])(diff.addedFiles, f => {\n            let tags = Object(_Files__WEBPACK_IMPORTED_MODULE_2__[\"tagsOnFile\"])(f);\n            return tags.length > 0 &&\n                tags.some(t => t === 'aux.context')\n                ? 0\n                : 1;\n        }, f => f.id);\n    }));\n    const filesRemoved = stateDiffs.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(diff => diff.removedFiles));\n    const filesUpdated = stateDiffs.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(diff => diff.updatedFiles));\n    return {\n        filesAdded,\n        filesRemoved,\n        filesUpdated,\n    };\n}\n//# sourceMappingURL=AuxRealtimeTreeCalculations.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxRealtimeTreeCalculations.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js ***!
  \*****************************************************************************/
/*! exports provided: AuxReducer, calculateSequenceRef, calculateSequenceRefs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxReducer\", function() { return AuxReducer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRef\", function() { return calculateSequenceRef; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRefs\", function() { return calculateSequenceRefs; });\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n/* harmony import */ var _Files__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Files */ \"./node_modules/@casual-simulation/aux-common/Files/index.js\");\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n/**\n * Defines an AtomReducer that is able to produce AuxState from a weave of Aux operations.\n */\nclass AuxReducer {\n    // TODO: Improve Performance.\n    //       On weaves with a large number of last write wins (LWW)\n    //       atoms WeaveTraverser.skip() ends up being ~50% of the cost\n    //       of this method.\n    //       Clearly, this can be improved by simply removing old LWW atoms from the weave\n    //       but it would still be nice to improve.\n    eval(weave, refs, old, metadata) {\n        let value = {};\n        metadata =\n            refs && old && metadata\n                ? metadata\n                : {\n                    cache: new Map(),\n                };\n        let tree = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_2__[\"WeaveTraverser\"](weave);\n        if (refs) {\n            for (let i = 0; i < refs.length; i++) {\n                const chain = weave.referenceChain(refs[i]);\n                for (let b = 0; b < chain.length; b++) {\n                    metadata.cache.delete(chain[b]);\n                }\n            }\n        }\n        while (tree.peek()) {\n            const ref = tree.next();\n            if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].file) {\n                const id = ref.value.id;\n                if (typeof value[id] === 'undefined') {\n                    let file = metadata.cache.get(ref);\n                    if (typeof file === 'undefined') {\n                        file = this._evalFile(tree, ref, ref.value, metadata);\n                        metadata.cache.set(ref, file);\n                    }\n                    else {\n                        tree.skip(ref.id);\n                    }\n                    if (file) {\n                        value[id] = file;\n                    }\n                }\n            }\n        }\n        return [value, metadata];\n    }\n    _evalFile(tree, parent, file, metadata) {\n        const id = file.id;\n        let data = {};\n        let meta = {\n            ref: parent,\n            tags: {},\n        };\n        while (tree.peek(parent.id)) {\n            const ref = tree.next();\n            if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].delete) {\n                tree.skip(parent.id);\n                return null;\n            }\n            else if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].tag) {\n                let tag = metadata.cache.get(ref);\n                if (typeof tag === 'undefined') {\n                    tag = this._evalTag(tree, ref, ref.value, metadata);\n                    if (typeof tag !== 'undefined') {\n                        metadata.cache.set(ref, tag);\n                    }\n                }\n                else {\n                    tree.skip(ref.id);\n                }\n                if (tag &&\n                    tag.name.value &&\n                    tag.value.hasValue &&\n                    typeof meta.tags[tag.name.value] === 'undefined') {\n                    if (Object(_Files__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(tag.value.value)) {\n                        data[tag.name.value] = tag.value.value;\n                    }\n                    meta.tags[tag.name.value] = {\n                        ref: ref,\n                        name: tag.name.meta,\n                        value: tag.value.meta,\n                    };\n                }\n            }\n        }\n        let auxFile = {\n            id: id,\n            metadata: meta,\n            tags: {},\n        };\n        auxFile.tags = Object(_utils__WEBPACK_IMPORTED_MODULE_3__[\"merge\"])(auxFile.tags, data);\n        return auxFile;\n    }\n    _evalTag(tree, parent, tag, metadata) {\n        let name = this.evalSequence(tree.fork(), parent, parent.value.name, metadata);\n        let value = this._evalTagValue(tree, parent, parent.value, metadata);\n        return {\n            name,\n            value,\n        };\n    }\n    _evalTagValue(tree, parent, tag, metadata) {\n        let value = null;\n        let hasValue = false;\n        let meta = {\n            ref: null,\n            sequence: null,\n        };\n        while (tree.peek(parent.id)) {\n            const ref = tree.next();\n            if (hasValue) {\n                tree.skip(parent.id);\n            }\n            else if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].value) {\n                hasValue = true;\n                meta.ref = ref;\n                const { value: val, meta: valMeta } = this.evalSequence(tree, ref, ref.value.value, metadata);\n                value = val;\n                meta.sequence = valMeta;\n            }\n        }\n        return { value, meta, hasValue };\n    }\n    evalSequence(tree, parent, value, metadata) {\n        // list of number pairs\n        let offsets = [];\n        let meta = null;\n        if (parent.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].value ||\n            parent.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].tag) {\n            if (typeof value === 'string') {\n                meta = createSequenceMeta(parent, value);\n            }\n        }\n        else if (parent.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].insert) {\n            meta = createSequenceMeta(parent, value);\n        }\n        while (tree.peek(parent.id)) {\n            const ref = tree.next();\n            if (typeof value !== 'string') {\n                value = value.toString();\n                meta = createSequenceMeta(parent, value);\n            }\n            if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].delete) {\n                const start = Math.max(ref.value.start || 0, 0);\n                const end = ref.value.end || value.length;\n                const length = end - start;\n                const offset = calculateOffsetForIndex(start, offsets, true);\n                const index = start + offset;\n                const deleteCount = length + offset;\n                offsets.push(index, -deleteCount);\n                meta.refs.splice(index, deleteCount);\n                meta.indexes.splice(index, deleteCount);\n                value = Object(_utils__WEBPACK_IMPORTED_MODULE_3__[\"splice\"])(value, index, deleteCount, '');\n            }\n            else if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_0__[\"AuxOpType\"].insert) {\n                let sequence = metadata.cache.get(ref);\n                if (typeof sequence === 'undefined') {\n                    sequence = this.evalSequence(tree, ref, ref.value.text, metadata);\n                    metadata.cache.set(ref, sequence);\n                }\n                else {\n                    tree.skip(ref.id);\n                }\n                const offset = calculateOffsetForIndex(ref.value.index, offsets, false);\n                const index = ref.value.index + offset;\n                offsets.push(index, sequence.value.length);\n                const newMetaRefs = sequence.meta.refs;\n                const newMetaIndices = sequence.meta.indexes;\n                meta.refs.splice(index, 0, ...newMetaRefs);\n                meta.indexes.splice(index, 0, ...newMetaIndices);\n                value = Object(_utils__WEBPACK_IMPORTED_MODULE_3__[\"splice\"])(value, index, 0, sequence.value);\n            }\n        }\n        return { value, meta };\n    }\n}\n/**\n * Calculates the ref and index within said ref that the given index falls at.\n * @param meta The metadata for the sequence.\n * @param index The index in the final text that the value should be inserted at.\n */\nfunction calculateSequenceRef(meta, index) {\n    const refs = calculateSequenceRefs(meta, index);\n    if (refs && refs.length > 0) {\n        return refs[0];\n    }\n    else {\n        return null;\n    }\n}\nfunction calculateSequenceRefs(meta, index, length) {\n    // Check for nulls\n    if (meta === null) {\n        if (typeof length !== 'undefined') {\n            return [{ ref: null, index, length }];\n        }\n        else {\n            return [{ ref: null, index }];\n        }\n    }\n    else if (index >= meta.indexes.length) {\n        if (meta.indexes.length > 0) {\n            return [\n                {\n                    ref: meta.refs[meta.refs.length - 1],\n                    index: meta.indexes[meta.indexes.length - 1] + 1,\n                },\n            ];\n        }\n        else {\n            return [{ ref: null, index: 0 }];\n        }\n    }\n    else if (index < 0) {\n        if (meta.indexes.length > 0) {\n            return [\n                {\n                    ref: meta.refs[0],\n                    index: meta.indexes[0],\n                },\n            ];\n        }\n        else {\n            return [{ ref: null, index: 0 }];\n        }\n    }\n    let refs = [];\n    const ref = meta.refs[index];\n    const idx = meta.indexes[index];\n    if (length <= 0 || typeof length === 'undefined') {\n        refs.push({ ref, index: idx });\n    }\n    else {\n        let start = index;\n        let currentRef = ref;\n        let currentRefIndex = idx;\n        let lastRefIndex = idx;\n        for (let counter = 0; counter < length; counter++) {\n            let i = start + counter;\n            let nextRef = meta.refs[i];\n            if (currentRef !== nextRef) {\n                refs.push({\n                    ref: currentRef,\n                    index: currentRefIndex,\n                    length: lastRefIndex - currentRefIndex + 1,\n                });\n                currentRef = nextRef;\n                currentRefIndex = meta.indexes[i];\n                lastRefIndex = currentRefIndex;\n            }\n            else {\n                lastRefIndex = meta.indexes[i];\n            }\n        }\n        refs.push({\n            ref: currentRef,\n            index: currentRefIndex,\n            length: lastRefIndex - currentRefIndex + 1,\n        });\n    }\n    return refs;\n}\nfunction createSequenceMeta(ref, value) {\n    let refs = new Array(value.length);\n    let indexes = new Array(value.length);\n    Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"fill\"])(refs, ref, 0, value.length);\n    fillIndexes(indexes);\n    return {\n        refs,\n        indexes,\n    };\n}\nfunction fillIndexes(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = i;\n    }\n}\nfunction calculateOffsetForIndex(index, offsets, isDelete) {\n    const startIndex = index;\n    let offset = 0;\n    for (let i = 0; i < offsets.length; i += 2) {\n        const oIndex = offsets[i];\n        if (isDelete) {\n            if (oIndex <= startIndex) {\n                offset += offsets[i + 1];\n            }\n        }\n        else {\n            if (oIndex < startIndex) {\n                offset += +offsets[i + 1];\n            }\n        }\n    }\n    return offset;\n}\n//# sourceMappingURL=AuxReducer.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js ***!
  \**************************************************************************************/
/*! exports provided: getAtomTag, getAtomFile, getTagMetadata, insertIntoTagValue, insertIntoTagName, deleteFromTagValue, deleteFromTagName */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAtomTag\", function() { return getAtomTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAtomFile\", function() { return getAtomFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTagMetadata\", function() { return getTagMetadata; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagValue\", function() { return insertIntoTagValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagName\", function() { return insertIntoTagName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagValue\", function() { return deleteFromTagValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagName\", function() { return deleteFromTagName; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n/* harmony import */ var _AuxReducer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AuxReducer */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js\");\n/* harmony import */ var _AuxAtoms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuxAtoms */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js\");\n\n\n\n\n/**\n * Gets the File Atom that the given atom is childed under.\n */\nfunction getAtomTag(weave, ref) {\n    if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].tag) {\n        return ref;\n    }\n    if (!ref.cause) {\n        return null;\n    }\n    const cause = weave.getAtom(ref.cause);\n    return getAtomTag(weave, cause);\n}\n/**\n * Gets the File Atom that the given atom is childed under.\n */\nfunction getAtomFile(weave, ref) {\n    if (ref.value.type === _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"].file) {\n        return ref;\n    }\n    if (!ref.cause) {\n        return null;\n    }\n    const cause = weave.getAtom(ref.cause);\n    return getAtomFile(weave, cause);\n}\n/**\n * Gets the metadata for the given tag.\n * If the tag does not exist, then null is returned.\n * @param file The file that the metadata should come from.\n * @param tag The name of the tag.\n */\nfunction getTagMetadata(file, tag) {\n    if (file && file.metadata && file.metadata.tags[tag]) {\n        return file.metadata.tags[tag];\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Inserts the given text into the given tag or value on the given file.\n * @param file The file that the text should be inserted into.\n * @param tag The tag that the text should be inserted into.\n * @param text The text that should be inserted.\n * @param index The index that the text should be inserted at.\n */\nfunction insertIntoTagValue(file, tag, text, index) {\n    const tagMeta = getTagMetadata(file, tag);\n    if (tagMeta) {\n        const result = Object(_AuxReducer__WEBPACK_IMPORTED_MODULE_2__[\"calculateSequenceRef\"])(tagMeta.value.sequence, index);\n        return Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"precalculatedOp\"])(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_3__[\"insert\"])(result.index, text), result.ref);\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Inserts the given text into the given tag name.\n * Note that after inserting the text the tag name will change.\n * @param tag The tag whose name should be updated.\n * @param text The text to insert into the tag name.\n * @param index The index that the text should be inserted at.\n */\nfunction insertIntoTagName(file, tag, text, index) {\n    const tagMeta = getTagMetadata(file, tag);\n    if (tagMeta) {\n        const result = Object(_AuxReducer__WEBPACK_IMPORTED_MODULE_2__[\"calculateSequenceRef\"])(tagMeta.name, index);\n        return Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"precalculatedOp\"])(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_3__[\"insert\"])(result.index, text), result.ref);\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Deletes a segment of text from the given tag's value.\n * @param file The file that the text should be deleted from.\n * @param tag The tag that the text should be deleted from.\n * @param index The index that the text should be deleted at.\n * @param length The number of characters to delete.\n */\nfunction deleteFromTagValue(file, tag, index, length) {\n    const tagMeta = getTagMetadata(file, tag);\n    if (tagMeta) {\n        const result = Object(_AuxReducer__WEBPACK_IMPORTED_MODULE_2__[\"calculateSequenceRefs\"])(tagMeta.value.sequence, index, length);\n        return result.map(r => Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"precalculatedOp\"])(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_3__[\"del\"])(r.index, r.index + r.length), r.ref, 1));\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Deletes a segment of text from the given tag's name.\n * Note that after inserting the text the tag name will change.\n * @param tag The tag whose name should be updated.\n * @param index The index that the characters should be deleted from.\n * @param length The number of characters to delete.\n */\nfunction deleteFromTagName(file, tag, index, length) {\n    const tagMeta = getTagMetadata(file, tag);\n    if (tagMeta) {\n        const result = Object(_AuxReducer__WEBPACK_IMPORTED_MODULE_2__[\"calculateSequenceRefs\"])(tagMeta.name, index);\n        return result.map(r => Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"precalculatedOp\"])(Object(_AuxAtoms__WEBPACK_IMPORTED_MODULE_3__[\"del\"])(r.index, r.index + r.length), r.ref, 1));\n    }\n    else {\n        return null;\n    }\n}\n//# sourceMappingURL=AuxTreeCalculations.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/aux-format/index.js":
/*!************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/aux-format/index.js ***!
  \************************************************************************/
/*! exports provided: root, file, tag, value, insert, del, op, AuxOpType, AuxCausalTree, getFilesStateFromStoredTree, AuxReducer, calculateSequenceRef, calculateSequenceRefs, auxCausalTreeFactory, getAtomTag, getAtomFile, getTagMetadata, insertIntoTagValue, insertIntoTagName, deleteFromTagValue, deleteFromTagName, fileChangeObservables */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AuxAtoms */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxAtoms.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"root\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"root\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"file\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"file\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tag\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"tag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"value\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"value\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insert\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"insert\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"del\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"del\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"op\", function() { return _AuxAtoms__WEBPACK_IMPORTED_MODULE_0__[\"op\"]; });\n\n/* harmony import */ var _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxOpTypes */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxOpTypes.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxOpType\", function() { return _AuxOpTypes__WEBPACK_IMPORTED_MODULE_1__[\"AuxOpType\"]; });\n\n/* harmony import */ var _AuxCausalTree__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AuxCausalTree */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxCausalTree\", function() { return _AuxCausalTree__WEBPACK_IMPORTED_MODULE_2__[\"AuxCausalTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesStateFromStoredTree\", function() { return _AuxCausalTree__WEBPACK_IMPORTED_MODULE_2__[\"getFilesStateFromStoredTree\"]; });\n\n/* harmony import */ var _AuxReducer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuxReducer */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxReducer.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxReducer\", function() { return _AuxReducer__WEBPACK_IMPORTED_MODULE_3__[\"AuxReducer\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRef\", function() { return _AuxReducer__WEBPACK_IMPORTED_MODULE_3__[\"calculateSequenceRef\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRefs\", function() { return _AuxReducer__WEBPACK_IMPORTED_MODULE_3__[\"calculateSequenceRefs\"]; });\n\n/* harmony import */ var _AuxCausalTreeFactory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuxCausalTreeFactory */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxCausalTreeFactory.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"auxCausalTreeFactory\", function() { return _AuxCausalTreeFactory__WEBPACK_IMPORTED_MODULE_4__[\"auxCausalTreeFactory\"]; });\n\n/* harmony import */ var _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AuxTreeCalculations */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxTreeCalculations.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAtomTag\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"getAtomTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAtomFile\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"getAtomFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTagMetadata\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"getTagMetadata\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagValue\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"insertIntoTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagName\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"insertIntoTagName\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagValue\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"deleteFromTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagName\", function() { return _AuxTreeCalculations__WEBPACK_IMPORTED_MODULE_5__[\"deleteFromTagName\"]; });\n\n/* harmony import */ var _AuxRealtimeTreeCalculations__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AuxRealtimeTreeCalculations */ \"./node_modules/@casual-simulation/aux-common/aux-format/AuxRealtimeTreeCalculations.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileChangeObservables\", function() { return _AuxRealtimeTreeCalculations__WEBPACK_IMPORTED_MODULE_6__[\"fileChangeObservables\"]; });\n\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/aux-format/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/index.js":
/*!*************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/index.js ***!
  \*************************************************************/
/*! exports provided: merge, mapValuesDeep, splice, lerp, clamp, normalize, unnormalize, shortUuid, parseRealtimeChannelId, apiVersion, StateMachine, State, DEFAULT_USER_MODE, DEFAULT_SELECTION_MODE, DEFAULT_FILE_SHAPE, DEFAULT_LABEL_ANCHOR, DEFAULT_WORKSPACE_HEIGHT, DEFAULT_WORKSPACE_SIZE, DEFAULT_WORKSPACE_SCALE, DEFAULT_MINI_WORKSPACE_SCALE, DEFAULT_WORKSPACE_GRID_SCALE, DEFAULT_WORKSPACE_HEIGHT_INCREMENT, DEFAULT_WORKSPACE_MIN_HEIGHT, DEFAULT_WORKSPACE_COLOR, DEFAULT_SCENE_BACKGROUND_COLOR, DEFAULT_BUILDER_USER_COLOR, DEFAULT_PLAYER_USER_COLOR, DEFAULT_USER_INACTIVE_TIME, DEFAULT_USER_DELETION_TIME, GLOBALS_FILE_ID, AUX_FILE_VERSION, KNOWN_TAGS, fileAdded, fileRemoved, fileUpdated, transaction, action, addState, pasteState, toast, tweenTo, openQRCodeScanner, showQRCode, loadSimulation, unloadSimulation, superShout, goToContext, importAUX, showInputForTag, setForcedOffline, goToURL, openURL, sayHello, echo, grantRole, revokeRole, shell, openConsole, isFormulaObjectSymbol, ShortId_Length, COMBINE_ACTION_NAME, DIFF_ACTION_NAME, CREATE_ACTION_NAME, DESTROY_ACTION_NAME, DROP_IN_CONTEXT_ACTION_NAME, DROP_ANY_IN_CONTEXT_ACTION_NAME, DRAG_OUT_OF_CONTEXT_ACTION_NAME, DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME, DRAG_OUT_OF_INVENTORY_ACTION_NAME, DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME, DROP_IN_INVENTORY_ACTION_NAME, DROP_ANY_IN_INVENTORY_ACTION_NAME, ON_QR_CODE_SCANNED_ACTION_NAME, ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME, ON_QR_CODE_SCANNER_OPENED_ACTION_NAME, DEFAULT_ENERGY, hasValue, cleanFile, isMinimized, isContext, isVisibleContext, filterFilesBySelection, fileTags, getAllFileTags, filesFromShortIds, fileFromShortId, getShortId, isHiddenTag, isPrecalculated, calculateFileValue, calculateFormattedFileValue, isFormula, isAssignment, containsFormula, isArray, parseArray, isNumber, isFile, getActiveObjects, isFilterTag, isTagWellKnown, doFilesAppearEqual, validateTag, selectionIdForUser, updateUserSelection, toggleFileSelection, newSelectionId, getUserFileColor, getUserMenuId, getFilesInMenu, getUserAccountFile, getTokensForUserAccount, findMatchingToken, getFileRoles, filesInContext, addToContextDiff, removeFromContextDiff, setPositionDiff, addFileToMenu, removeFileFromMenu, tagsOnFile, getTag, getFileTag, createContextId, createFile, createPrecalculatedFile, createWorkspace, updateFile, calculateGridScale, calculateStateDiff, trimTag, filtersMatchingArguments, filterMatchesArguments, isInUsernameList, getFileUsernameList, getFileStringList, whitelistOrBlacklistAllowsAccess, whitelistAllowsAccess, blacklistAllowsAccess, getFileWhitelist, getFileBlacklist, getFileDesignerList, getFileVersion, getFileIndex, getFilePosition, getFileRotation, getFileInputTarget, getFileInputPlaceholder, getFileShape, getFileLabelAnchor, isConfigForContext, isContextLocked, getFileConfigContexts, getContextValue, getFileDragMode, isFileStackable, isFileMovable, isFileListening, isContextMovable, getContextPosition, getContextRotation, getContextMinimized, getContextColor, getContextSize, getContextVisualizeMode, getBuilderContextGrid, getContextGridHeight, getContextGridScale, getContextScale, getContextDefaultHeight, objectsAtContextGridPosition, isUserFile, objectsAtWorkspace, duplicateFile, filterWellKnownAndContextTags, getContexts, isWellKnownOrContext, isDiff, isMergeable, isPickupable, getDiffUpdate, getDiffTags, simulationIdToString, parseSimulationId, normalizeAUXFileURL, parseFilterTag, getUserMode, getSelectionMode, calculateFileValueAsFile, calculateStringListTagValue, calculateNumericalTagValue, calculateBooleanTagValue, isDestroyable, isEditable, isSimulation, getFileChannel, getChannelFileById, getChannelConnectedDevices, getChannelMaxDevicesAllowed, getMaxDevicesAllowed, getConnectedDevices, isFileInContext, fileContextSortOrder, calculateFormulaValue, isUserActive, shouldDeleteUser, formatValue, calculateValue, calculateCopiableValue, convertToCopiableValue, createFormulaLibrary, createCalculationContext, createPrecalculatedContext, createCalculationContextFromState, calculateActionEventsUsingContext, calculateActionResultsUsingContext, getFilesForAction, calculateFileActionEvents, formulaActions, searchFileState, calculateActionResults, calculateActionEvents, calculateFormulaEvents, calculateDestroyFileEvents, EvalSandbox, anyArgument, Transpiler, Dependencies, root, file, tag, value, insert, del, op, AuxOpType, AuxCausalTree, getFilesStateFromStoredTree, AuxReducer, calculateSequenceRef, calculateSequenceRefs, auxCausalTreeFactory, getAtomTag, getAtomFile, getTagMetadata, insertIntoTagValue, insertIntoTagName, deleteFromTagValue, deleteFromTagName, fileChangeObservables */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./node_modules/@casual-simulation/aux-common/utils.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"merge\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"merge\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"mapValuesDeep\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"mapValuesDeep\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"splice\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"splice\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lerp\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"lerp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"clamp\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"clamp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"normalize\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"normalize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"unnormalize\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"unnormalize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"shortUuid\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"shortUuid\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseRealtimeChannelId\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"parseRealtimeChannelId\"]; });\n\n/* harmony import */ var _state_machine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state-machine */ \"./node_modules/@casual-simulation/aux-common/state-machine/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"StateMachine\", function() { return _state_machine__WEBPACK_IMPORTED_MODULE_1__[\"StateMachine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"State\", function() { return _state_machine__WEBPACK_IMPORTED_MODULE_1__[\"State\"]; });\n\n/* harmony import */ var _Files__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Files */ \"./node_modules/@casual-simulation/aux-common/Files/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_MODE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_USER_MODE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SELECTION_MODE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_SELECTION_MODE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_FILE_SHAPE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_FILE_SHAPE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_LABEL_ANCHOR\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_LABEL_ANCHOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_HEIGHT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SIZE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_SIZE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_SCALE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_MINI_WORKSPACE_SCALE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_MINI_WORKSPACE_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_GRID_SCALE\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_GRID_SCALE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_HEIGHT_INCREMENT\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_HEIGHT_INCREMENT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_MIN_HEIGHT\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_MIN_HEIGHT\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_WORKSPACE_COLOR\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_WORKSPACE_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_SCENE_BACKGROUND_COLOR\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_SCENE_BACKGROUND_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_BUILDER_USER_COLOR\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_BUILDER_USER_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_PLAYER_USER_COLOR\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_PLAYER_USER_COLOR\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_INACTIVE_TIME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_USER_INACTIVE_TIME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_USER_DELETION_TIME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_USER_DELETION_TIME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GLOBALS_FILE_ID\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"GLOBALS_FILE_ID\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AUX_FILE_VERSION\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"AUX_FILE_VERSION\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"KNOWN_TAGS\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"KNOWN_TAGS\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileAdded\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileAdded\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileRemoved\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileRemoved\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileUpdated\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileUpdated\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"transaction\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"transaction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"action\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"action\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addState\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"addState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pasteState\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"pasteState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"toast\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"toast\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tweenTo\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"tweenTo\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openQRCodeScanner\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"openQRCodeScanner\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"showQRCode\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"showQRCode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"loadSimulation\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"loadSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"unloadSimulation\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"unloadSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"superShout\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"superShout\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"goToContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"goToContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"importAUX\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"importAUX\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"showInputForTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"showInputForTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setForcedOffline\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"setForcedOffline\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"goToURL\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"goToURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openURL\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"openURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"sayHello\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"sayHello\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"echo\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"echo\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"grantRole\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"grantRole\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"revokeRole\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"revokeRole\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"shell\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"shell\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"openConsole\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"openConsole\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFormulaObjectSymbol\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFormulaObjectSymbol\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ShortId_Length\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"ShortId_Length\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"COMBINE_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"COMBINE_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DIFF_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DIFF_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CREATE_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"CREATE_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DESTROY_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DESTROY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_CONTEXT_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DROP_IN_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_CONTEXT_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DROP_ANY_IN_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_CONTEXT_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_OUT_OF_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_ANY_OUT_OF_CONTEXT_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_OUT_OF_INVENTORY_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_OUT_OF_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DRAG_ANY_OUT_OF_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_IN_INVENTORY_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DROP_IN_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DROP_ANY_IN_INVENTORY_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DROP_ANY_IN_INVENTORY_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNED_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNER_CLOSED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ON_QR_CODE_SCANNER_OPENED_ACTION_NAME\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"ON_QR_CODE_SCANNER_OPENED_ACTION_NAME\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_ENERGY\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"DEFAULT_ENERGY\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"hasValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"hasValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"cleanFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"cleanFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isMinimized\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isMinimized\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isVisibleContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isVisibleContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterFilesBySelection\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filterFilesBySelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileTags\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAllFileTags\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getAllFileTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filesFromShortIds\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filesFromShortIds\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileFromShortId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileFromShortId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getShortId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getShortId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isHiddenTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isHiddenTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isPrecalculated\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isPrecalculated\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFileValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormattedFileValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFormattedFileValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFormula\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFormula\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isAssignment\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isAssignment\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"containsFormula\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"containsFormula\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isArray\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseArray\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"parseArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isNumber\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isNumber\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getActiveObjects\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getActiveObjects\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFilterTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFilterTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isTagWellKnown\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isTagWellKnown\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"doFilesAppearEqual\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"doFilesAppearEqual\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"validateTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"validateTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"selectionIdForUser\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"selectionIdForUser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"updateUserSelection\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"updateUserSelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"toggleFileSelection\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"toggleFileSelection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"newSelectionId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"newSelectionId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserFileColor\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getUserFileColor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserMenuId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getUserMenuId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesInMenu\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFilesInMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserAccountFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getUserAccountFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTokensForUserAccount\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getTokensForUserAccount\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"findMatchingToken\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"findMatchingToken\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileRoles\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileRoles\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filesInContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filesInContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addToContextDiff\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"addToContextDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"removeFromContextDiff\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"removeFromContextDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setPositionDiff\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"setPositionDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"addFileToMenu\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"addFileToMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"removeFileFromMenu\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"removeFileFromMenu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tagsOnFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"tagsOnFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createContextId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createContextId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createPrecalculatedFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createWorkspace\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createWorkspace\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"updateFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"updateFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateGridScale\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateGridScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateStateDiff\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateStateDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"trimTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"trimTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filtersMatchingArguments\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filtersMatchingArguments\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterMatchesArguments\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filterMatchesArguments\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isInUsernameList\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isInUsernameList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileUsernameList\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileUsernameList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileStringList\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileStringList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"whitelistOrBlacklistAllowsAccess\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"whitelistOrBlacklistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"whitelistAllowsAccess\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"whitelistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"blacklistAllowsAccess\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"blacklistAllowsAccess\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileWhitelist\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileWhitelist\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileBlacklist\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileBlacklist\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileDesignerList\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileDesignerList\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileVersion\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileIndex\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileIndex\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilePosition\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFilePosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileRotation\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileRotation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileInputTarget\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileInputTarget\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileInputPlaceholder\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileInputPlaceholder\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileShape\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileShape\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileLabelAnchor\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileLabelAnchor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isConfigForContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isConfigForContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContextLocked\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isContextLocked\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileConfigContexts\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileConfigContexts\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileDragMode\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileDragMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileStackable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFileStackable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileMovable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFileMovable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileListening\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFileListening\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isContextMovable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isContextMovable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextPosition\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextPosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextRotation\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextRotation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextMinimized\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextMinimized\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextColor\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextColor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextSize\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextSize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextVisualizeMode\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextVisualizeMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getBuilderContextGrid\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getBuilderContextGrid\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextGridHeight\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextGridHeight\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextGridScale\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextGridScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextScale\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextScale\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextDefaultHeight\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContextDefaultHeight\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"objectsAtContextGridPosition\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"objectsAtContextGridPosition\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isUserFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isUserFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"objectsAtWorkspace\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"objectsAtWorkspace\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"duplicateFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"duplicateFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"filterWellKnownAndContextTags\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"filterWellKnownAndContextTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContexts\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getContexts\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isWellKnownOrContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isWellKnownOrContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isDiff\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isDiff\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isMergeable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isMergeable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isPickupable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isPickupable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getDiffUpdate\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getDiffUpdate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getDiffTags\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getDiffTags\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"simulationIdToString\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"simulationIdToString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseSimulationId\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"parseSimulationId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"normalizeAUXFileURL\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"normalizeAUXFileURL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseFilterTag\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"parseFilterTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUserMode\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getUserMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getSelectionMode\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getSelectionMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileValueAsFile\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFileValueAsFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateStringListTagValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateStringListTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateNumericalTagValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateNumericalTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateBooleanTagValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateBooleanTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isDestroyable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isDestroyable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isEditable\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isEditable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isSimulation\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFileChannel\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFileChannel\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelFileById\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getChannelFileById\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelConnectedDevices\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getChannelConnectedDevices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChannelMaxDevicesAllowed\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getChannelMaxDevicesAllowed\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getMaxDevicesAllowed\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getMaxDevicesAllowed\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getConnectedDevices\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getConnectedDevices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isFileInContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isFileInContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileContextSortOrder\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"fileContextSortOrder\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFormulaValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isUserActive\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"isUserActive\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"shouldDeleteUser\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"shouldDeleteUser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formatValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"formatValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateCopiableValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateCopiableValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"convertToCopiableValue\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"convertToCopiableValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createFormulaLibrary\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createFormulaLibrary\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createPrecalculatedContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createPrecalculatedContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createCalculationContextFromState\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"createCalculationContextFromState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEventsUsingContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateActionEventsUsingContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResultsUsingContext\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateActionResultsUsingContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesForAction\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"getFilesForAction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFileActionEvents\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFileActionEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formulaActions\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"formulaActions\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"searchFileState\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"searchFileState\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionResults\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateActionResults\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateActionEvents\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateActionEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateFormulaEvents\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateFormulaEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateDestroyFileEvents\", function() { return _Files__WEBPACK_IMPORTED_MODULE_2__[\"calculateDestroyFileEvents\"]; });\n\n/* harmony import */ var _Formulas__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Formulas */ \"./node_modules/@casual-simulation/aux-common/Formulas/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"EvalSandbox\", function() { return _Formulas__WEBPACK_IMPORTED_MODULE_3__[\"EvalSandbox\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"anyArgument\", function() { return _Formulas__WEBPACK_IMPORTED_MODULE_3__[\"anyArgument\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Transpiler\", function() { return _Formulas__WEBPACK_IMPORTED_MODULE_3__[\"Transpiler\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Dependencies\", function() { return _Formulas__WEBPACK_IMPORTED_MODULE_3__[\"Dependencies\"]; });\n\n/* harmony import */ var _aux_format__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./aux-format */ \"./node_modules/@casual-simulation/aux-common/aux-format/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"root\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"root\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"file\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"file\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tag\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"tag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"value\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"value\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insert\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"insert\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"del\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"del\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"op\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"op\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxOpType\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"AuxOpType\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxCausalTree\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"AuxCausalTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getFilesStateFromStoredTree\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"getFilesStateFromStoredTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxReducer\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"AuxReducer\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRef\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"calculateSequenceRef\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calculateSequenceRefs\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"calculateSequenceRefs\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"auxCausalTreeFactory\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"auxCausalTreeFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAtomTag\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"getAtomTag\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getAtomFile\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"getAtomFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getTagMetadata\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"getTagMetadata\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagValue\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"insertIntoTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"insertIntoTagName\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"insertIntoTagName\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagValue\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"deleteFromTagValue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"deleteFromTagName\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"deleteFromTagName\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fileChangeObservables\", function() { return _aux_format__WEBPACK_IMPORTED_MODULE_4__[\"fileChangeObservables\"]; });\n\n/* harmony import */ var _ApiVersion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ApiVersion */ \"./node_modules/@casual-simulation/aux-common/ApiVersion.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"apiVersion\", function() { return _ApiVersion__WEBPACK_IMPORTED_MODULE_5__[\"apiVersion\"]; });\n\n/**\n * MIT License\n *\n * Copyright (c) 2019 Casual Simulation, Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * @license MIT\n */\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/polyfill/Array.first.polyfill.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/polyfill/Array.first.polyfill.js ***!
  \*************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("if (!Array.prototype['first']) {\n    Object.defineProperty(Array.prototype, 'first', {\n        value: function () {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n            var o = Object(this);\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n            // 3. Check if we have at least one element\n            if (len > 0) {\n                // 4. Return first element\n                return o[0];\n            }\n            // 5. Return undefined.\n            return undefined;\n        },\n        configurable: true,\n        writable: true,\n    });\n}\n//# sourceMappingURL=Array.first.polyfill.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/polyfill/Array.first.polyfill.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/polyfill/Array.last.polyfill.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/polyfill/Array.last.polyfill.js ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("if (!Array.prototype['last']) {\n    Object.defineProperty(Array.prototype, 'last', {\n        value: function () {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n            var o = Object(this);\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n            // 3. Check if we have at least one element\n            if (len > 0) {\n                // 4. Return the last element\n                return o[len - 1];\n            }\n            // 5. Return undefined.\n            return undefined;\n        },\n        configurable: true,\n        writable: true,\n    });\n}\n//# sourceMappingURL=Array.last.polyfill.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/polyfill/Array.last.polyfill.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/state-machine/StateMachine.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/state-machine/StateMachine.js ***!
  \**********************************************************************************/
/*! exports provided: StateMachine, State */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StateMachine\", function() { return StateMachine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"State\", function() { return State; });\nclass StateMachine {\n    /**\n     * Create a new state machine. Setup the state machine using `addState` and `addStateTransition`.\n     * Start the state machine using the `start` method. Manually call `update` every frame in order to update the state machine.\n     */\n    constructor(name) {\n        /**\n         * Debug level of this state machine.\n         * 0 = off; 1 = enter, exit; 2 = transitions, 3 = update\n         */\n        this.debugLevel = 0;\n        /**\n         * Map of available states. state id -> State.\n         */\n        this._states = {};\n        /**\n         * Map of transition hash code -> state id\n         */\n        this._transitions = {};\n        this.name = name;\n    }\n    get currentState() {\n        return this._states[this._curStateId];\n    }\n    start(startingStateId, curFrame) {\n        if (this._active)\n            return;\n        this._active = true;\n        this._curFrame = curFrame;\n        this._changeState(startingStateId);\n        this.update(curFrame);\n    }\n    pause() {\n        if (!this._active)\n            return;\n        this._active = false;\n    }\n    resume(curFrame) {\n        if (this._active)\n            return;\n        this._active = true;\n        this._curFrame = curFrame;\n        this.update(curFrame);\n    }\n    addState(state) {\n        if (this._active)\n            throw new Error('Cannot add states to state machine after it has started.');\n        this._states[state.id] = state;\n    }\n    addStateTransition(transition, nextStateId) {\n        if (this._active)\n            throw new Error('Cannot add state transitions after the state machine has been started.');\n        if (!this._states[nextStateId])\n            throw new Error(`Can't add transition for state '${nextStateId}'. This state does not exist on the state machine.`);\n        let transitionHash = computeTransitionHash(transition);\n        this._transitions[transitionHash] = nextStateId;\n    }\n    getState(stateId) {\n        return this._states[stateId];\n    }\n    update(curFrame) {\n        if (!this._active)\n            return;\n        if (this._lastUpdateFrame === curFrame)\n            return;\n        this._curFrame = curFrame;\n        this._lastUpdateFrame = curFrame;\n        if (this._changeStateId) {\n            let curState = this._states[this._curStateId];\n            if (curState) {\n                if (this.debugLevel >= 1)\n                    console.log(`${this.toString()} ${curState.id} onStateExit. frame: ${curFrame}`);\n                curState.onStateExit();\n            }\n            curState = this._states[this._changeStateId];\n            if (curState) {\n                if (this.debugLevel >= 1)\n                    console.log(`${this.toString()} ${curState.id} onStateEnter. frame: ${curFrame}`);\n                curState.onStateEnter();\n            }\n        }\n        else {\n            throw new Error(`${this.toString()} No state with id '${this._changeStateId}' found.`);\n        }\n        let curState = this._states[this._curStateId];\n        if (curState) {\n            if (this.debugLevel >= 3)\n                console.log(`${this.toString()} ${curState.id} onStateUpdate. frame: ${curFrame}`);\n            let command = curState.onStateUpdate();\n            if (command) {\n                if (this.debugLevel >= 2)\n                    console.log(`${this.toString()} ${curState.id} command: ${command}, nextState: ${this.getNextStateId(command)}, frame: ${curFrame}`);\n                this._changeState(this.getNextStateId(command));\n            }\n        }\n        this._changeStateId = undefined;\n    }\n    toString() {\n        return `[StateMachine::${this.name}]`;\n    }\n    /**\n     * Call this when getting rid of the state machine.\n     */\n    dispose() {\n        throw new Error(\"StateMachine's dispose is not implemented yet.\");\n    }\n    /**\n     * Usually this state machine should be controlled with state transitions, but in some cases we may want to force a state change.\n     */\n    forceChangeState(stateId) {\n        this._changeState(stateId);\n    }\n    _changeState(stateId) {\n        this._changeStateId = stateId;\n        // Set the last update frame to an invalid number so that the update state function is forced to run.\n        this._lastUpdateFrame = -1;\n        // Run the update state function immediately to respond to change the state in the same frame.\n        this.update(this._curFrame);\n    }\n    getNextStateId(command) {\n        if (this._transitions)\n            return;\n        let transition = {\n            stateId: this._curStateId,\n            command: command,\n        };\n        let transitionHash = computeTransitionHash(transition);\n        let nextStateId = this._transitions[transitionHash];\n        if (!nextStateId)\n            throw new Error(`No transition found for State '${this._curStateId}' with command '${command}'`);\n        return nextStateId;\n    }\n}\nclass State {\n    get id() {\n        return this._id;\n    }\n    constructor(id) {\n        this._id = id;\n    }\n}\n/**\n * Compute a hash code for the specified Transition.\n * @param transition The transition to compute hash code for.\n */\nfunction computeTransitionHash(transition) {\n    let hashCode = (s) => {\n        let h = 0, l = s.length, i = 0;\n        if (l > 0) {\n            while (i < l) {\n                h = ((h << 5) - h + s.charCodeAt(i++)) | 0;\n            }\n        }\n        return h;\n    };\n    return (17 +\n        31 * hashCode(transition.stateId) +\n        31 * hashCode(transition.command));\n}\n//# sourceMappingURL=StateMachine.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/state-machine/StateMachine.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/state-machine/index.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/state-machine/index.js ***!
  \***************************************************************************/
/*! exports provided: StateMachine, State */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _StateMachine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./StateMachine */ \"./node_modules/@casual-simulation/aux-common/state-machine/StateMachine.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"StateMachine\", function() { return _StateMachine__WEBPACK_IMPORTED_MODULE_0__[\"StateMachine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"State\", function() { return _StateMachine__WEBPACK_IMPORTED_MODULE_0__[\"State\"]; });\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/state-machine/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-common/utils.js":
/*!*************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-common/utils.js ***!
  \*************************************************************/
/*! exports provided: merge, mapValuesDeep, splice, lerp, clamp, normalize, unnormalize, shortUuid, parseRealtimeChannelId */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"merge\", function() { return merge; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mapValuesDeep\", function() { return mapValuesDeep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"splice\", function() { return splice; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lerp\", function() { return lerp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clamp\", function() { return clamp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"normalize\", function() { return normalize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unnormalize\", function() { return unnormalize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shortUuid\", function() { return shortUuid; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parseRealtimeChannelId\", function() { return parseRealtimeChannelId; });\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid/v4 */ \"uuid/v4\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(uuid_v4__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction merge(...objs) {\n    let result = {};\n    const objKeys = objs.map(o => Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"keys\"])(o));\n    const allKeys = Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"union\"])(...objKeys);\n    allKeys.forEach(k => {\n        result[k] = decide(...objs.map(o => o[k]));\n    });\n    return result;\n}\nfunction decide(...vals) {\n    const undefed = vals.filter(v => typeof v !== 'undefined');\n    if (undefed.length === 1) {\n        return undefed[0];\n    }\n    else {\n        if (Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"every\"])(undefed, v => typeof v === 'object' && !Array.isArray(v) && v !== null) &&\n            Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"some\"])(undefed, v => v !== undefed[0])) {\n            return merge(...undefed);\n        }\n        else {\n            return undefed[undefed.length - 1];\n        }\n    }\n}\n/**\n * Maps all the values of the given object.\n * @param value The object to map.\n * @param callback The callback that transforms one value into another.\n */\nfunction mapValuesDeep(value, callback) {\n    return Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"isObject\"])(value)\n        ? Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"mapValues\"])(value, v => mapValuesDeep(v, callback))\n        : callback(value);\n}\n/**\n * Splices the given string and returns the final result.\n * @param str The string to splice.\n * @param index The index that the splice should be started at.\n * @param deleteCount The number of characters to delete.\n * @param text The text to insert.\n */\nfunction splice(str, index, deleteCount, text) {\n    return str.slice(0, index) + text + str.slice(index + deleteCount);\n}\nfunction lerp(start, end, t) {\n    return (1.0 - t) * start + t * end;\n}\nfunction clamp(value, min, max) {\n    return Math.max(min, Math.min(max, value));\n}\nfunction normalize(value, min, max) {\n    value = clamp(value, min, max);\n    return (value - min) / (max - min);\n}\nfunction unnormalize(normal, min, max) {\n    normal = clamp(normal, 0.0, 1.0);\n    return normal * (max - min) + min;\n}\n/**\n * Creates and returns a short 8 character UUID (no dashes).\n */\nfunction shortUuid() {\n    return uuid_v4__WEBPACK_IMPORTED_MODULE_1___default()().substr(0, 8);\n}\n/**\n * Parses the given RealtimeChannelInfo ID to the ID of the aux.\n * @param id The id to parse.\n */\nfunction parseRealtimeChannelId(id) {\n    return id.substring(4);\n}\n//# sourceMappingURL=utils.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-common/utils.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/index.js":
/*!**************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/index.js ***!
  \**************************************************************/
/*! exports provided: NodeSimulation, AuxChannelManagerImpl, AuxUserAuthenticator, AuxUserAuthorizer, VM2Sandbox, getSandbox, NodeAuxChannel, AuxVMNode, AdminModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _managers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./managers */ \"./node_modules/@casual-simulation/aux-vm-node/managers/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodeSimulation\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"NodeSimulation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxChannelManagerImpl\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"AuxChannelManagerImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthenticator\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"AuxUserAuthenticator\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthorizer\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"AuxUserAuthorizer\"]; });\n\n/* harmony import */ var _vm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vm */ \"./node_modules/@casual-simulation/aux-vm-node/vm/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"VM2Sandbox\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"VM2Sandbox\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getSandbox\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"getSandbox\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodeAuxChannel\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"NodeAuxChannel\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxVMNode\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"AuxVMNode\"]; });\n\n/* harmony import */ var _modules__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./modules */ \"./node_modules/@casual-simulation/aux-vm-node/modules/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AdminModule\", function() { return _modules__WEBPACK_IMPORTED_MODULE_2__[\"AdminModule\"]; });\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/managers/AuxChannelManagerImpl.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/managers/AuxChannelManagerImpl.js ***!
  \***************************************************************************************/
/*! exports provided: AuxChannelManagerImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxChannelManagerImpl\", function() { return AuxChannelManagerImpl; });\n/* harmony import */ var _casual_simulation_causal_tree_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-tree-server */ \"./node_modules/@casual-simulation/causal-tree-server/index.js\");\n/* harmony import */ var _vm_NodeAuxChannel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../vm/NodeAuxChannel */ \"./node_modules/@casual-simulation/aux-vm-node/vm/NodeAuxChannel.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _NodeSimulation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./NodeSimulation */ \"./node_modules/@casual-simulation/aux-vm-node/managers/NodeSimulation.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\nclass AuxChannelManagerImpl extends _casual_simulation_causal_tree_server__WEBPACK_IMPORTED_MODULE_0__[\"ChannelManagerImpl\"] {\n    constructor(user, treeStore, causalTreeFactory, crypto, modules) {\n        super(treeStore, causalTreeFactory, crypto);\n        this._user = user;\n        this._auxChannels = new Map();\n        this._modules = modules;\n        this.whileCausalTreeLoaded((tree, info, events) => {\n            const config = { isPlayer: false, isBuilder: false };\n            const channel = new _vm_NodeAuxChannel__WEBPACK_IMPORTED_MODULE_1__[\"NodeAuxChannel\"](tree, this._user, {\n                host: null,\n                config: config,\n                id: info.id,\n                treeName: info.id,\n            });\n            const sim = new _NodeSimulation__WEBPACK_IMPORTED_MODULE_3__[\"NodeSimulation\"](channel, info.id, config);\n            this._auxChannels.set(info.id, {\n                channel: channel,\n                simulation: sim,\n                initialized: false,\n                subscription: new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subscription\"](),\n            });\n            return [\n                channel,\n                channel.onConnectionStateChanged.subscribe(m => {\n                    if (m.type === 'message') {\n                        console.log(`[${m.source}]: ${m.message}`);\n                    }\n                }),\n                new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subscription\"](() => {\n                    this._auxChannels.delete(info.id);\n                }),\n            ];\n        });\n    }\n    sendEvents(channel, events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield channel.channel.sendEvents(events);\n        });\n    }\n    loadChannel(info) {\n        const _super = Object.create(null, {\n            loadChannel: { get: () => super.loadChannel }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            const loaded = yield _super.loadChannel.call(this, info);\n            const status = this._auxChannels.get(info.id);\n            if (!status.initialized) {\n                status.initialized = true;\n                console.log(`[AuxChannelManagerImpl] Initializing ${info.id}...`);\n                yield status.simulation.init();\n                status.subscription.add(status.channel.remoteEvents.subscribe(loaded.events));\n                for (let mod of this._modules) {\n                    let sub = yield mod.setup(info, status.channel);\n                    if (sub) {\n                        status.subscription.add(sub);\n                    }\n                }\n            }\n            return {\n                info: loaded.info,\n                events: loaded.events,\n                subscription: loaded.subscription,\n                tree: loaded.tree,\n                channel: status.channel,\n                simulation: status.simulation,\n            };\n        });\n    }\n    connect(channel, device) {\n        const _super = Object.create(null, {\n            connect: { get: () => super.connect }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            let subscription = yield _super.connect.call(this, channel, device);\n            for (let mod of this._modules) {\n                let sub = yield mod.deviceConnected(channel.info, channel.channel, device);\n                if (sub) {\n                    subscription.add(sub);\n                }\n            }\n            return subscription;\n        });\n    }\n}\n//# sourceMappingURL=AuxChannelManagerImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/managers/AuxChannelManagerImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthenticator.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthenticator.js ***!
  \**************************************************************************************/
/*! exports provided: AuxUserAuthenticator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthenticator\", function() { return AuxUserAuthenticator; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_4__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n/**\n * Defines an authenticator that determines if a user is authenticated based on files in a simulation.\n */\nclass AuxUserAuthenticator {\n    /**\n     * Creates a new AuxUserAuthenticator for the given channel.\n     * @param adminChannel The channel that users should be looked up in.\n     */\n    constructor(adminChannel) {\n        this._users = new Map();\n        this._tokens = new Map();\n        this._userTokens = new Map();\n        this._fileAccountMap = new Map();\n        this._fileTokenMap = new Map();\n        this._userUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subject\"]();\n        this._channel = adminChannel;\n        this._sim = adminChannel.simulation;\n        this._tree = adminChannel.tree;\n        this._sub = new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subscription\"]();\n        this._sub.add(this._sim.watcher.filesDiscovered\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"tap\"])(file => this._filesAdded(file)))\n            .subscribe());\n        this._sub.add(this._sim.watcher.filesRemoved\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"tap\"])(file => this._filesRemoved(file)))\n            .subscribe());\n        this._sub.add(this._sim.watcher.filesUpdated\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"tap\"])(file => this._filesUpdated(file)))\n            .subscribe());\n    }\n    _filesAdded(files) {\n        const context = this._sim.helper.createContext();\n        for (let file of files) {\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.account.username'])) {\n                let user = this._calculateUserAccountInfo(context, file);\n                this._users.set(user.username, user);\n                this._fileAccountMap.set(file.id, user);\n                this._userUpdated.next(user.username);\n            }\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.token.username'])) {\n                let token = this._calculateUserTokenInfo(context, file);\n                let tokens = this._getTokensForUsername(token.username);\n                tokens.add(token.token);\n                this._tokens.set(token.token, token);\n                this._fileTokenMap.set(file.id, token);\n                this._userUpdated.next(token.username);\n            }\n        }\n    }\n    _filesRemoved(ids) {\n        for (let id of ids) {\n            const user = this._fileAccountMap.get(id);\n            if (user) {\n                this._userTokens.delete(user.username);\n                this._fileAccountMap.delete(id);\n                this._users.delete(user.username);\n                this._userUpdated.next(user.username);\n            }\n            const token = this._fileTokenMap.get(id);\n            if (token) {\n                let tokens = this._userTokens.get(token.username);\n                if (tokens) {\n                    tokens.delete(token.token);\n                }\n                this._fileTokenMap.delete(id);\n                this._tokens.delete(token.token);\n                this._userUpdated.next(token.username);\n            }\n        }\n    }\n    _filesUpdated(files) {\n        const context = this._sim.helper.createContext();\n        for (let file of files) {\n            this._updateUserInfo(context, file);\n            this._updateTokenInfo(context, file);\n        }\n    }\n    _updateUserInfo(context, file) {\n        const user = this._fileAccountMap.get(file.id);\n        if (user) {\n            // We had a user\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.account.username'])) {\n                // Update user\n                this._users.delete(user.username);\n                const newUser = this._calculateUserAccountInfo(context, file);\n                this._fileAccountMap.set(file.id, newUser);\n                this._users.set(newUser.username, newUser);\n                if (newUser.username === user.username) {\n                    this._userUpdated.next(newUser.username);\n                }\n                else {\n                    this._userUpdated.next(user.username);\n                    this._userUpdated.next(newUser.username);\n                }\n            }\n            else {\n                // Remove user\n                this._userTokens.delete(user.username);\n                this._users.delete(user.username);\n                this._fileAccountMap.delete(file.id);\n                this._userUpdated.next(user.username);\n            }\n        }\n        else {\n            // We might have a new user\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.account.username'])) {\n                // We have a new user\n                const newUser = this._calculateUserAccountInfo(context, file);\n                this._fileAccountMap.set(file.id, newUser);\n                this._users.set(newUser.username, newUser);\n                this._userUpdated.next(newUser.username);\n            }\n            else {\n                // Do nothing\n            }\n        }\n    }\n    _updateTokenInfo(context, file) {\n        const token = this._fileTokenMap.get(file.id);\n        if (token) {\n            // We had a token\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.token.username'])) {\n                let oldUserTokens = this._getTokensForUsername(token.username);\n                // Update token\n                this._tokens.delete(token.token);\n                oldUserTokens.delete(token.token);\n                const newToken = this._calculateUserTokenInfo(context, file);\n                let newUserTokens = this._getTokensForUsername(newToken.username);\n                newUserTokens.add(newToken.token);\n                this._fileTokenMap.set(file.id, newToken);\n                this._tokens.set(newToken.token, newToken);\n                if (newToken.username === token.username) {\n                    this._userUpdated.next(newToken.username);\n                }\n                else {\n                    this._userUpdated.next(token.username);\n                    this._userUpdated.next(newToken.username);\n                }\n            }\n            else {\n                // Remove token\n                this._tokens.delete(token.token);\n                this._fileTokenMap.delete(file.id);\n                this._userUpdated.next(token.username);\n            }\n        }\n        else {\n            // We might have a new token\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(file.tags['aux.token.username'])) {\n                // We have a new token\n                const newToken = this._calculateUserTokenInfo(context, file);\n                let tokens = this._getTokensForUsername(newToken.username);\n                tokens.add(newToken.token);\n                this._fileTokenMap.set(file.id, newToken);\n                this._tokens.set(newToken.token, newToken);\n                this._userUpdated.next(newToken.username);\n            }\n            else {\n                // Do nothing\n            }\n        }\n    }\n    _getTokensForUsername(username) {\n        let tokens = this._userTokens.get(username);\n        if (!tokens) {\n            tokens = new Set();\n            this._userTokens.set(username, tokens);\n        }\n        return tokens;\n    }\n    _calculateUserAccountInfo(context, file) {\n        return {\n            username: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateFileValue\"])(context, file, 'aux.account.username'),\n            roles: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"getFileRoles\"])(context, file),\n            locked: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateBooleanTagValue\"])(context, file, 'aux.account.locked', false),\n        };\n    }\n    _calculateUserTokenInfo(context, file) {\n        return {\n            id: file.id,\n            token: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateFileValue\"])(context, file, 'aux.token'),\n            username: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateFileValue\"])(context, file, 'aux.token.username'),\n            locked: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateBooleanTagValue\"])(context, file, 'aux.token.locked', false),\n        };\n    }\n    authenticate(token) {\n        if (!token) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_2__[\"of\"])({\n                success: false,\n                error: 'invalid_token',\n            });\n        }\n        if (!token.token) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_2__[\"of\"])({\n                success: false,\n                error: 'invalid_token',\n            });\n        }\n        if (!token.username) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_2__[\"of\"])({\n                success: false,\n                error: 'invalid_username',\n            });\n        }\n        const _this = this;\n        return this._userUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"startWith\"])(token.username), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"filter\"])(username => username === token.username), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"concatMap\"])(u => authenticateUser()), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__[\"distinctUntilChanged\"])((a, b) => Object(lodash__WEBPACK_IMPORTED_MODULE_4__[\"isEqual\"])(a, b)));\n        function authenticateUser() {\n            return __awaiter(this, void 0, void 0, function* () {\n                let userInfo = _this._users.get(token.username);\n                const context = _this._sim.helper.createContext();\n                if (!userInfo) {\n                    const admins = [..._this._users.values()].filter(u => u.roles.has(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]));\n                    let userFile = yield _this._createUserFile(token.username, admins.length === 0, token.isGuest);\n                    userInfo = _this._calculateUserAccountInfo(context, userFile);\n                }\n                if (userInfo.locked) {\n                    return {\n                        success: false,\n                        error: 'account_locked',\n                    };\n                }\n                let tokensForUsername = _this._getTokensForUsername(userInfo.username);\n                let tokenInfo = _this._tokens.get(token.token);\n                if (tokensForUsername.has(token.token)) {\n                }\n                else if (tokensForUsername.size === 0) {\n                    let tokenFile = yield _this._createTokenFile(token);\n                    tokenInfo = _this._calculateUserTokenInfo(context, tokenFile);\n                }\n                else if (token.grant) {\n                    console.log('[AuxUserAuthenticator] Checking grant...');\n                    let grantInfo = _this._tokens.get(token.grant);\n                    if (grantInfo) {\n                        if (grantInfo.locked) {\n                            console.log('[AuxUserAuthenticator] Grant invalid');\n                            return {\n                                success: false,\n                                error: 'wrong_grant',\n                            };\n                        }\n                        console.log('[AuxUserAuthenticator] Grant valid!');\n                        let tokenFile = yield _this._createTokenFile(token);\n                        tokenInfo = _this._calculateUserTokenInfo(context, tokenFile);\n                    }\n                    else {\n                        console.log('[AuxUserAuthenticator] Grant invalid');\n                        return {\n                            success: false,\n                            error: 'wrong_grant',\n                        };\n                    }\n                }\n                if (tokenInfo) {\n                    if (tokenInfo.locked) {\n                        return {\n                            success: false,\n                            error: 'token_locked',\n                        };\n                    }\n                    const roles = userInfo.roles;\n                    const username = userInfo.username;\n                    const id = tokenInfo.id;\n                    roles.add(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USER_ROLE\"]);\n                    const info = {\n                        claims: {\n                            [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]]: username,\n                            [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"DEVICE_ID_CLAIM\"]]: id,\n                            [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]]: token.id,\n                        },\n                        roles: [...roles],\n                    };\n                    return {\n                        success: true,\n                        info: info,\n                    };\n                }\n                return {\n                    success: false,\n                    error: 'wrong_token',\n                };\n            });\n        }\n    }\n    _createTokenFile(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('[AuxUserAuthenticator] Creating token for user...');\n            const file = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"createFile\"])(undefined, {\n                'aux.tokens': true,\n                [`${token.username}.tokens`]: true,\n                'aux.token.username': token.username,\n                'aux.token': token.token,\n            });\n            yield this._tree.addFile(file);\n            return this._tree.value[file.id];\n        });\n    }\n    _createUserFile(username, firstUser, isGuest) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('[AuxUserAuthenticator] Creating file for user...');\n            let roles = [];\n            if (firstUser && !isGuest) {\n                console.log('[AuxUserAuthenticator] Granting Admin Role.');\n                roles.push(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]);\n            }\n            if (isGuest) {\n                console.log('[AuxUserAuthenticator] Granting Guest Role.');\n                roles.push(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"GUEST_ROLE\"]);\n            }\n            const file = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"createFile\"])(undefined, {\n                'aux.users': true,\n                'aux.account.username': username,\n                'aux.account.roles': roles,\n            });\n            yield this._tree.addFile(file);\n            return this._tree.value[file.id];\n        });\n    }\n}\n// interface UserLoginInfo {\n//     token: string;\n// }\n//# sourceMappingURL=AuxUserAuthenticator.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthenticator.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthorizer.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthorizer.js ***!
  \***********************************************************************************/
/*! exports provided: AuxUserAuthorizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthorizer\", function() { return AuxUserAuthorizer; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__);\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\n\n\n\n\n\nclass AuxUserAuthorizer {\n    constructor(adminChannel) {\n        this._adminChannel = adminChannel;\n        this._sim = this._adminChannel.simulation;\n        this._sub = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subscription\"]();\n        this._fileToChannelMap = new Map();\n        this._channelMap = new Map();\n        this._channelQueue = new Map();\n        this._globalQueue = [];\n        this._channelUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._channelQueueUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._globalQueueUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._globalInfoUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorSubject\"](null);\n        const context = this._sim.helper.createContext();\n        const globals = this._sim.helper.globalsFile;\n        this._globalInfo = this._calculateGlobal(context, globals);\n        this._sub.add(this._sim.watcher.filesDiscovered\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"tap\"])(file => this._filesAdded(file)))\n            .subscribe());\n        this._sub.add(this._sim.watcher.filesRemoved\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"tap\"])(file => this._filesRemoved(file)))\n            .subscribe());\n        this._sub.add(this._sim.watcher.filesUpdated\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"tap\"])(file => this._filesUpdated(file)))\n            .subscribe());\n    }\n    _filesAdded(files) {\n        const context = this._sim.helper.createContext();\n        for (let file of files) {\n            if (file.id === _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"GLOBALS_FILE_ID\"]) {\n                this._globalInfo = this._calculateGlobal(context, file);\n                this._globalInfoUpdated.next();\n            }\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"isFileInContext\"])(context, file, 'aux.channels')) {\n                const channel = this._calculateChannel(context, file);\n                if (channel.id) {\n                    this._fileToChannelMap.set(file.id, channel);\n                    this._channelMap.set(channel.id, channel);\n                    this._channelUpdated.next(channel.id);\n                }\n            }\n        }\n    }\n    _filesRemoved(ids) {\n        for (let id of ids) {\n            const channel = this._fileToChannelMap.get(id);\n            if (channel) {\n                this._fileToChannelMap.delete(id);\n                this._channelMap.delete(channel.id);\n                this._channelUpdated.next(channel.id);\n            }\n        }\n    }\n    _filesUpdated(files) {\n        const context = this._sim.helper.createContext();\n        for (let file of files) {\n            if (file.id === _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"GLOBALS_FILE_ID\"]) {\n                this._globalInfo = this._calculateGlobal(context, file);\n                this._globalInfoUpdated.next();\n            }\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"isFileInContext\"])(context, file, 'aux.channels')) {\n                const channel = this._fileToChannelMap.get(file.id);\n                if (channel) {\n                    this._fileToChannelMap.delete(file.id);\n                    this._channelMap.delete(channel.id);\n                }\n                const newChannel = this._calculateChannel(context, file);\n                if (newChannel.id) {\n                    this._fileToChannelMap.set(file.id, newChannel);\n                    this._channelMap.set(newChannel.id, newChannel);\n                }\n                if (!channel || newChannel.id === channel.id) {\n                    this._channelUpdated.next(newChannel.id);\n                }\n                else {\n                    this._channelUpdated.next(channel.id);\n                    this._channelUpdated.next(newChannel.id);\n                }\n            }\n            else {\n                const channel = this._fileToChannelMap.get(file.id);\n                if (channel) {\n                    this._fileToChannelMap.delete(file.id);\n                    this._channelMap.delete(channel.id);\n                    this._channelUpdated.next(channel.id);\n                }\n            }\n        }\n    }\n    _calculateChannel(context, file) {\n        return {\n            id: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateFileValue\"])(context, file, 'aux.channel'),\n            locked: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateBooleanTagValue\"])(context, file, 'aux.channel.locked', false),\n            maxUsers: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"getChannelMaxDevicesAllowed\"])(context, file),\n        };\n    }\n    _calculateGlobal(context, file) {\n        return {\n            maxUsers: Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"getMaxDevicesAllowed\"])(context, file),\n        };\n    }\n    isAllowedToLoad(device, info) {\n        if (info.id === 'aux-admin') {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__[\"of\"])(true);\n        }\n        let channelId = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"parseRealtimeChannelId\"])(info.id);\n        let channels = this._channelUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"startWith\"])(channelId), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"filter\"])(id => id === channelId), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"map\"])(id => this._channelMap.get(id)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"map\"])(channel => !!(channel && !channel.locked)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"distinctUntilChanged\"])());\n        return channels;\n    }\n    isAllowedAccess(device, channel) {\n        if (channel.info.type !== 'aux') {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__[\"throwError\"])(new Error('Channel type must be \"aux\"'));\n        }\n        if (!device) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__[\"of\"])(false);\n        }\n        if (this._isAdmin(device)) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__[\"of\"])(true);\n        }\n        if (!this._isUser(device)) {\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__[\"of\"])(false);\n        }\n        const channelId = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"parseRealtimeChannelId\"])(channel.info.id);\n        console.log('Session ID', device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]]);\n        return this._channelUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"startWith\"])(channelId), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"combineLatest\"])(this._channelQueuePosition(device, channelId), this._globalQueuePosition(device), this._globalInfoUpdated, (channelId, channelIndex, globalIndex) => ({\n            channelId,\n            channelIndex,\n            globalIndex,\n        })), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"filter\"])(({ channelId: id }) => id === channelId), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"map\"])((_a) => {\n            var { channelId: id } = _a, other = __rest(_a, [\"channelId\"]);\n            return (Object.assign({ info: this._channelMap.get(id) }, other));\n        }), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"map\"])(({ info, channelIndex, globalIndex }) => this._channelAllowsAccess(device, info, channel, channelIndex, globalIndex)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__[\"distinctUntilChanged\"])());\n    }\n    canProcessEvent(device, event) {\n        return this._isAdmin(device);\n    }\n    _isAdmin(device) {\n        return device.roles.indexOf(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]) >= 0;\n    }\n    _isUser(device) {\n        return device.roles.indexOf(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USER_ROLE\"]) >= 0;\n    }\n    _channelQueuePosition(device, id) {\n        let queue = this._channelQueue.get(id);\n        if (!queue) {\n            queue = [];\n            this._channelQueue.set(id, queue);\n        }\n        const sessionId = device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]];\n        let index = queue.indexOf(sessionId);\n        if (index < 0) {\n            index = queue.length;\n            queue.push(sessionId);\n        }\n        return rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Observable\"].create((observer) => {\n            observer.next(index);\n            const sub = this._channelQueueUpdated.subscribe(() => {\n                let index = queue.indexOf(sessionId);\n                observer.next(index);\n            });\n            sub.add(() => {\n                let index = queue.indexOf(sessionId);\n                if (index >= 0) {\n                    queue.splice(index, 1);\n                    this._channelQueueUpdated.next();\n                }\n            });\n            return sub;\n        });\n    }\n    _globalQueuePosition(device) {\n        let queue = this._globalQueue;\n        const sessionId = device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]];\n        let index = queue.indexOf(sessionId);\n        if (index < 0) {\n            index = queue.length;\n            queue.push(sessionId);\n        }\n        return rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Observable\"].create((observer) => {\n            observer.next(index);\n            const sub = this._globalQueueUpdated.subscribe(() => {\n                let index = queue.indexOf(sessionId);\n                observer.next(index);\n            });\n            sub.add(() => {\n                let index = queue.indexOf(sessionId);\n                if (index >= 0) {\n                    queue.splice(index, 1);\n                    this._globalQueueUpdated.next();\n                }\n            });\n            return sub;\n        });\n    }\n    _channelAllowsAccess(device, channelInfo, channel, channelIndex, globalIndex) {\n        if (this._globalInfo.maxUsers !== null &&\n            globalIndex + 1 > this._globalInfo.maxUsers) {\n            return false;\n        }\n        if (channelInfo) {\n            if (channelInfo.maxUsers !== null &&\n                channelIndex + 1 > channelInfo.maxUsers) {\n                return false;\n            }\n        }\n        else {\n            console.warn('[AuxUserAuthorizer] Not checking channel session limits because there is no file for the channel.');\n        }\n        const sim = channel;\n        const calc = sim.simulation.helper.createContext();\n        const globalsFile = sim.tree.value[_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"GLOBALS_FILE_ID\"]];\n        const username = device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]];\n        if (!globalsFile) {\n            return true;\n        }\n        if (!Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"whitelistOrBlacklistAllowsAccess\"])(calc, globalsFile, username)) {\n            return false;\n        }\n        const whitelist = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"getFileStringList\"])(calc, globalsFile, 'aux.whitelist.roles') || [];\n        const blacklist = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"getFileStringList\"])(calc, globalsFile, 'aux.blacklist.roles') || [];\n        const missingRoles = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"difference\"])(whitelist, device.roles);\n        if (missingRoles.length > 0) {\n            return false;\n        }\n        const bannedRoles = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"intersection\"])(blacklist, device.roles);\n        if (bannedRoles.length > 0) {\n            return false;\n        }\n        return true;\n    }\n}\n//# sourceMappingURL=AuxUserAuthorizer.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthorizer.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/managers/NodeSimulation.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/managers/NodeSimulation.js ***!
  \********************************************************************************/
/*! exports provided: NodeSimulation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NodeSimulation\", function() { return NodeSimulation; });\n/* harmony import */ var _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-vm */ \"./node_modules/@casual-simulation/aux-vm/index.js\");\n/* harmony import */ var _vm_AuxVMNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../vm/AuxVMNode */ \"./node_modules/@casual-simulation/aux-vm-node/vm/AuxVMNode.js\");\n\n\nclass NodeSimulation extends _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_0__[\"BaseSimulation\"] {\n    constructor(channel, id, config) {\n        super(id, config, cfg => new _vm_AuxVMNode__WEBPACK_IMPORTED_MODULE_1__[\"AuxVMNode\"](channel));\n    }\n}\n//# sourceMappingURL=NodeSimulation.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/managers/NodeSimulation.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/managers/index.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/managers/index.js ***!
  \***********************************************************************/
/*! exports provided: NodeSimulation, AuxChannelManagerImpl, AuxUserAuthenticator, AuxUserAuthorizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NodeSimulation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NodeSimulation */ \"./node_modules/@casual-simulation/aux-vm-node/managers/NodeSimulation.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodeSimulation\", function() { return _NodeSimulation__WEBPACK_IMPORTED_MODULE_0__[\"NodeSimulation\"]; });\n\n/* harmony import */ var _AuxChannelManagerImpl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuxChannelManagerImpl */ \"./node_modules/@casual-simulation/aux-vm-node/managers/AuxChannelManagerImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxChannelManagerImpl\", function() { return _AuxChannelManagerImpl__WEBPACK_IMPORTED_MODULE_1__[\"AuxChannelManagerImpl\"]; });\n\n/* harmony import */ var _AuxUserAuthenticator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AuxUserAuthenticator */ \"./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthenticator.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthenticator\", function() { return _AuxUserAuthenticator__WEBPACK_IMPORTED_MODULE_2__[\"AuxUserAuthenticator\"]; });\n\n/* harmony import */ var _AuxUserAuthorizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuxUserAuthorizer */ \"./node_modules/@casual-simulation/aux-vm-node/managers/AuxUserAuthorizer.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxUserAuthorizer\", function() { return _AuxUserAuthorizer__WEBPACK_IMPORTED_MODULE_3__[\"AuxUserAuthorizer\"]; });\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/managers/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/modules/AdminModule.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/modules/AdminModule.js ***!
  \****************************************************************************/
/*! exports provided: AdminModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AdminModule\", function() { return AdminModule; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_4__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n/**\n * Defines an AuxModule that adds Admin-related functionality to the module.\n */\nclass AdminModule {\n    constructor() {\n        this._channelCounts = new Map();\n        this._totalCount = 0;\n    }\n    setup(info, channel) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let sub = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"]();\n            if (isInAdminChannel(info)) {\n                this._adminChannel = channel;\n            }\n            sub.add(channel.onDeviceEvents\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(events => events), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])((event) => __awaiter(this, void 0, void 0, function* () {\n                if (event.event && event.event.type === 'local') {\n                    let local = event.event;\n                    if (local.name === 'say_hello') {\n                        sayHelloTo(event.device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]]);\n                    }\n                    else if (local.name === 'echo') {\n                        yield echo(info, channel, event.device, local);\n                    }\n                    else if (event.device.roles.indexOf(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]) >= 0) {\n                        if (local.name === 'grant_role') {\n                            yield grantRole(info, this._adminChannel, event.device, local);\n                        }\n                        else if (local.name === 'revoke_role') {\n                            yield revokeRole(info, this._adminChannel, event.device, local);\n                        }\n                        else if (local.name === 'shell') {\n                            yield shell(info, this._adminChannel, event.device, local);\n                        }\n                    }\n                    else {\n                        console.log(`[AdminModule] Cannot run event ${local.name} because the user is not an admin.`);\n                    }\n                }\n            })))\n                .subscribe());\n            return sub;\n        });\n    }\n    deviceConnected(info, channel, device) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let channelId = info.id.substring(4);\n            this._totalCount += 1;\n            yield setChannelCount(this._adminChannel, channelId, this._addCount(channelId, 1));\n            yield setTotalCount(this._adminChannel, this._totalCount);\n            return new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"](() => __awaiter(this, void 0, void 0, function* () {\n                const count = this._addCount(channelId, -1);\n                this._totalCount += -1;\n                yield setChannelCount(this._adminChannel, channelId, count);\n                yield setTotalCount(this._adminChannel, this._totalCount);\n            }));\n        });\n    }\n    _addCount(id, amount) {\n        let count = this._channelCounts.get(id);\n        if (!count) {\n            count = 0;\n        }\n        count += amount;\n        this._channelCounts.set(id, count);\n        return count;\n    }\n}\nfunction setTotalCount(channel, count) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const context = channel.helper.createContext();\n        const globals = channel.helper.globalsFile;\n        if (globals) {\n            yield channel.helper.updateFile(globals, {\n                tags: {\n                    'aux.connectedSessions': count,\n                },\n            });\n        }\n    });\n}\nfunction setChannelCount(channel, id, count) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const context = channel.helper.createContext();\n        const file = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getChannelFileById\"])(context, id);\n        if (file) {\n            yield channel.helper.updateFile(file, {\n                tags: {\n                    'aux.channel.connectedSessions': count,\n                },\n            });\n        }\n    });\n}\nfunction grantRole(info, channel, device, event) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let allowed = isInAdminChannel(info) || isGrantValid(channel, device, event.grant);\n        if (!allowed) {\n            return;\n        }\n        const context = channel.helper.createContext();\n        let userFile = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getUserAccountFile\"])(context, event.username);\n        if (!userFile) {\n            const token = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"findMatchingToken\"])(context, context.objects, event.username);\n            if (token) {\n                const username = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"calculateFileValue\"])(context, token, 'aux.token.username');\n                userFile = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getUserAccountFile\"])(context, username);\n            }\n        }\n        if (userFile) {\n            console.log(`[AdminModule] Granting ${event.role} role to ${event.username}.`);\n            const roles = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getFileRoles\"])(context, userFile);\n            const finalRoles = new Set(roles || []);\n            finalRoles.add(event.role);\n            yield channel.helper.updateFile(userFile, {\n                tags: {\n                    'aux.account.roles': [...finalRoles],\n                },\n            });\n        }\n        else {\n            console.log(`[AdminModule] Cannot grant role ${event.role} to user ${event.username} because the user was not found.`);\n        }\n    });\n}\nfunction revokeRole(info, channel, device, event) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let allowed = isInAdminChannel(info) || isGrantValid(channel, device, event.grant);\n        if (!allowed) {\n            return;\n        }\n        const context = channel.helper.createContext();\n        let userFile = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getUserAccountFile\"])(context, event.username);\n        if (!userFile) {\n            const token = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"findMatchingToken\"])(context, context.objects, event.username);\n            if (token) {\n                const username = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"calculateFileValue\"])(context, token, 'aux.token.username');\n                userFile = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getUserAccountFile\"])(context, username);\n            }\n        }\n        if (userFile) {\n            console.log(`[AdminModule] Revoking ${event.role} role from ${event.username}.`);\n            const roles = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getFileRoles\"])(context, userFile);\n            const finalRoles = new Set(roles || []);\n            finalRoles.delete(event.role);\n            yield channel.helper.updateFile(userFile, {\n                tags: {\n                    'aux.account.roles': [...finalRoles],\n                },\n            });\n        }\n        else {\n            console.log(`[AdminModule] Cannot revoke role ${event.role} from user ${event.username} because the user was not found.`);\n        }\n    });\n}\nfunction echo(info, channel, device, event) {\n    return channel.sendEvents([\n        Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"remote\"])(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"action\"])(event.message), {\n            sessionId: device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]],\n        }),\n    ]);\n}\nfunction shell(info, channel, device, event) {\n    console.log(`[AdminModule] Running '${event.script}'...`);\n    return new Promise((resolve, reject) => {\n        Object(child_process__WEBPACK_IMPORTED_MODULE_4__[\"exec\"])(event.script, (err, stdout, stderr) => {\n            if (err) {\n                reject(err);\n            }\n            if (stdout) {\n                console.log(`[Shell] ${stdout}`);\n            }\n            if (stderr) {\n                console.error(`[Shell] ${stderr}`);\n            }\n            resolve();\n        });\n    });\n}\nfunction isInAdminChannel(info) {\n    return info.id === 'aux-admin';\n}\nfunction isGrantValid(channel, device, grant) {\n    if (!grant) {\n        return false;\n    }\n    const context = channel.helper.createContext();\n    const tokens = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"getTokensForUserAccount\"])(context, device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]]);\n    const match = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_3__[\"findMatchingToken\"])(context, tokens, grant);\n    return !!match;\n}\nfunction sayHelloTo(username) {\n    console.log(`User ${username} says \"Hello!\"`);\n}\n//# sourceMappingURL=AdminModule.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/modules/AdminModule.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/modules/index.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/modules/index.js ***!
  \**********************************************************************/
/*! exports provided: AdminModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AdminModule__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AdminModule */ \"./node_modules/@casual-simulation/aux-vm-node/modules/AdminModule.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AdminModule\", function() { return _AdminModule__WEBPACK_IMPORTED_MODULE_0__[\"AdminModule\"]; });\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/modules/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/vm/AuxVMNode.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/vm/AuxVMNode.js ***!
  \*********************************************************************/
/*! exports provided: AuxVMNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxVMNode\", function() { return AuxVMNode; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\nclass AuxVMNode {\n    get localEvents() {\n        return this._localEvents;\n    }\n    get stateUpdated() {\n        return this._stateUpdated;\n    }\n    get connectionStateChanged() {\n        return this._connectionStateChanged;\n    }\n    get onError() {\n        return this._onError;\n    }\n    constructor(channel) {\n        this._channel = channel;\n        this._localEvents = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._stateUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._connectionStateChanged = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onError = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n    }\n    setUser(user) {\n        return this._channel.setUser(user);\n    }\n    setGrant(grant) {\n        return this._channel.setGrant(grant);\n    }\n    sendEvents(events) {\n        return this._channel.sendEvents(events);\n    }\n    formulaBatch(formulas) {\n        return this._channel.formulaBatch(formulas);\n    }\n    search(search) {\n        return this._channel.search(search);\n    }\n    forkAux(newId) {\n        return this._channel.forkAux(newId);\n    }\n    exportFiles(fileIds) {\n        return this._channel.exportFiles(fileIds);\n    }\n    exportTree() {\n        return this._channel.exportTree();\n    }\n    init(loadingCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this._channel.initAndWait(e => this._localEvents.next(e), state => this._stateUpdated.next(state), connection => this._connectionStateChanged.next(connection), err => this._onError.next(err));\n        });\n    }\n    unsubscribe() {\n        this.closed = true;\n        this._channel.unsubscribe();\n    }\n}\n//# sourceMappingURL=AuxVMNode.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/vm/AuxVMNode.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/vm/NodeAuxChannel.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/vm/NodeAuxChannel.js ***!
  \**************************************************************************/
/*! exports provided: NodeAuxChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NodeAuxChannel\", function() { return NodeAuxChannel; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/aux-vm */ \"./node_modules/@casual-simulation/aux-vm/index.js\");\n/* harmony import */ var _casual_simulation_aux_vm_vm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @casual-simulation/aux-vm/vm */ \"./node_modules/@casual-simulation/aux-vm/vm/index.js\");\n/* harmony import */ var _VM2Sandbox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./VM2Sandbox */ \"./node_modules/@casual-simulation/aux-vm-node/vm/VM2Sandbox.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_4__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\nclass NodeAuxChannel extends _casual_simulation_aux_vm__WEBPACK_IMPORTED_MODULE_1__[\"BaseAuxChannel\"] {\n    get remoteEvents() {\n        return this._remoteEvents;\n    }\n    constructor(tree, user, config) {\n        super(user, config);\n        this._tree = tree;\n        this._remoteEvents = new rxjs__WEBPACK_IMPORTED_MODULE_4__[\"Subject\"]();\n    }\n    setGrant(grant) {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    _sendRemoteEvents(events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._remoteEvents.next(events);\n        });\n    }\n    _createRealtimeCausalTree() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"LocalRealtimeCausalTree\"](this._tree);\n        });\n    }\n    _createPrecalculationManager() {\n        const manager = super._createPrecalculationManager();\n        manager.logFormulaErrors = true;\n        return manager;\n    }\n    _createAuxHelper() {\n        const helper = new _casual_simulation_aux_vm_vm__WEBPACK_IMPORTED_MODULE_2__[\"AuxHelper\"](this._aux.tree, this._config.config, lib => Object(_VM2Sandbox__WEBPACK_IMPORTED_MODULE_3__[\"getSandbox\"])(lib));\n        helper.userId = this.user ? this.user.id : null;\n        return helper;\n    }\n    _createGlobalsFile() {\n        const _super = Object.create(null, {\n            _createGlobalsFile: { get: () => super._createGlobalsFile }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            yield _super._createGlobalsFile.call(this);\n            if (this._config.id === 'aux-admin') {\n                const globals = this.helper.globalsFile;\n                yield this.helper.updateFile(globals, {\n                    tags: {\n                        'aux.whitelist.roles': [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]],\n                    },\n                });\n            }\n        });\n    }\n}\n//# sourceMappingURL=NodeAuxChannel.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/vm/NodeAuxChannel.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/vm/VM2Sandbox.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/vm/VM2Sandbox.js ***!
  \**********************************************************************/
/*! exports provided: VM2Sandbox, getSandbox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VM2Sandbox\", function() { return VM2Sandbox; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSandbox\", function() { return getSandbox; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var vm2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! vm2 */ \"vm2\");\n/* harmony import */ var vm2__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(vm2__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lru-cache */ \"lru-cache\");\n/* harmony import */ var lru_cache__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lru_cache__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass VM2Sandbox {\n    constructor(library) {\n        this._transpiler = new _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"Transpiler\"]();\n        this._recursionCounter = 0;\n        this._library = library;\n        this._sandbox = {\n            __getContext__: () => {\n                return this._context;\n            },\n            __getVariables__: () => {\n                return this._finalVars;\n            },\n        };\n        this._script = new vm2__WEBPACK_IMPORTED_MODULE_1__[\"VMScript\"](`\n            var __ctx__ = __getContext__();\n            (function(__code) {\n                let __finalVars__ = __getVariables__();\n                return eval(__code);\n            }).call(__ctx__.thisArg, __ctx__.code);\n        `);\n        this._vm = new vm2__WEBPACK_IMPORTED_MODULE_1__[\"VM\"]({\n            timeout: VM2Sandbox.DEFAULT_TIMEOUT,\n            sandbox: this._sandbox,\n        });\n    }\n    get library() {\n        return this._library;\n    }\n    run(formula, extras, context, variables = {}) {\n        // This works because even though we never decrement\n        // the counter we are recreating the sandbox a lot and that\n        // resets the counter. Overall, this should behave as a\n        // safeguard against infinite loops.\n        if (this._recursionCounter > 1000) {\n            return {\n                success: false,\n                extras: extras,\n                error: new Error('Ran out of energy'),\n                logs: [],\n            };\n        }\n        try {\n            this._recursionCounter += 1;\n            const js = this._transpiler.transpile(formula);\n            const finalVars = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"merge\"])(this._library, variables);\n            this._finalVars = finalVars;\n            const final = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"keys\"])(finalVars)\n                .map(v => `var ${v} = __finalVars__[\"${v}\"];`)\n                .join('\\n') +\n                '\\n' +\n                js;\n            this._context = {\n                code: final,\n                thisArg: context || null,\n            };\n            const result = this._vm.run(this._script);\n            return {\n                result: result,\n                error: null,\n                extras: extras,\n                success: true,\n                logs: [],\n            };\n        }\n        catch (e) {\n            return {\n                success: false,\n                extras: extras,\n                error: e,\n                logs: [],\n            };\n        }\n        finally {\n            this._recursionCounter -= 1;\n        }\n    }\n}\nVM2Sandbox.DEFAULT_TIMEOUT = 100;\nlet cache = new lru_cache__WEBPACK_IMPORTED_MODULE_3___default.a({\n    max: 10,\n});\nfunction getSandbox(lib) {\n    let vm = cache.get(lib);\n    if (!vm) {\n        vm = new VM2Sandbox(lib);\n        cache.set(lib, vm);\n    }\n    return vm;\n}\n//# sourceMappingURL=VM2Sandbox.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/vm/VM2Sandbox.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm-node/vm/index.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm-node/vm/index.js ***!
  \*****************************************************************/
/*! exports provided: VM2Sandbox, getSandbox, NodeAuxChannel, AuxVMNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _VM2Sandbox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VM2Sandbox */ \"./node_modules/@casual-simulation/aux-vm-node/vm/VM2Sandbox.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"VM2Sandbox\", function() { return _VM2Sandbox__WEBPACK_IMPORTED_MODULE_0__[\"VM2Sandbox\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getSandbox\", function() { return _VM2Sandbox__WEBPACK_IMPORTED_MODULE_0__[\"getSandbox\"]; });\n\n/* harmony import */ var _NodeAuxChannel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./NodeAuxChannel */ \"./node_modules/@casual-simulation/aux-vm-node/vm/NodeAuxChannel.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodeAuxChannel\", function() { return _NodeAuxChannel__WEBPACK_IMPORTED_MODULE_1__[\"NodeAuxChannel\"]; });\n\n/* harmony import */ var _AuxVMNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AuxVMNode */ \"./node_modules/@casual-simulation/aux-vm-node/vm/AuxVMNode.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxVMNode\", function() { return _AuxVMNode__WEBPACK_IMPORTED_MODULE_2__[\"AuxVMNode\"]; });\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm-node/vm/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/index.js ***!
  \*********************************************************/
/*! exports provided: SimulationManager, BaseHelper, FileHelper, FileWatcher, ConnectionManager, DependencyManager, PrecalculationManager, LoginManager, ProgressManager, BaseSimulation, AuxHelper, BaseAuxChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _managers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./managers */ \"./node_modules/@casual-simulation/aux-vm/managers/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimulationManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"SimulationManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseHelper\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"BaseHelper\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FileHelper\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"FileHelper\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FileWatcher\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"FileWatcher\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ConnectionManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"ConnectionManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DependencyManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"DependencyManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PrecalculationManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"PrecalculationManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LoginManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"LoginManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ProgressManager\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"ProgressManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseSimulation\", function() { return _managers__WEBPACK_IMPORTED_MODULE_0__[\"BaseSimulation\"]; });\n\n/* harmony import */ var _vm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vm */ \"./node_modules/@casual-simulation/aux-vm/vm/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxHelper\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"AuxHelper\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseAuxChannel\", function() { return _vm__WEBPACK_IMPORTED_MODULE_1__[\"BaseAuxChannel\"]; });\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js ***!
  \***********************************************************************/
/*! exports provided: BaseHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BaseHelper\", function() { return BaseHelper; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n\n/**\n * Defines a base class for file helper-like managers.\n */\nclass BaseHelper {\n    /**\n     * Creates a new file helper.\n     * @param userFileId The ID of the user's file.\n     */\n    constructor() {\n        this._userId = null;\n    }\n    /**\n     * Gets the ID of the user's file.\n     */\n    get userId() {\n        return this._userId;\n    }\n    /**\n     * Sets the ID of the user's file.\n     */\n    set userId(id) {\n        this._userId = id;\n    }\n    /**\n     * Gets all the files that represent an object.\n     */\n    get objects() {\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"getActiveObjects\"])(this.filesState);\n    }\n    /**\n     * Gets the file for the current user.\n     */\n    get userFile() {\n        if (!this._userId) {\n            return null;\n        }\n        if (!this.filesState) {\n            return null;\n        }\n        return this.filesState[this._userId];\n    }\n    /**\n     * Gets the globals file for the simulation.\n     */\n    get globalsFile() {\n        if (!this.filesState) {\n            return null;\n        }\n        return this.filesState[_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"GLOBALS_FILE_ID\"]];\n    }\n}\n//# sourceMappingURL=BaseHelper.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/BaseSimulation.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/BaseSimulation.js ***!
  \***************************************************************************/
/*! exports provided: BaseSimulation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BaseSimulation\", function() { return BaseSimulation; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _FileHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FileHelper */ \"./node_modules/@casual-simulation/aux-vm/managers/FileHelper.js\");\n/* harmony import */ var _FileWatcher__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./FileWatcher */ \"./node_modules/@casual-simulation/aux-vm/managers/FileWatcher.js\");\n/* harmony import */ var _ConnectionManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ConnectionManager */ \"./node_modules/@casual-simulation/aux-vm/managers/ConnectionManager.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\n/**\n * Defines a class that interfaces with an AUX VM to reactively edit files.\n */\nclass BaseSimulation {\n    /**\n     * Gets the ID of the simulation that is currently being used.\n     */\n    get id() {\n        return this._originalId;\n    }\n    /**\n     * Gets the parsed ID of the simulation.\n     */\n    get parsedId() {\n        return this._parsedId;\n    }\n    set parsedId(id) {\n        this._parsedId = id;\n    }\n    /**\n     * Gets whether the app is connected to the server but may\n     * or may not be synced to the serer.\n     */\n    get isOnline() {\n        // return this._aux.channel.isConnected;\n        return false;\n    }\n    /**\n     * Gets whether the app is synced to the server.\n     */\n    get isSynced() {\n        return this.isOnline;\n    }\n    /**\n     * Gets the file helper.\n     */\n    get helper() {\n        return this._helper;\n    }\n    /**\n     * Gets the file watcher.\n     */\n    get watcher() {\n        return this._watcher;\n    }\n    get connection() {\n        return this._connection;\n    }\n    get localEvents() {\n        return this._vm.localEvents.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(e => e));\n    }\n    get onError() {\n        return this._vm.onError;\n    }\n    /**\n     * Creates a new simulation for the given user and channel ID.\n     * @param user The user.\n     * @param id The ID of the channel.\n     * @param config The channel config.\n     * @param createVm The factory function to use for creating an AUX VM.\n     */\n    constructor(id, config, createVm) {\n        this._originalId = id || 'default';\n        this._parsedId = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"parseSimulationId\"])(this._originalId);\n        this._id = this._getTreeName(this._parsedId.channel);\n        this._config = config;\n        this._vm = createVm({\n            config: config,\n            host: this._parsedId.host,\n            id: id,\n            treeName: this._id,\n        });\n        this._helper = new _FileHelper__WEBPACK_IMPORTED_MODULE_3__[\"FileHelper\"](this._vm);\n        this._connection = new _ConnectionManager__WEBPACK_IMPORTED_MODULE_5__[\"ConnectionManager\"](this._vm);\n    }\n    /**\n     * Initializes the file manager to connect to the session with the given ID.\n     * @param id The ID of the session to connect to.\n     */\n    init() {\n        console.log('[FileManager] init');\n        return this._init();\n    }\n    // TODO: This seems like a pretty dangerous function to keep around,\n    // but we'll add a config option to prevent this from happening on real sites.\n    deleteEverything() {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.warn('[FileManager] Delete Everything!');\n            const state = this.helper.filesState;\n            const fileIds = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"keys\"])(state);\n            const files = fileIds.map(id => state[id]);\n            const nonUserOrGlobalFiles = files.filter(f => !f.tags['aux._user'] && f.id !== _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"GLOBALS_FILE_ID\"]);\n            const deleteOps = nonUserOrGlobalFiles.map(f => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"fileRemoved\"])(f.id));\n            yield this.helper.transaction(...deleteOps);\n        });\n    }\n    /**\n     * Forks the current session's aux into the given session ID.\n     * @param forkName The ID of the new session.\n     */\n    forkAux(forkName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const id = this._getTreeName(forkName);\n            console.log('[FileManager] Making fork', forkName);\n            yield this._vm.forkAux(id);\n            console.log('[FileManager] Fork finished.');\n        });\n    }\n    exportFiles(fileIds) {\n        return this._vm.exportFiles(fileIds);\n    }\n    /**\n     * Exports the causal tree for the simulation.\n     */\n    exportTree() {\n        return this._vm.exportTree();\n    }\n    _getTreeName(id) {\n        return id ? `aux-${id}` : 'aux-default';\n    }\n    _init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._errored) {\n                throw new Error('Unable to initialize.');\n            }\n            this._setStatus('Starting...');\n            this._subscriptions = [this._vm];\n            // FileWatcher should be initialized before the VM\n            // so that it is already listening for any events that get emitted\n            // during initialization.\n            this._initFileWatcher();\n            this._subscriptions.push(this._vm.connectionStateChanged.subscribe(s => {\n                if (s.type === 'message') {\n                    console.log(`[${s.source}] ${s.message}`);\n                }\n            }));\n            yield this._vm.init();\n            this._initManagers();\n            this._setStatus('Initialized.');\n        });\n    }\n    _initFileWatcher() {\n        this._watcher = new _FileWatcher__WEBPACK_IMPORTED_MODULE_4__[\"FileWatcher\"](this._helper, this._vm.stateUpdated);\n    }\n    _initManagers() { }\n    _setStatus(status) {\n        this._status = status;\n        console.log('[BaseSimulation] Status:', status);\n    }\n    unsubscribe() {\n        this._setStatus('Dispose');\n        this.closed = true;\n        this._subscriptions.forEach(s => s.unsubscribe());\n        this._subscriptions = [];\n    }\n}\n//# sourceMappingURL=BaseSimulation.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/BaseSimulation.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/ConnectionManager.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/ConnectionManager.js ***!
  \******************************************************************************/
/*! exports provided: ConnectionManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ConnectionManager\", function() { return ConnectionManager; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n/**\n * Defines a class that manages the connection status to the server.\n */\nclass ConnectionManager {\n    get forcedOffline() {\n        return this._forcedOffline;\n    }\n    get connectionStateChanged() {\n        return this._connectionStateChanged;\n    }\n    get syncStateChanged() {\n        return this._syncStateChanged;\n    }\n    toggleForceOffline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._forcedOffline = !this._forcedOffline;\n            yield this._vm.sendEvents([Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"setForcedOffline\"])(this._forcedOffline)]);\n        });\n    }\n    constructor(vm) {\n        this._vm = vm;\n        this._forcedOffline = false;\n        this._connectionStateChanged = this._vm.connectionStateChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"scan\"])((acc, curr) => curr.type === 'connection' ? curr.connected : acc, false), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"distinctUntilChanged\"])(), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"shareReplay\"])(1));\n        this._syncStateChanged = this._vm.connectionStateChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"scan\"])((acc, curr) => {\n            if (curr.type === 'sync') {\n                return Object.assign({}, acc, { synced: curr.synced });\n            }\n            else if (curr.type === 'init') {\n                return Object.assign({}, acc, { init: true });\n            }\n            return acc;\n        }, { synced: false, init: false }), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"skipWhile\"])(a => !a.init), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(a => a.synced), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"distinctUntilChanged\"])(), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"shareReplay\"])(1));\n        this._sub = this._connectionStateChanged.subscribe();\n        this._sub.add(this._syncStateChanged.subscribe());\n    }\n    unsubscribe() {\n        this._sub.unsubscribe();\n    }\n    get closed() {\n        return this._sub.closed;\n    }\n}\n//# sourceMappingURL=ConnectionManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/ConnectionManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/DependencyManager.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/DependencyManager.js ***!
  \******************************************************************************/
/*! exports provided: DependencyManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DependencyManager\", function() { return DependencyManager; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * Defines a class that is able to track dependencies between files.\n */\nclass DependencyManager {\n    constructor() {\n        this._tagMap = new Map();\n        this._fileMap = new Map();\n        this._fileIdMap = new Map();\n        this._dependencyMap = new Map();\n        this._dependentMap = new Map();\n        this._allMap = {};\n        this._dependencies = new _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"Dependencies\"]();\n    }\n    /**\n     * Adds the given file and returns an object that contains the list of files and tags taht were affected by the update.\n     * @param updates The updates.\n     */\n    addFiles(files) {\n        if (!files || files.length === 0) {\n            return {};\n        }\n        const results = files.map(f => this.addFile(f));\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(results, (first, second) => this._mergeDependents(first, second));\n    }\n    /**\n     * Adds the given file to the dependency manager for tracking and returns an object that represents which files and tags were affected by the update.\n     * @param file The file to add.\n     */\n    addFile(file) {\n        const tags = ['id', ...Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"tagsOnFile\"])(file)];\n        let deps = {};\n        const dependents = tags.map(t => this.getDependents(t));\n        const updates = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(dependents, (first, second) => this._mergeDependents(first, second)) || {};\n        for (let tag of tags) {\n            const val = file.tags[tag];\n            if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"isFormula\"])(val)) {\n                let formulaDependencies = this._dependencies.calculateAuxDependencies(val);\n                deps[tag] = formulaDependencies;\n                this._addTagDependents(formulaDependencies, tag, file);\n            }\n            let arr = this._tagMap.get(tag);\n            if (arr) {\n                arr.push(file.id);\n            }\n            else {\n                this._tagMap.set(tag, [file.id]);\n            }\n        }\n        this._dependencyMap.set(file.id, deps);\n        this._fileMap.set(file.id, tags);\n        this._fileIdMap.set(file.id, file);\n        return updates;\n    }\n    /**\n     * Removes the given files from the dependency manager and returns an object that contains the list of files and tags taht were affected by the update.\n     * @param updates The updates.\n     */\n    removeFiles(fileIds) {\n        if (!fileIds || fileIds.length === 0) {\n            return {};\n        }\n        const results = fileIds.map(id => this.removeFile(id));\n        const result = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(results, (first, second) => this._mergeDependents(first, second));\n        for (let id in result) {\n            if (fileIds.indexOf(id) >= 0) {\n                delete result[id];\n            }\n        }\n        return result;\n    }\n    /**\n     * Removes the given file from the dependency manager and returns an object that represents which files and tags were affected by the update.\n     * @param file The file to remove.\n     */\n    removeFile(fileId) {\n        const tags = this._fileMap.get(fileId);\n        if (tags) {\n            this._fileIdMap.delete(fileId);\n            this._fileMap.delete(fileId);\n            const dependencies = this.getDependencies(fileId);\n            if (dependencies) {\n                // TODO: Cleanup\n                // This code is pretty ugly\n                for (let tag in dependencies) {\n                    this._removeTagDependents(dependencies, tag, fileId);\n                }\n            }\n            this._dependencyMap.delete(fileId);\n            for (let tag of tags) {\n                let ids = this._tagMap.get(tag);\n                if (ids) {\n                    const index = ids.indexOf(fileId);\n                    if (index >= 0) {\n                        ids.splice(index, 1);\n                    }\n                }\n            }\n            const dependents = tags.map(t => this.getDependents(t));\n            const updates = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(dependents, (first, second) => this._mergeDependents(first, second));\n            return updates;\n        }\n        return {};\n    }\n    /**\n     * Processes the given file updates and returns an object that contains the list of files and tags taht were affected by the update.\n     * @param updates The updates.\n     */\n    updateFiles(updates) {\n        if (!updates || updates.length === 0) {\n            return {};\n        }\n        const results = updates.map(u => this.updateFile(u));\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(results, (first, second) => this._mergeDependents(first, second));\n    }\n    /**\n     * Processes the given file update and returns an object that contains the list of files and tags that were affected by the update.\n     * @param update The update.\n     */\n    updateFile(update) {\n        this._fileIdMap.set(update.file.id, update.file);\n        const tags = this._fileMap.get(update.file.id);\n        if (tags) {\n            // ID never updates so we don't need to include it.\n            const fileTags = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"tagsOnFile\"])(update.file);\n            tags.splice(0, tags.length, ...fileTags);\n            const dependencies = this.getDependencies(update.file.id);\n            for (let tag of update.tags) {\n                const files = this._tagMap.get(tag);\n                const val = update.file.tags[tag];\n                if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"hasValue\"])(val)) {\n                    if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"isFormula\"])(val)) {\n                        let formulaDependencies = this._dependencies.calculateAuxDependencies(val);\n                        if (dependencies[tag]) {\n                            this._removeTagDependents(dependencies, tag, update.file.id);\n                        }\n                        dependencies[tag] = formulaDependencies;\n                        this._addTagDependents(formulaDependencies, tag, update.file);\n                    }\n                    if (files) {\n                        const index = files.indexOf(update.file.id);\n                        if (index < 0) {\n                            files.push(update.file.id);\n                        }\n                    }\n                    else {\n                        this._tagMap.set(tag, [update.file.id]);\n                    }\n                }\n                else {\n                    if (dependencies[tag]) {\n                        this._removeTagDependents(dependencies, tag, update.file.id);\n                    }\n                    delete dependencies[tag];\n                    if (files) {\n                        const index = files.indexOf(update.file.id);\n                        if (index >= 0) {\n                            files.splice(index, 1);\n                        }\n                    }\n                }\n            }\n            const updates = this._mergeDependents({\n                [update.file.id]: new Set(update.tags),\n            }, this._resolveDependencies(update));\n            return updates;\n        }\n        else {\n            console.warn('[DependencyManager] Trying to update file before it was added!');\n        }\n        return {};\n    }\n    _resolveDependencies(update) {\n        const dependents = update.tags.map(t => this.getDependents(t, update.file.id));\n        const updates = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(dependents, (first, second) => this._mergeDependents(first, second));\n        return this._deepDependencies(update.tags, updates, 0);\n    }\n    _deepDependencies(tags, update, depth) {\n        // TODO: Put in max depth variable\n        if (depth > 10) {\n            return update;\n        }\n        let finalUpdate = update;\n        let deepTags = [];\n        for (let key in update) {\n            const fileTags = [...update[key]];\n            const dependents = fileTags.map(t => this.getDependents(t, key));\n            for (let dep of dependents) {\n                for (let tag in dep) {\n                    deepTags.push(tag);\n                }\n            }\n            finalUpdate = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(dependents, (first, second) => this._mergeDependents(first, second), finalUpdate);\n        }\n        let hasNewTags = false;\n        for (let tag of deepTags) {\n            if (tags.indexOf(tag) < 0) {\n                hasNewTags = true;\n                break;\n            }\n        }\n        if (!hasNewTags) {\n            return update;\n        }\n        const tagsArray = [...deepTags];\n        const dependents = tagsArray.map(t => this.getDependents(t));\n        const updates = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"reduce\"])(dependents, (first, second) => this._mergeDependents(first, second), update);\n        return this._deepDependencies(tagsArray, updates, depth + 1);\n    }\n    _dependentTags(update) {\n        let tags = [];\n        for (let key in update) {\n            const fileTags = update[key];\n            tags.push(...fileTags);\n        }\n        return new Set(tags);\n    }\n    /**\n     * Gets the list of dependencies that the given file ID has.\n     * @param id The ID of the file.\n     */\n    getDependencies(id) {\n        return this._dependencyMap.get(id);\n    }\n    /**\n     * Gets the list of files that would be affected by a change to the given tag.\n     * @param tag The tag to search for.\n     * @param id The optional file ID to search for.\n     */\n    getDependents(tag, id) {\n        let general = this._dependentMap.get(tag);\n        if (id) {\n            const file = this._dependentMap.get(`${id}:${tag}`);\n            general = this._mergeDependents(general, file);\n        }\n        general = this._mergeDependents(general, this._allMap);\n        return general || {};\n    }\n    _mergeDependents(general, file) {\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"mergeWith\"])(general, file, (first, second) => {\n            if (first instanceof Set && second instanceof Set) {\n                return new Set([...first, ...second]);\n            }\n        });\n    }\n    /**\n     * Gets a map from tag names to files that contain values for those tags.\n     */\n    getTagMap() {\n        return this._tagMap;\n    }\n    /**\n     * Gets a map of file IDs to the list of tags that the file has.\n     */\n    getFileMap() {\n        return this._fileMap;\n    }\n    /**\n     * Gets the map of tag names to a hash of files that are dependent on the tag.\n     */\n    getDependentMap() {\n        return this._dependentMap;\n    }\n    _getTagDependents(tag) {\n        let dependents = this._dependentMap.get(tag);\n        if (!dependents) {\n            dependents = {};\n            this._dependentMap.set(tag, dependents);\n        }\n        return dependents;\n    }\n    _getFileDependents(tag, id) {\n        const dependents = this._getTagDependents(tag);\n        let fileDependents = dependents[id];\n        if (!fileDependents) {\n            fileDependents = new Set();\n            dependents[id] = fileDependents;\n        }\n        return fileDependents;\n    }\n    _addTagDependents(formulaDependencies, tag, file) {\n        for (let dep of formulaDependencies) {\n            // TODO: Support \"this\" dependencies\n            if (dep.type !== 'all' && dep.type !== 'this') {\n                const fileDeps = this._getFileDependents(dep.name, file.id);\n                fileDeps.add(tag);\n            }\n            else if (dep.type === 'all') {\n                const tags = this._allMap[file.id];\n                if (tags) {\n                    tags.add(tag);\n                }\n                else {\n                    this._allMap[file.id] = new Set([tag]);\n                }\n            }\n        }\n    }\n    /**\n     * Removes all the dependents for the given file dependencies and returns\n     * @param dependencies\n     * @param tag\n     * @param fileId\n     */\n    _removeTagDependents(dependencies, tag, fileId) {\n        const deps = dependencies[tag];\n        for (let dep of deps) {\n            if (dep.type !== 'all' && dep.type !== 'this') {\n                const tagDeps = this._dependentMap.get(dep.name);\n                if (tagDeps) {\n                    let fileDeps = tagDeps[fileId];\n                    if (fileDeps) {\n                        fileDeps.delete(tag);\n                        if (fileDeps.size === 0) {\n                            delete tagDeps[fileId];\n                        }\n                    }\n                }\n            }\n            else if (dep.type === 'all') {\n                const tags = this._allMap[fileId];\n                if (tags) {\n                    tags.delete(tag);\n                    if (tags.size === 0) {\n                        delete this._allMap[fileId];\n                    }\n                }\n            }\n        }\n    }\n}\n//# sourceMappingURL=DependencyManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/DependencyManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/FileHelper.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/FileHelper.js ***!
  \***********************************************************************/
/*! exports provided: FileHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FileHelper\", function() { return FileHelper; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _BaseHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BaseHelper */ \"./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n/**\n * Defines an class that contains a simple set of functions\n * that help manipulate files.\n */\nclass FileHelper extends _BaseHelper__WEBPACK_IMPORTED_MODULE_2__[\"BaseHelper\"] {\n    /**\n     * Creates a new file helper.\n     * @param tree The tree that the file helper should use.\n     * @param userFileId The ID of the user's file.\n     */\n    constructor(vm) {\n        super();\n        this._vm = vm;\n    }\n    /**\n     * Gets the current local file state.\n     */\n    get filesState() {\n        return this._state;\n    }\n    /**\n     * Sets the current local file state.\n     */\n    set filesState(state) {\n        this._state = state;\n    }\n    /**\n     * Gets the observable list of local events that have been processed by this file helper.\n     */\n    // get localEvents(): Observable<LocalEvents> {\n    //     return this._localEvents;\n    // }\n    /**\n     * Creates a FileCalculationContext.\n     */\n    createContext() {\n        return {\n            objects: this.objects,\n        };\n    }\n    /**\n     * Updates the given file with the given data.\n     * @param file The file.\n     * @param newData The new data that the file should have.\n     */\n    updateFile(file, newData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.transaction(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"fileUpdated\"])(file.id, newData));\n        });\n    }\n    /**\n     * Creates a new file with the given ID and tags. Returns the ID of the new file.\n     * @param id (Optional) The ID that the file should have.\n     * @param tags (Optional) The tags that the file should have.\n     */\n    createFile(id, tags) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (FileHelper._debug) {\n                console.log('[FileManager] Create File');\n            }\n            const file = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createFile\"])(id, tags);\n            yield this._vm.sendEvents([Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"fileAdded\"])(file)]);\n            return file.id;\n        });\n    }\n    /**\n     * Creates a new workspace file.\n     * @param fileId The ID of the file to create. If not specified a new ID will be generated.\n     * @param builderContextId The ID of the context to create for the file. If not specified a new context ID will be generated.\n     * @param locked Whether the context should be accessible in AUX Player.\n     */\n    createWorkspace(fileId, builderContextId, locked, visible, x, y) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (FileHelper._debug) {\n                console.log('[FileManager] Create Workspace');\n            }\n            const workspace = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createWorkspace\"])(fileId, builderContextId, locked);\n            let visType;\n            if (visible) {\n                visType = 'surface';\n            }\n            else {\n                visType = false;\n            }\n            const updated = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"merge\"])(workspace, {\n                tags: {\n                    'aux.context.x': x || 0,\n                    'aux.context.y': y || 0,\n                    'aux.aux.context.x.visualize': visType || false,\n                },\n            });\n            yield this._vm.sendEvents([Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"fileAdded\"])(updated)]);\n            // await this._tree.addFile(updated);\n            return this.filesState[workspace.id];\n        });\n    }\n    /**\n     * Creates a new file for the current user that loads the simulation with the given ID.\n     * @param id The ID of the simulation to load.\n     * @param fileId The ID of the file to create.\n     */\n    createSimulation(id, fileId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const simFiles = this.getSimulationFiles(id);\n            if (simFiles.length === 0) {\n                yield this.createFile(fileId, {\n                    [this.userFile.tags['aux._userSimulationsContext']]: true,\n                    ['aux.channel']: id,\n                });\n            }\n        });\n    }\n    /**\n     * Gets the list of files that are loading the simulation with the given ID.\n     * @param id The ID of the simulation.\n     */\n    getSimulationFiles(id) {\n        const calc = this.createContext();\n        const simFiles = this._getSimulationFiles(calc, id);\n        return simFiles;\n    }\n    /**\n     * Deletes all the files in the current user's simulation context that load the given simulation ID.\n     * @param id The ID of the simulation to load.\n     */\n    destroySimulations(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const calc = this.createContext();\n            const simFiles = this._getSimulationFiles(calc, id);\n            const events = Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"flatMap\"])(simFiles, f => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateDestroyFileEvents\"])(calc, f));\n            yield this.transaction(...events);\n        });\n    }\n    /**\n     * Deletes the given file.\n     * @param file The file to delete.\n     */\n    destroyFile(file) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const calc = this.createContext();\n            const events = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateDestroyFileEvents\"])(calc, file);\n            yield this.transaction(...events);\n        });\n    }\n    /**\n     * Runs the given formulas in a batch.\n     * @param formulas The formulas to run.\n     */\n    formulaBatch(formulas) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (FileHelper._debug) {\n                console.log('[FileManager] Run formula:', formulas);\n            }\n            yield this._vm.formulaBatch(formulas);\n        });\n    }\n    /**\n     * Runs the given actions in a batch.\n     * @param actions The actions to run.\n     */\n    actions(actions) {\n        return actions.map(b => {\n            const fileIds = b.files ? b.files.map(f => f.id) : null;\n            const actionData = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"action\"])(b.eventName, fileIds, this.userId, b.arg);\n            return actionData;\n        });\n    }\n    /**\n     * Runs the given event on the given files.\n     * @param eventName The name of the event to run.\n     * @param files The files that should be searched for handlers for the event name.\n     * @param arg The argument that should be passed to the event handlers.\n     */\n    action(eventName, files, arg) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const fileIds = files ? files.map(f => f.id) : null;\n            const actionData = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"action\"])(eventName, fileIds, this.userId, arg);\n            yield this._vm.sendEvents([actionData]);\n        });\n    }\n    /**\n     * Adds the given events in a transaction.\n     * That is, they should be performed in a batch.\n     * @param events The events to run.\n     */\n    transaction(...events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._vm.sendEvents(events);\n            // await this._tree.addEvents(events);\n            // this._sendLocalEvents(events);\n        });\n    }\n    /**\n     * Adds the given state to the current file state.\n     * @param state The state to add.\n     */\n    addState(state) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._vm.sendEvents([Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"addState\"])(state)]);\n            // await this._tree.addEvents([]);\n        });\n    }\n    /**\n     * Calculates the nicely formatted value for the given file and tag.\n     * @param file The file to calculate the value for.\n     * @param tag The tag to calculate the value for.\n     */\n    calculateFormattedFileValue(file, tag) {\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateFormattedFileValue\"])(this.createContext(), file, tag);\n    }\n    /**\n     * Calculates the value of the tag on the given file.\n     * @param file The file.\n     * @param tag The tag to calculate the value of.\n     */\n    calculateFileValue(file, tag) {\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateFileValue\"])(this.createContext(), file, tag);\n    }\n    /**\n     * Sets the file that the user is editing.\n     * @param file The file.\n     */\n    setEditingFile(file) {\n        return this.updateFile(this.userFile, {\n            tags: {\n                'aux._editingFile': file.id,\n            },\n        });\n    }\n    search(search) {\n        return this._vm.search(search);\n    }\n    /**\n     * Gets the list of simulation files that are in the current user's simulation context.\n     * @param id The ID of the simulation to search for.\n     */\n    _getSimulationFiles(calc, id) {\n        // TODO: Make these functions support precalculated file contexts\n        const simFiles = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"filesInContext\"])(calc, this.userFile.tags['aux._userSimulationsContext']).filter(f => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"getFileChannel\"])(calc, f) === id);\n        return simFiles;\n    }\n}\nFileHelper._debug = false;\n//# sourceMappingURL=FileHelper.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/FileHelper.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/FileWatcher.js":
/*!************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/FileWatcher.js ***!
  \************************************************************************/
/*! exports provided: FileWatcher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FileWatcher\", function() { return FileWatcher; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n/**\n * Defines a class that can watch a realtime causal tree.\n */\nclass FileWatcher {\n    /**\n     * Creates a new file watcher.\n     * @param helper The file helper.\n     * @param selection The selection manager.\n     * @param filesAdded The observable that is called whenever a new file is added.\n     * @param filesRemoved The observable that is called whenever a file is removed.\n     * @param filesUpdated The observable that is called whenever a file is updated.\n     */\n    constructor(helper, stateUpdated) {\n        this._subs = [];\n        this.closed = false;\n        this._helper = helper;\n        this._filesDiscoveredObservable = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._filesRemovedObservable = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._filesUpdatedObservable = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._subs.push(stateUpdated\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(update => {\n            if (this._helper.filesState) {\n                let updatedState = Object(lodash__WEBPACK_IMPORTED_MODULE_3__[\"omitBy\"])(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"merge\"])(this._helper.filesState, update.state), val => val === null);\n                for (let id in update.state) {\n                    let fileUpdate = update.state[id];\n                    if (!fileUpdate) {\n                        continue;\n                    }\n                    let file = updatedState[id];\n                    for (let tag in fileUpdate.tags) {\n                        if (file.tags[tag] === null) {\n                            delete file.tags[tag];\n                            delete file.values[tag];\n                        }\n                    }\n                }\n                this._helper.filesState = updatedState;\n            }\n            else {\n                this._helper.filesState = update.state;\n            }\n        }))\n            .subscribe(update => {\n            const added = update.addedFiles.map(id => this._helper.filesState[id]);\n            const updated = update.updatedFiles.map(id => this._helper.filesState[id]);\n            this._filesDiscoveredObservable.next(added);\n            this._filesRemovedObservable.next(update.removedFiles);\n            this._filesUpdatedObservable.next(updated);\n        }, err => console.error(err)));\n    }\n    /**\n     * Gets an observable that resolves whenever a new file is discovered.\n     * That is, it was created or added by another user.\n     */\n    get filesDiscovered() {\n        return this._filesDiscoveredObservable.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"startWith\"])(Object(lodash__WEBPACK_IMPORTED_MODULE_3__[\"values\"])(this._helper.filesState)));\n    }\n    /**\n     * Gets an observable that resolves whenever a file is removed.\n     * That is, it was deleted from the working directory either by checking out a\n     * branch that does not contain the file or by deleting it.\n     */\n    get filesRemoved() {\n        return this._filesRemovedObservable;\n    }\n    /**\n     * Gets an observable that resolves whenever a file is updated.\n     */\n    get filesUpdated() {\n        return this._filesUpdatedObservable;\n    }\n    /**\n     * Creates an observable that resolves whenever the file with the given ID changes.\n     * @param file The file ID to watch.\n     */\n    fileChanged(id) {\n        const file = this._helper.filesState\n            ? this._helper.filesState[id]\n            : null;\n        return this.filesUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(files => files), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"takeUntil\"])(this.filesRemoved.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])(fileIds => fileIds), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"first\"])(fileId => fileId === id))), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(u => u.id === id), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"startWith\"])(file), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(f => !!f), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"endWith\"])(null));\n    }\n    unsubscribe() {\n        if (!this.closed) {\n            this.closed = true;\n            this._subs.forEach(s => s.unsubscribe());\n            this._subs = null;\n        }\n    }\n}\n//# sourceMappingURL=FileWatcher.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/FileWatcher.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/LoginManager.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/LoginManager.js ***!
  \*************************************************************************/
/*! exports provided: LoginManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LoginManager\", function() { return LoginManager; });\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * Defines a class that is able to help manage the login state of a simulation.\n */\nclass LoginManager {\n    get loginStateChanged() {\n        return this._loginStateChanged;\n    }\n    get userChanged() {\n        return this._userChanged;\n    }\n    get deviceChanged() {\n        return this._deviceChanged;\n    }\n    /**\n     * Sets the grant that the user should use.\n     * @param grant The grant.\n     */\n    setGrant(grant) {\n        return this._vm.setGrant(grant);\n    }\n    setUser(user) {\n        return this._vm.setUser(user);\n    }\n    constructor(vm) {\n        this._vm = vm;\n        this._loginStateChanged = this._vm.connectionStateChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"scan\"])((acc, update) => {\n            if (update.type === 'authentication') {\n                return Object.assign({}, acc, { authenticated: update.authenticated, authenticationError: update.reason, user: update.user, info: update.info, authorized: null });\n            }\n            else if (update.type === 'authorization' &&\n                acc.authorized !== update.authorized) {\n                return Object.assign({}, acc, { authorized: update.authorized, authorizationError: update.reason });\n            }\n            return acc;\n        }, { authenticated: false, authorized: null }), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"startWith\"])({ authenticated: false, authorized: null }), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"distinctUntilChanged\"])(), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"shareReplay\"])(1));\n        this._userChanged = this._loginStateChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(state => state.user || null), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"distinctUntilChanged\"])());\n        this._deviceChanged = this._loginStateChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"map\"])(state => state.info || null), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_0__[\"distinctUntilChanged\"])());\n        this._sub = this._loginStateChanged.subscribe();\n        this._sub.add(this._userChanged.subscribe());\n        this._sub.add(this._deviceChanged.subscribe());\n    }\n    unsubscribe() {\n        this._sub.unsubscribe();\n    }\n    get closed() {\n        return this._sub.closed;\n    }\n}\n//# sourceMappingURL=LoginManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/LoginManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/PrecalculationManager.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/PrecalculationManager.js ***!
  \**********************************************************************************/
/*! exports provided: PrecalculationManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PrecalculationManager\", function() { return PrecalculationManager; });\n/* harmony import */ var _DependencyManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DependencyManager */ \"./node_modules/@casual-simulation/aux-vm/managers/DependencyManager.js\");\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n/**\n * Defines a class that manages precalculating file state.\n */\nclass PrecalculationManager {\n    constructor(stateGetter, contextFactory) {\n        /**\n         * Whether errors from formulas should be logged.\n         */\n        this.logFormulaErrors = false;\n        this._stateGetter = stateGetter;\n        this._contextFactory = contextFactory;\n        this._currentState = {};\n        this._dependencies = new _DependencyManager__WEBPACK_IMPORTED_MODULE_0__[\"DependencyManager\"]();\n    }\n    get filesState() {\n        return this._currentState;\n    }\n    filesAdded(files) {\n        const updated = this._dependencies.addFiles(files);\n        const context = this._contextFactory();\n        let nextState = {};\n        for (let file of files) {\n            nextState[file.id] = {\n                id: file.id,\n                precalculated: true,\n                tags: file.tags,\n                values: Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"mapValues\"])(file.tags, (value, tag) => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateCopiableValue\"])(context, file, tag, value)),\n            };\n        }\n        this._updateFiles(updated, context, nextState);\n        this._currentState = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"omitBy\"])(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"merge\"])(this._currentState, nextState), val => val === null);\n        return {\n            state: nextState,\n            addedFiles: files.map(f => f.id),\n            removedFiles: [],\n            updatedFiles: Object.keys(updated),\n        };\n    }\n    filesRemoved(fileIds) {\n        const updated = this._dependencies.removeFiles(fileIds);\n        const context = this._contextFactory();\n        let nextState = {};\n        for (let fileId of fileIds) {\n            nextState[fileId] = null;\n        }\n        this._updateFiles(updated, context, nextState);\n        this._currentState = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"omitBy\"])(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"merge\"])(this._currentState, nextState), val => val === null);\n        return {\n            state: nextState,\n            addedFiles: [],\n            removedFiles: fileIds,\n            updatedFiles: Object.keys(updated),\n        };\n    }\n    filesUpdated(updates) {\n        const updated = this._dependencies.updateFiles(updates);\n        const context = this._contextFactory();\n        let nextState = {};\n        for (let update of updates) {\n            let nextUpdate = (nextState[update.file.id] = {\n                tags: {},\n                values: {},\n            });\n            for (let tag of update.tags) {\n                nextUpdate.tags[tag] = update.file.tags[tag];\n            }\n        }\n        this._updateFiles(updated, context, nextState);\n        this._currentState = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"omitBy\"])(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"merge\"])(this._currentState, nextState), val => val === null);\n        return {\n            state: nextState,\n            addedFiles: [],\n            removedFiles: [],\n            updatedFiles: Object.keys(updated),\n        };\n    }\n    _updateFiles(updated, context, nextState) {\n        const originalState = this._stateGetter();\n        for (let fileId in updated) {\n            const originalFile = originalState[fileId];\n            if (!originalFile) {\n                continue;\n            }\n            let update = nextState[fileId];\n            if (!update) {\n                update = {\n                    values: {},\n                };\n            }\n            const tags = updated[fileId];\n            for (let tag of tags) {\n                const originalTag = originalFile.tags[tag];\n                if (Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"hasValue\"])(originalTag)) {\n                    const value = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"calculateValue\"])(context, originalFile, tag, originalTag);\n                    if (this.logFormulaErrors && value instanceof Error) {\n                        console.error('[PrecalculationManager]', value);\n                    }\n                    update.values[tag] = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_1__[\"convertToCopiableValue\"])(value);\n                }\n                else {\n                    update.tags[tag] = null;\n                    update.values[tag] = null;\n                }\n            }\n            nextState[fileId] = update;\n        }\n    }\n}\n//# sourceMappingURL=PrecalculationManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/PrecalculationManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/ProgressManager.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/ProgressManager.js ***!
  \****************************************************************************/
/*! exports provided: ProgressManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ProgressManager\", function() { return ProgressManager; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * Defines a class that can manage the current loading progress state of a simulation.\n */\nclass ProgressManager {\n    get updates() {\n        return this._progress;\n    }\n    constructor(vm) {\n        this._vm = vm;\n        this._progress = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorSubject\"]({\n            type: 'progress',\n            progress: 0,\n            message: 'Starting...',\n        });\n        this._sub = this._vm.connectionStateChanged\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"takeWhile\"])(m => m.type !== 'init'), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(message => {\n            if (message.type === 'progress') {\n                this._progress.next(message);\n            }\n            else if (message.type === 'authorization') {\n                if (message.authorized === false) {\n                    this._progress.next({\n                        type: 'progress',\n                        progress: 1,\n                        message: 'You are not authorized.',\n                        error: true,\n                    });\n                }\n            }\n            else if (message.type === 'authentication') {\n                if (message.authenticated === false) {\n                    this._progress.next({\n                        type: 'progress',\n                        progress: 1,\n                        message: 'You are not authenticated.',\n                        done: true,\n                    });\n                }\n            }\n        }))\n            .subscribe(null, err => console.error(err), () => {\n            this._progress.next({\n                type: 'progress',\n                message: 'Done.',\n                progress: 1,\n                done: true,\n            });\n        });\n    }\n    unsubscribe() {\n        this._sub.unsubscribe();\n    }\n    get closed() {\n        return this._sub.closed;\n    }\n}\n//# sourceMappingURL=ProgressManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/ProgressManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/SimulationManager.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/SimulationManager.js ***!
  \******************************************************************************/
/*! exports provided: SimulationManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SimulationManager\", function() { return SimulationManager; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n/**\n * Defines a class that it able to manage multiple simulations that are loaded at the same time.\n * @param TSimulation The type of objects that represent a simulation.\n */\nclass SimulationManager {\n    /**\n     * Creates a new simulation manager using the given simulation factory.\n     * @param factory A function that, given an simulation ID, creates a new simulation.\n     */\n    constructor(factory) {\n        this._factory = factory;\n        this.simulations = new Map();\n        this._simulationSubscriptions = new Map();\n        this.primary = null;\n        this._simulationAdded = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._simulationRemoved = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n    }\n    /**\n     * Gets an observable that resolves whenever a simulation is added to the\n     * simulation manager.\n     */\n    get simulationAdded() {\n        return this._simulationAdded.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"startWith\"])(...this.simulations.values()));\n    }\n    /**\n     * Gets an observable that resolves whenever a simulation is removed from the simulation manager.\n     */\n    get simulationRemoved() {\n        return this._simulationRemoved;\n    }\n    /**\n     * Updates the list of loaded simulations to\n     * contain only the given list of IDs.\n     * @param ids The simulations that should be loaded.\n     */\n    updateSimulations(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (let i = 0; i < ids.length; i++) {\n                const id = ids[i];\n                if (!this.simulations.has(id)) {\n                    yield this.addSimulation(id);\n                }\n            }\n            for (let [id, sim] of this.simulations) {\n                if (!ids.find(i => i === id)) {\n                    yield this.removeSimulation(id);\n                }\n            }\n        });\n    }\n    /**\n     * Sets the primary simulation.\n     * @param id The ID to load.\n     * @param loadingCallback The loading progress callback to use.\n     */\n    setPrimary(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let added = yield this.addSimulation(id);\n            this.primary = added;\n            return added;\n        });\n    }\n    /**\n     * Adds a new simulation using the given ID.\n     * @param id The ID of the simulation to add.\n     */\n    addSimulation(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.simulations.has(id)) {\n                return this.simulations.get(id);\n            }\n            else {\n                const sim = this._factory(id);\n                let sub = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subscription\"]();\n                sub.add(sim.onError.subscribe(e => {\n                    console.error(e);\n                    this.removeSimulation(id);\n                }));\n                this._simulationSubscriptions.set(id, sub);\n                this.simulations.set(id, sim);\n                yield sim.init();\n                this._simulationAdded.next(sim);\n                return sim;\n            }\n        });\n    }\n    /**\n     * Removes the simulation with the given ID.\n     * @param id The ID of the simulation to remove.\n     */\n    removeSimulation(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.simulations.has(id)) {\n                const sim = this.simulations.get(id);\n                sim.unsubscribe();\n                if (this._simulationSubscriptions.has(id)) {\n                    const sub = this._simulationSubscriptions.get(id);\n                    sub.unsubscribe();\n                }\n                if (sim === this.primary) {\n                    this.primary = null;\n                }\n                this.simulations.delete(id);\n                this._simulationSubscriptions.delete(id);\n                this._simulationRemoved.next(sim);\n            }\n        });\n    }\n    /**\n     * Clears all the simulations.\n     */\n    clear() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.simulations.forEach((sim, id) => {\n                this.removeSimulation(id);\n            });\n        });\n    }\n}\n//# sourceMappingURL=SimulationManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/SimulationManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/managers/index.js":
/*!******************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/managers/index.js ***!
  \******************************************************************/
/*! exports provided: SimulationManager, BaseHelper, FileHelper, FileWatcher, ConnectionManager, DependencyManager, PrecalculationManager, LoginManager, ProgressManager, BaseSimulation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SimulationManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SimulationManager */ \"./node_modules/@casual-simulation/aux-vm/managers/SimulationManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimulationManager\", function() { return _SimulationManager__WEBPACK_IMPORTED_MODULE_0__[\"SimulationManager\"]; });\n\n/* harmony import */ var _BaseHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseHelper */ \"./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseHelper\", function() { return _BaseHelper__WEBPACK_IMPORTED_MODULE_1__[\"BaseHelper\"]; });\n\n/* harmony import */ var _FileHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./FileHelper */ \"./node_modules/@casual-simulation/aux-vm/managers/FileHelper.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FileHelper\", function() { return _FileHelper__WEBPACK_IMPORTED_MODULE_2__[\"FileHelper\"]; });\n\n/* harmony import */ var _FileWatcher__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./FileWatcher */ \"./node_modules/@casual-simulation/aux-vm/managers/FileWatcher.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FileWatcher\", function() { return _FileWatcher__WEBPACK_IMPORTED_MODULE_3__[\"FileWatcher\"]; });\n\n/* harmony import */ var _ConnectionManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ConnectionManager */ \"./node_modules/@casual-simulation/aux-vm/managers/ConnectionManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ConnectionManager\", function() { return _ConnectionManager__WEBPACK_IMPORTED_MODULE_4__[\"ConnectionManager\"]; });\n\n/* harmony import */ var _DependencyManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./DependencyManager */ \"./node_modules/@casual-simulation/aux-vm/managers/DependencyManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DependencyManager\", function() { return _DependencyManager__WEBPACK_IMPORTED_MODULE_5__[\"DependencyManager\"]; });\n\n/* harmony import */ var _PrecalculationManager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PrecalculationManager */ \"./node_modules/@casual-simulation/aux-vm/managers/PrecalculationManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PrecalculationManager\", function() { return _PrecalculationManager__WEBPACK_IMPORTED_MODULE_6__[\"PrecalculationManager\"]; });\n\n/* harmony import */ var _LoginManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./LoginManager */ \"./node_modules/@casual-simulation/aux-vm/managers/LoginManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LoginManager\", function() { return _LoginManager__WEBPACK_IMPORTED_MODULE_7__[\"LoginManager\"]; });\n\n/* harmony import */ var _ProgressManager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ProgressManager */ \"./node_modules/@casual-simulation/aux-vm/managers/ProgressManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ProgressManager\", function() { return _ProgressManager__WEBPACK_IMPORTED_MODULE_8__[\"ProgressManager\"]; });\n\n/* harmony import */ var _BaseSimulation__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./BaseSimulation */ \"./node_modules/@casual-simulation/aux-vm/managers/BaseSimulation.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseSimulation\", function() { return _BaseSimulation__WEBPACK_IMPORTED_MODULE_9__[\"BaseSimulation\"]; });\n\n\n\n\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/managers/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/vm/AuxHelper.js":
/*!****************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/vm/AuxHelper.js ***!
  \****************************************************************/
/*! exports provided: AuxHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuxHelper\", function() { return AuxHelper; });\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _managers_BaseHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../managers/BaseHelper */ \"./node_modules/@casual-simulation/aux-vm/managers/BaseHelper.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n/**\n * Definesa a class that contains a set of functions to help an AuxChannel\n * run formulas and process file events.\n */\nclass AuxHelper extends _managers_BaseHelper__WEBPACK_IMPORTED_MODULE_4__[\"BaseHelper\"] {\n    /**\n     * Creates a new file helper.\n     * @param tree The tree that the file helper should use.\n     */\n    constructor(tree, config, sandboxFactory) {\n        super();\n        this._localEvents = new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subject\"]();\n        this._remoteEvents = new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subject\"]();\n        this._deviceEvents = new rxjs__WEBPACK_IMPORTED_MODULE_2__[\"Subject\"]();\n        this._sandboxFactory = sandboxFactory;\n        this._tree = tree;\n        this._lib = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createFormulaLibrary\"])({ config });\n    }\n    /**\n     * Gets the current local file state.\n     */\n    get filesState() {\n        return this._tree.value;\n    }\n    get localEvents() {\n        return this._localEvents;\n    }\n    get remoteEvents() {\n        return this._remoteEvents;\n    }\n    get deviceEvents() {\n        return this._deviceEvents;\n    }\n    /**\n     * Creates a new FileCalculationContext from the current state.\n     */\n    createContext() {\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createCalculationContext\"])(this.objects, this.userId, this._lib, this._sandboxFactory);\n    }\n    /**\n     * Adds the given events in a transaction.\n     * That is, they should be performed in a batch.\n     * @param events The events to run.\n     */\n    transaction(...events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const allEvents = this._flattenEvents(events);\n            yield this._tree.addEvents(allEvents);\n            this._sendOtherEvents(allEvents);\n        });\n    }\n    /**\n     * Creates a new file with the given ID and tags. Returns the ID of the new file.\n     * @param id (Optional) The ID that the file should have.\n     * @param tags (Optional) The tags that the file should have.\n     */\n    createFile(id, tags) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (AuxHelper._debug) {\n                console.log('[FileManager] Create File');\n            }\n            const file = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createFile\"])(id, tags);\n            yield this._tree.addFile(file);\n            return file.id;\n        });\n    }\n    /**\n     * Updates the given file with the given data.\n     * @param file The file.\n     * @param newData The new data that the file should have.\n     */\n    updateFile(file, newData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"updateFile\"])(file, this.userFile ? this.userFile.id : null, newData, () => this.createContext());\n            yield this._tree.updateFile(file, newData);\n        });\n    }\n    /**\n     * Creates a new globals file.\n     * @param fileId The ID of the file to create. If not specified a new ID will be generated.\n     */\n    createGlobalsFile(fileId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const workspace = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createFile\"])(fileId, {});\n            const final = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"merge\"])(workspace, {\n                tags: {\n                    'aux.version': _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"AUX_FILE_VERSION\"],\n                    'aux.destroyable': false,\n                },\n            });\n            yield this._tree.addFile(final);\n        });\n    }\n    /**\n     * Creates or updates the user file for the given user.\n     * @param user The user that the file is for.\n     * @param userFile The file to update. If null or undefined then a file will be created.\n     */\n    createOrUpdateUserFile(user, userFile) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const userContext = `_user_${user.username}_${this._tree.site.id}`;\n            const userInventoryContext = `_user_${user.username}_inventory`;\n            const userMenuContext = `_user_${user.username}_menu`;\n            const userSimulationsContext = `_user_${user.username}_simulations`;\n            if (!userFile) {\n                yield this.createFile(user.id, {\n                    [userContext]: true,\n                    ['aux.context']: userContext,\n                    ['aux.context.visualize']: true,\n                    ['aux._user']: user.username,\n                    ['aux._userInventoryContext']: userInventoryContext,\n                    ['aux._userMenuContext']: userMenuContext,\n                    ['aux._userSimulationsContext']: userSimulationsContext,\n                    'aux._mode': _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"DEFAULT_USER_MODE\"],\n                });\n            }\n            else {\n                if (!userFile.tags['aux._userMenuContext']) {\n                    yield this.updateFile(userFile, {\n                        tags: {\n                            ['aux._userMenuContext']: userMenuContext,\n                        },\n                    });\n                }\n                if (!userFile.tags['aux._userInventoryContext']) {\n                    yield this.updateFile(userFile, {\n                        tags: {\n                            ['aux._userInventoryContext']: userInventoryContext,\n                        },\n                    });\n                }\n                if (!userFile.tags['aux._userSimulationsContext']) {\n                    yield this.updateFile(userFile, {\n                        tags: {\n                            ['aux._userSimulationsContext']: userSimulationsContext,\n                        },\n                    });\n                }\n            }\n        });\n    }\n    formulaBatch(formulas) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const state = this.filesState;\n            let events = Object(lodash__WEBPACK_IMPORTED_MODULE_3__[\"flatMap\"])(formulas, f => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateFormulaEvents\"])(state, f, this.userId));\n            yield this.transaction(...events);\n        });\n    }\n    search(search) {\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"searchFileState\"])(search, this.filesState, undefined, this._sandboxFactory);\n    }\n    exportFiles(fileIds) {\n        const files = fileIds.map(id => this.filesState[id]);\n        const atoms = files.map(f => f.metadata.ref);\n        const weave = this._tree.weave.subweave(...atoms);\n        const stored = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"storedTree\"])(this._tree.site, this._tree.knownSites, weave.atoms);\n        return stored;\n    }\n    _flattenEvents(events) {\n        let resultEvents = [];\n        for (let event of events) {\n            if (event.type === 'action') {\n                const result = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"calculateActionEvents\"])(this.filesState, event);\n                resultEvents.push(...this._flattenEvents(result.events));\n            }\n            else if (event.type === 'file_updated') {\n                const file = this.filesState[event.id];\n                Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"updateFile\"])(file, this.userFile.id, event.update, () => this.createContext());\n                resultEvents.push(event);\n            }\n            else if (event.type === 'paste_state') {\n                resultEvents.push(this._pasteState(event));\n            }\n            else {\n                resultEvents.push(event);\n            }\n        }\n        return resultEvents;\n    }\n    _sendOtherEvents(events) {\n        let remoteEvents = [];\n        let localEvents = [];\n        let deviceEvents = [];\n        for (let event of events) {\n            if (event.type === 'local') {\n                localEvents.push(event);\n            }\n            else if (event.type === 'remote') {\n                remoteEvents.push(event);\n            }\n            else if (event.type === 'device') {\n                deviceEvents.push(event);\n            }\n        }\n        if (localEvents.length > 0) {\n            this._localEvents.next(localEvents);\n        }\n        if (remoteEvents.length > 0) {\n            this._remoteEvents.next(remoteEvents);\n        }\n        if (deviceEvents.length > 0) {\n            this._deviceEvents.next(deviceEvents);\n        }\n    }\n    _pasteState(event) {\n        // TODO: Cleanup this function to make it easier to understand\n        const value = event.state;\n        const fileIds = Object.keys(value);\n        let state = {};\n        const oldFiles = fileIds.map(id => value[id]);\n        const calc = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createCalculationContext\"])(oldFiles, this.userId, this._lib, this._sandboxFactory);\n        // Grab the old worksurface\n        // and map everything into a new context\n        // where they keep their relative positions\n        const oldWorksurface = oldFiles.find(f => Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"getFileConfigContexts\"])(calc, f).length > 0) ||\n            Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createWorkspace\"])();\n        const oldContexts = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"getFileConfigContexts\"])(calc, oldWorksurface);\n        const contextMap = new Map();\n        let newContexts = [];\n        oldContexts.forEach(c => {\n            const context = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"createContextId\"])();\n            newContexts.push(context);\n            contextMap.set(c, context);\n        });\n        let worksurface = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"duplicateFile\"])(calc, oldWorksurface);\n        oldContexts.forEach(c => {\n            let newContext = contextMap.get(c);\n            worksurface.tags[c] = null;\n            worksurface.tags['aux.context'] = newContext;\n            worksurface.tags['aux.context.visualize'] = 'surface';\n            worksurface.tags[newContext] = true;\n        });\n        worksurface = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"cleanFile\"])(worksurface);\n        worksurface.tags['aux.context.x'] = event.x;\n        worksurface.tags['aux.context.y'] = event.z;\n        worksurface.tags['aux.context.z'] = event.y;\n        state[worksurface.id] = worksurface;\n        for (let i = 0; i < fileIds.length; i++) {\n            const file = value[fileIds[i]];\n            if (file.id === oldWorksurface.id) {\n                continue;\n            }\n            let newFile = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"duplicateFile\"])(calc, file);\n            oldContexts.forEach(c => {\n                let newContext = contextMap.get(c);\n                newFile.tags[c] = null;\n                let x = file.tags[`${c}.x`];\n                let y = file.tags[`${c}.y`];\n                let z = file.tags[`${c}.z`];\n                let index = file.tags[`${c}.index`];\n                newFile.tags[`${c}.x`] = null;\n                newFile.tags[`${c}.y`] = null;\n                newFile.tags[`${c}.z`] = null;\n                newFile.tags[`${c}.index`] = null;\n                newFile.tags[newContext] = true;\n                newFile.tags[`${newContext}.x`] = x;\n                newFile.tags[`${newContext}.y`] = y;\n                newFile.tags[`${newContext}.z`] = z;\n                newFile.tags[`${newContext}.index`] = index;\n            });\n            state[newFile.id] = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"cleanFile\"])(newFile);\n        }\n        return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_0__[\"addState\"])(state);\n    }\n}\nAuxHelper._debug = false;\n//# sourceMappingURL=AuxHelper.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/vm/AuxHelper.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/vm/BaseAuxChannel.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/vm/BaseAuxChannel.js ***!
  \*********************************************************************/
/*! exports provided: BaseAuxChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BaseAuxChannel\", function() { return BaseAuxChannel; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @casual-simulation/aux-common */ \"./node_modules/@casual-simulation/aux-common/index.js\");\n/* harmony import */ var _managers_PrecalculationManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../managers/PrecalculationManager */ \"./node_modules/@casual-simulation/aux-vm/managers/PrecalculationManager.js\");\n/* harmony import */ var _AuxHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuxHelper */ \"./node_modules/@casual-simulation/aux-vm/vm/AuxHelper.js\");\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\nclass BaseAuxChannel {\n    get onLocalEvents() {\n        return this._onLocalEvents;\n    }\n    get onDeviceEvents() {\n        return this._onDeviceEvents;\n    }\n    get onStateUpdated() {\n        return this._onStateUpdated;\n    }\n    get onConnectionStateChanged() {\n        return this._onConnectionStateChanged;\n    }\n    get onError() {\n        return this._onError;\n    }\n    get helper() {\n        return this._helper;\n    }\n    get user() {\n        return this._user;\n    }\n    constructor(user, config) {\n        this._user = user;\n        this._config = config;\n        this._subs = [];\n        this._hasRegisteredSubs = false;\n        this._onLocalEvents = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onDeviceEvents = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onStateUpdated = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onConnectionStateChanged = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onError = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._onConnectionStateChanged.subscribe(null, err => {\n            this._onError.next({\n                type: 'general',\n                message: err.toString(),\n            });\n        });\n        this._onStateUpdated.subscribe(null, err => {\n            this._onError.next({\n                type: 'general',\n                message: err.toString(),\n            });\n        });\n        this._onLocalEvents.subscribe(null, err => {\n            this._onError.next({\n                type: 'general',\n                message: err.toString(),\n            });\n        });\n        this._onDeviceEvents.subscribe(null, err => {\n            this._onError.next({\n                type: 'general',\n                message: err.toString(),\n            });\n        });\n    }\n    init(onLocalEvents, onStateUpdated, onConnectionStateChanged, onError) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (onLocalEvents) {\n                this.onLocalEvents.subscribe(e => onLocalEvents(e));\n            }\n            if (onStateUpdated) {\n                this.onStateUpdated.subscribe(s => onStateUpdated(s));\n            }\n            if (onConnectionStateChanged) {\n                this.onConnectionStateChanged.subscribe(s => onConnectionStateChanged(s));\n            }\n            // if (onError) {\n            //     this.onError.subscribe(onError);\n            // }\n            return yield this._init();\n        });\n    }\n    initAndWait(onLocalEvents, onStateUpdated, onConnectionStateChanged, onError) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const promise = this.onConnectionStateChanged\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"first\"])(s => s.type === 'init'))\n                .toPromise();\n            yield this.init(onLocalEvents, onStateUpdated, onConnectionStateChanged, onError);\n            yield promise;\n        });\n    }\n    _init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._handleStatusUpdated({\n                type: 'progress',\n                message: 'Creating causal tree...',\n                progress: 0.1,\n            });\n            this._aux = yield this._createRealtimeCausalTree();\n            let statusMapper = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_5__[\"remapProgressPercent\"])(0.3, 0.6);\n            this._subs.push(this._aux, this._aux.onError.subscribe(err => this._handleError(err)), this._aux.onRejected.subscribe(rejected => {\n                rejected.forEach(r => {\n                    console.warn('[AuxChannel] Atom Rejected', r);\n                });\n            }), this._aux.statusUpdated\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(state => this._handleStatusUpdated(statusMapper(state))))\n                .subscribe(null, (e) => console.error(e)), this._aux.events\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(events => this._handleServerEvents(events)))\n                .subscribe(null, (e) => console.error(e)));\n            this._handleStatusUpdated({\n                type: 'progress',\n                message: 'Initializing causal tree...',\n                progress: 0.2,\n            });\n            yield this._initRealtimeCausalTree();\n            return null;\n        });\n    }\n    /**\n     * Initializes the aux.\n     * @param loadingProgress The loading progress.\n     */\n    _initAux() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._handleStatusUpdated({\n                type: 'progress',\n                message: 'Removing old users...',\n                progress: 0.7,\n            });\n            yield this._deleteOldUserFiles();\n            this._handleStatusUpdated({\n                type: 'progress',\n                message: 'Initializing user file...',\n                progress: 0.8,\n            });\n            yield this._initUserFile();\n            this._handleStatusUpdated({\n                type: 'progress',\n                message: 'Initializing config file...',\n                progress: 0.9,\n            });\n            yield this._initGlobalsFile();\n        });\n    }\n    setUser(user) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._user = user;\n            if (this.user && this._helper) {\n                this._helper.userId = this.user.id;\n                yield this._initUserFile();\n            }\n        });\n    }\n    sendEvents(events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._helper.transaction(...events);\n        });\n    }\n    formulaBatch(formulas) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._helper.formulaBatch(formulas);\n        });\n    }\n    search(search) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"convertToCopiableValue\"])(this._helper.search(search));\n        });\n    }\n    forkAux(newId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            throw new Error('Not Implemented');\n        });\n    }\n    exportFiles(fileIds) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._helper.exportFiles(fileIds);\n        });\n    }\n    /**\n     * Exports the causal tree for the simulation.\n     */\n    exportTree() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._aux.tree.export();\n        });\n    }\n    _createAuxHelper() {\n        let helper = new _AuxHelper__WEBPACK_IMPORTED_MODULE_4__[\"AuxHelper\"](this._aux.tree, this._config.config);\n        helper.userId = this.user ? this.user.id : null;\n        return helper;\n    }\n    _registerSubscriptions() {\n        const { filesAdded, filesRemoved, filesUpdated, } = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"fileChangeObservables\"])(this._aux);\n        this._subs.push(this._helper.localEvents.subscribe(e => this._handleLocalEvents(e), (e) => console.error(e)), this._helper.deviceEvents.subscribe(e => this._handleDeviceEvents(e), (e) => console.error(e)), this._helper.remoteEvents.subscribe(e => {\n            this._sendRemoteEvents(e);\n        }), filesAdded\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(e => {\n            if (e.length === 0) {\n                return;\n            }\n            this._handleStateUpdated(this._precalculation.filesAdded(e));\n        }))\n            .subscribe(null, (e) => console.error(e)), filesRemoved\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(e => {\n            if (e.length === 0) {\n                return;\n            }\n            this._handleStateUpdated(this._precalculation.filesRemoved(e));\n        }))\n            .subscribe(null, (e) => console.error(e)), filesUpdated\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(e => {\n            if (e.length === 0) {\n                return;\n            }\n            this._handleStateUpdated(this._precalculation.filesUpdated(e));\n        }))\n            .subscribe(null, (e) => console.error(e)));\n    }\n    _ensureSetup() {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('[AuxChannel] Got Tree:', this._aux.tree.site.id);\n            if (!this._helper) {\n                this._helper = this._createAuxHelper();\n            }\n            if (!this._precalculation) {\n                this._precalculation = this._createPrecalculationManager();\n            }\n            yield this._initAux();\n            if (!this._checkAccessAllowed()) {\n                this._onConnectionStateChanged.next({\n                    type: 'authorization',\n                    authorized: false,\n                    reason: 'unauthorized',\n                });\n                return;\n            }\n            if (!this._hasRegisteredSubs) {\n                this._hasRegisteredSubs = true;\n                this._registerSubscriptions();\n            }\n            this._onConnectionStateChanged.next({\n                type: 'init',\n            });\n        });\n    }\n    _handleStatusUpdated(state) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (state.type === 'sync' && state.synced) {\n                yield this._ensureSetup();\n            }\n            this._onConnectionStateChanged.next(state);\n        });\n    }\n    _handleServerEvents(events) {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    _handleStateUpdated(event) {\n        this._onStateUpdated.next(event);\n    }\n    _handleError(error) {\n        this._onError.next(error);\n    }\n    _initRealtimeCausalTree() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._aux.connect();\n            // await this._aux.waitUntilSynced();\n        });\n    }\n    _createPrecalculationManager() {\n        return new _managers_PrecalculationManager__WEBPACK_IMPORTED_MODULE_3__[\"PrecalculationManager\"](() => this._aux.tree.value, () => this._helper.createContext());\n    }\n    _handleLocalEvents(e) {\n        this._onLocalEvents.next(e);\n    }\n    _handleDeviceEvents(e) {\n        this._onDeviceEvents.next(e);\n    }\n    _initUserFile() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.user) {\n                console.warn('[BaseAuxChannel] Not initializing user file because user is null');\n                return;\n            }\n            const userFile = this._helper.userFile;\n            yield this._helper.createOrUpdateUserFile(this.user, userFile);\n        });\n    }\n    _deleteOldUserFiles() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let events = [];\n            for (let file of this._helper.objects) {\n                if (file.tags['aux._user'] && Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"shouldDeleteUser\"])(file)) {\n                    console.log('[BaseAuxChannel] Removing User', file.id);\n                    events.push(Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"fileRemoved\"])(file.id));\n                }\n            }\n            yield this._helper.transaction(...events);\n        });\n    }\n    _initGlobalsFile() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let globalsFile = this._helper.globalsFile;\n            if (!globalsFile) {\n                const oldGlobalsFile = this._helper.filesState['globals'];\n                if (oldGlobalsFile) {\n                    yield this._helper.createFile(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"GLOBALS_FILE_ID\"], oldGlobalsFile.tags);\n                }\n                else {\n                    yield this._createGlobalsFile();\n                }\n            }\n        });\n    }\n    _createGlobalsFile() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._helper.createGlobalsFile(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"GLOBALS_FILE_ID\"]);\n        });\n    }\n    /**\n     * Checks if the current user is allowed access to the simulation.\n     */\n    _checkAccessAllowed() {\n        if (!this._helper.userFile) {\n            return;\n        }\n        const calc = this._helper.createContext();\n        const username = this._helper.userFile.tags['aux._user'];\n        const file = this._helper.globalsFile;\n        if (this._config.config.isBuilder) {\n            const designers = Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"getFileDesignerList\"])(calc, file);\n            if (designers) {\n                if (!Object(_casual_simulation_aux_common__WEBPACK_IMPORTED_MODULE_2__[\"isInUsernameList\"])(calc, file, 'aux.designers', username)) {\n                    return false;\n                }\n                else {\n                    return true;\n                }\n            }\n        }\n        return true;\n    }\n    unsubscribe() {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        this._subs.forEach(s => s.unsubscribe());\n    }\n}\n//# sourceMappingURL=BaseAuxChannel.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/vm/BaseAuxChannel.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/aux-vm/vm/index.js":
/*!************************************************************!*\
  !*** ./node_modules/@casual-simulation/aux-vm/vm/index.js ***!
  \************************************************************/
/*! exports provided: AuxHelper, BaseAuxChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AuxHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AuxHelper */ \"./node_modules/@casual-simulation/aux-vm/vm/AuxHelper.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AuxHelper\", function() { return _AuxHelper__WEBPACK_IMPORTED_MODULE_0__[\"AuxHelper\"]; });\n\n/* harmony import */ var _BaseAuxChannel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseAuxChannel */ \"./node_modules/@casual-simulation/aux-vm/vm/BaseAuxChannel.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BaseAuxChannel\", function() { return _BaseAuxChannel__WEBPACK_IMPORTED_MODULE_1__[\"BaseAuxChannel\"]; });\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/aux-vm/vm/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-client-socketio/CausalTreeManager.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-client-socketio/CausalTreeManager.js ***!
  \******************************************************************************************/
/*! exports provided: CausalTreeManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CausalTreeManager\", function() { return CausalTreeManager; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var _SocketIOConnection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SocketIOConnection */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/SocketIOConnection.js\");\n/* harmony import */ var _casual_simulation_causal_tree_store_browser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @casual-simulation/causal-tree-store-browser */ \"./node_modules/@casual-simulation/causal-tree-store-browser/index.js\");\n/* harmony import */ var _casual_simulation_crypto_browser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @casual-simulation/crypto-browser */ \"./node_modules/@casual-simulation/crypto-browser/index.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\n/**\n * Defines a class that is able to help manage interactions with causal trees.\n */\nclass CausalTreeManager {\n    get factory() {\n        return this._factory;\n    }\n    /**\n     * Creates a new Causal Tree Manager.\n     * @param socket The socket.io connection that should be used.\n     * @param factory The factory to use for new causal trees.\n     */\n    constructor(socketManager, factory, store) {\n        this._socketManager = socketManager;\n        this._trees = {};\n        this._initialized = false;\n        this._factory = factory;\n        this._store = store || new _casual_simulation_causal_tree_store_browser__WEBPACK_IMPORTED_MODULE_3__[\"BrowserCausalTreeStore\"]();\n        this._events = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._crypto = new _casual_simulation_crypto_browser__WEBPACK_IMPORTED_MODULE_4__[\"BrowserSigningCryptoImpl\"]('ECDSA-SHA256-NISTP256');\n        this.closed = false;\n    }\n    /**\n     * Initializes the Causal Tree Manager.\n     */\n    init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._initialized) {\n                return;\n            }\n            this._initialized = true;\n            yield this._store.init();\n        });\n    }\n    /**\n     * Gets a realtime tree for the given channel info.\n     * The returned tree needs to be initialized.\n     * @param info The info that identifies the tree that should be retrieved or created.\n     * @param user The user that should be used for the connection.\n     * @param options The options that should be used for the tree.\n     */\n    getTree(info, user, options = {}) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let realtime = this._trees[info.id];\n            if (!realtime) {\n                let connection = new _SocketIOConnection__WEBPACK_IMPORTED_MODULE_2__[\"SocketIOConnection\"](this._socketManager.socket, this._socketManager.connectionStateChanged, info);\n                let channel = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"RealtimeChannelImpl\"](connection, user);\n                let validator = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"AtomValidator\"](this._crypto);\n                realtime = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"SyncedRealtimeCausalTree\"](this._factory, this._store, channel, Object.assign({ validator: validator, storeAtoms: true }, options));\n                this._trees[info.id] = realtime;\n            }\n            return realtime;\n        });\n    }\n    /**\n     * Forks the given realtime causal tree into a new channel.\n     * The new channel will contain the exact same tree as the one given but will be served over the given ID.\n     * @param tree The tree to fork.\n     * @param newId The ID of the channel that should be used for the fork.\n     */\n    forkTree(realtime, newId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let oldTree = this._trees[newId];\n            if (oldTree) {\n                throw new Error('The given channel ID already exists.');\n            }\n            const info = {\n                type: realtime.channel.connection.info.type,\n                id: newId,\n                bare: true,\n            };\n            let newTree = yield realtime.tree.fork();\n            // await this._store.put(newId, realtime.tree.export());\n            let connection = new _SocketIOConnection__WEBPACK_IMPORTED_MODULE_2__[\"SocketIOConnection\"](this._socketManager.socket, this._socketManager.connectionStateChanged, info);\n            let channel = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"RealtimeChannelImpl\"](connection, realtime.channel.user);\n            let newRealtime = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_1__[\"SyncedRealtimeCausalTree\"](this._factory, this._store, channel, {\n                tree: newTree,\n            });\n            // newRealtime.storeArchivedAtoms = true;\n            this._trees[info.id] = newRealtime;\n            yield newRealtime.connect();\n            yield newRealtime.waitForUpdateFromServer();\n            return newRealtime;\n        });\n    }\n    unsubscribe() {\n        if (!this.closed) {\n            // this._worker.terminate();\n            this._events.unsubscribe();\n            this.closed = true;\n        }\n    }\n}\n//# sourceMappingURL=CausalTreeManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-client-socketio/CausalTreeManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-client-socketio/SocketIOConnection.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-client-socketio/SocketIOConnection.js ***!
  \*******************************************************************************************/
/*! exports provided: SocketIOConnection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SocketIOConnection\", function() { return SocketIOConnection; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Utils */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/Utils.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n/**\n * Defines a RealtimeChannelConnection that can use Socket.IO.\n */\nclass SocketIOConnection {\n    /**\n     * Creates a new RealtimeChannelConnection for Socket.IO.\n     * @param socket The Socket.IO instance.\n     */\n    constructor(socket, connectionStateChanged, info) {\n        this.info = info;\n        this.closed = false;\n        this._socket = socket;\n        this._connectionStateChanged = connectionStateChanged;\n        this._atoms = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._events = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._sites = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._connected = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorSubject\"](socket.connected);\n    }\n    login(user) {\n        let loginResults = Object(_Utils__WEBPACK_IMPORTED_MODULE_2__[\"socketEvent\"])(this._socket, 'login_result', (err, info) => ({\n            error: err,\n            info: info,\n        }));\n        this._socket.emit('login', user);\n        return loginResults.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(({ error, info }) => {\n            if (error) {\n                return {\n                    success: false,\n                    value: null,\n                    error: {\n                        type: 'not_authenticated',\n                        reason: error.error,\n                    },\n                };\n            }\n            return {\n                success: true,\n                value: info,\n            };\n        }));\n    }\n    joinChannel() {\n        let joinResults = Object(_Utils__WEBPACK_IMPORTED_MODULE_2__[\"socketEvent\"])(this._socket, `join_channel_result_${this.info.id}`, (err) => ({\n            error: err,\n        }));\n        this._socket.emit('join_channel', this.info);\n        return joinResults.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(({ error }) => {\n            if (error) {\n                return {\n                    success: false,\n                    value: null,\n                    error: {\n                        type: 'not_authorized',\n                        reason: error,\n                    },\n                };\n            }\n            return {\n                success: true,\n                value: null,\n            };\n        }));\n    }\n    exchangeInfo(version) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const info = yield this._request(`info_${this.info.id}`, version);\n            return {\n                success: true,\n                value: info,\n            };\n        });\n    }\n    requestSiteId(site) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const allowed = yield this._request(`siteId_${this.info.id}`, site);\n            return {\n                success: true,\n                value: allowed,\n            };\n        });\n    }\n    exchangeWeaves(message) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tree = yield this._request(`weave_${this.info.id}`, message);\n            return {\n                success: true,\n                value: tree,\n            };\n        });\n    }\n    connect() {\n        this._sub = this._connectionStateChanged.subscribe(this._connected);\n        let eventListener = (event) => {\n            this._atoms.next(event);\n        };\n        this._socket.on(`event_${this.info.id}`, eventListener);\n        let siteListener = (event) => {\n            this._sites.next(event);\n        };\n        this._socket.on(`site_${this.info.id}`, siteListener);\n        let remoteEventListener = (event) => {\n            this._events.next(event);\n        };\n        this._socket.on(`remote_event_${this.info.id}`, remoteEventListener);\n        this._sub.add(() => {\n            this._socket.off(`event_${this.info.id}`, eventListener);\n            this._socket.off(`site_${this.info.id}`, siteListener);\n            this._socket.off(`remote_event_${this.info.id}`, remoteEventListener);\n        });\n    }\n    isConnected() {\n        return this._connected.value;\n    }\n    get atoms() {\n        return this._atoms;\n    }\n    get events() {\n        return this._events;\n    }\n    get sites() {\n        return this._sites;\n    }\n    emit(event) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._socket.emit(`event_${this.info.id}`, event);\n            return {\n                success: true,\n                value: null,\n            };\n        });\n    }\n    sendEvents(events) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._socket.emit(`remote_event_${this.info.id}`, events);\n        });\n    }\n    _request(name, data) {\n        return new Promise((resolve, reject) => {\n            this._socket.emit(name, data, (err, response) => {\n                if (err) {\n                    reject(err);\n                }\n                resolve(response);\n            });\n        });\n    }\n    get connectionStateChanged() {\n        return this._connected;\n    }\n    unsubscribe() {\n        if (!this.closed) {\n            this.closed = true;\n            this._sub.unsubscribe();\n        }\n    }\n}\n//# sourceMappingURL=SocketIOConnection.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-client-socketio/SocketIOConnection.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-client-socketio/SocketManager.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-client-socketio/SocketManager.js ***!
  \**************************************************************************************/
/*! exports provided: SocketManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SocketManager\", function() { return SocketManager; });\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io-client */ \"socket.io-client\");\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(socket_io_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass SocketManager {\n    /**\n     * Creates a new SocketManager.\n     * @param user The user account to use for connecting.\n     * @param url The URL to connect to.\n     */\n    constructor(url) {\n        // Whether this manager has forced the user to be offline or not.\n        this._forcedOffline = false;\n        this._connectionStateChanged = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"BehaviorSubject\"](false);\n        this._url = url;\n    }\n    get connectionStateChanged() {\n        return this._connectionStateChanged;\n    }\n    /**\n     * Gets whether the socket manager is forcing the user to be offline or not.\n     */\n    get forcedOffline() {\n        return this._forcedOffline;\n    }\n    set forcedOffline(value) {\n        this._forcedOffline = !this._forcedOffline;\n        if (this._forcedOffline) {\n            this._socket.disconnect();\n        }\n        else {\n            this._socket.connect();\n        }\n    }\n    get socket() {\n        return this._socket;\n    }\n    init() {\n        console.log('[SocketManager] Starting...');\n        this._socket = socket_io_client__WEBPACK_IMPORTED_MODULE_0___default()(this._url);\n        this._socket.on('connect', () => {\n            console.log('[SocketManager] Connected.');\n            this._connectionStateChanged.next(true);\n        });\n        this._socket.on('connect_timeout', () => {\n            console.log('[SocketManager] Connection timeout.');\n        });\n        this._socket.on('connect_error', (err) => {\n            console.error('[SocketManager] Connection error.', err);\n        });\n        this._socket.on('disconnect', (reason) => {\n            console.log('[SocketManger] Disconnected. Reason:', reason);\n            this._connectionStateChanged.next(false);\n        });\n    }\n    /**\n     * Toggles whether the socket manager should be forcing the user's\n     * connection to the server to be offline.\n     */\n    toggleForceOffline() {\n        this.forcedOffline = !this.forcedOffline;\n    }\n}\n//# sourceMappingURL=SocketManager.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-client-socketio/SocketManager.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-client-socketio/Utils.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-client-socketio/Utils.js ***!
  \******************************************************************************/
/*! exports provided: socketEvent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"socketEvent\", function() { return socketEvent; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction socketEvent(socket, eventName, selector) {\n    return Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"fromEventPattern\"])(handler => {\n        socket.on(eventName, handler);\n    }, handler => {\n        socket.off(eventName, handler);\n    }, selector);\n}\n//# sourceMappingURL=Utils.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-client-socketio/Utils.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-client-socketio/index.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-client-socketio/index.js ***!
  \******************************************************************************/
/*! exports provided: SocketManager, CausalTreeManager, SocketIOConnection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SocketManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SocketManager */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/SocketManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SocketManager\", function() { return _SocketManager__WEBPACK_IMPORTED_MODULE_0__[\"SocketManager\"]; });\n\n/* harmony import */ var _CausalTreeManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CausalTreeManager */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/CausalTreeManager.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CausalTreeManager\", function() { return _CausalTreeManager__WEBPACK_IMPORTED_MODULE_1__[\"CausalTreeManager\"]; });\n\n/* harmony import */ var _SocketIOConnection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SocketIOConnection */ \"./node_modules/@casual-simulation/causal-tree-client-socketio/SocketIOConnection.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SocketIOConnection\", function() { return _SocketIOConnection__WEBPACK_IMPORTED_MODULE_2__[\"SocketIOConnection\"]; });\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-client-socketio/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/ChannelManagerHelpers.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/ChannelManagerHelpers.js ***!
  \*************************************************************************************/
/*! exports provided: loadChannel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"loadChannel\", function() { return loadChannel; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n/**\n * Creates an observable which loads the given channel and unloads it when unsubscribed.\n * @param manager The manager.\n * @param info The info about the channel to load.\n */\nfunction loadChannel(manager, info) {\n    return rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Observable\"].create((observer) => {\n        let channel;\n        setup();\n        return () => {\n            if (channel) {\n                channel.subscription.unsubscribe();\n                channel = null;\n            }\n        };\n        function setup() {\n            return __awaiter(this, void 0, void 0, function* () {\n                channel = yield manager.loadChannel(info);\n                observer.next(channel);\n            });\n        }\n    });\n}\n//# sourceMappingURL=ChannelManagerHelpers.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/ChannelManagerHelpers.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/ChannelManagerImpl.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/ChannelManagerImpl.js ***!
  \**********************************************************************************/
/*! exports provided: ChannelManagerImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChannelManagerImpl\", function() { return ChannelManagerImpl; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\nclass ChannelManagerImpl {\n    constructor(treeStore, causalTreeFactory, crypto) {\n        this._store = treeStore;\n        this._factory = causalTreeFactory;\n        this._crypto = crypto;\n        this._loadedTrees = new Map();\n        this._treeSubscription = new Map();\n        this._treeLoadedSubscriptions = new Map();\n        this._listenerScriptions = new Map();\n        this._finishedTrees = new Map();\n        this._listeners = [];\n    }\n    hasChannel(info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = yield this._store.get(info.id, false);\n            return !!(stored && stored.weave.length > 0);\n        });\n    }\n    loadChannel(info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let tree = yield this._loadTree(info);\n            const result = {\n                info,\n                tree: tree[0],\n                events: tree[1],\n                subscription: this._addSubscription(info),\n            };\n            return result;\n        });\n    }\n    connect(channel, device) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let sub = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"]();\n            channel.subscription.add(sub);\n            return sub;\n        });\n    }\n    whileCausalTreeLoaded(listener) {\n        this._listeners.push(listener);\n        let sub = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"](() => {\n            const index = this._listeners.indexOf(listener);\n            if (index >= 0) {\n                this._listeners.splice(index, 1);\n            }\n        });\n        this._finishedTrees.forEach(([tree, info]) => {\n            let list = this._listenerScriptions.get(info.id);\n            if (!list) {\n                list = [];\n                this._listenerScriptions.set(info.id, list);\n            }\n            let subs = listener(tree[0], info, tree[1]);\n            list.push(...subs);\n        });\n        return sub;\n    }\n    addAtoms(channel, atoms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tree = channel.tree;\n            const info = channel.info;\n            const { added, rejected } = yield tree.addMany(atoms, true);\n            if (rejected.length > 0) {\n                console.warn(`[ChannelManagerImpl] ${info.id} Rejected ${rejected.length} atoms:`);\n                rejected.forEach(r => {\n                    console.warn(`[ChannelManagerImpl] ${Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(r.atom.id)}: ${r.reason}`);\n                });\n            }\n            return added;\n        });\n    }\n    sendEvents(channel, events) {\n        return __awaiter(this, void 0, void 0, function* () { });\n    }\n    updateVersionInfo(channel, versionInfo) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tree = channel.tree;\n            const info = channel.info;\n            console.log('[ChannelManagerImpl] Getting info for tree:', info.id);\n            // import the known sites\n            if (versionInfo.knownSites) {\n                console.log('[ChannelManagerImpl] Updating known sites...');\n                versionInfo.knownSites.forEach(ks => {\n                    tree.registerSite(ks);\n                });\n                yield this._store.put(info.id, tree.export(), false);\n            }\n            console.log('[ChannelManagerImpl] Sending current site info...');\n            const currentVersionInfo = tree.getVersion();\n            return currentVersionInfo;\n        });\n    }\n    requestSiteId(channel, site) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tree = channel.tree;\n            const info = channel.info;\n            console.log(`[ChannelManagerImpl] Checking site ID (${site.id}) for tree (${info.id})`);\n            const knownSite = Object(lodash__WEBPACK_IMPORTED_MODULE_3__[\"find\"])(tree.knownSites, ks => ks.id === site.id);\n            if (knownSite) {\n                console.log('[ChannelManagerImpl] Site ID Already Reserved.');\n                return false;\n            }\n            else {\n                console.log('[ChannelManagerImpl] Site ID Granted.');\n                tree.registerSite(site);\n                return true;\n            }\n        });\n    }\n    exchangeWeaves(channel, stored) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tree = channel.tree;\n            const info = channel.info;\n            try {\n                console.log(`[ChannelManagerImpl] Exchanging Weaves for tree (${info.id}).`);\n                const { added: imported, rejected } = yield tree.import(stored);\n                console.log(`[ChannelManagerImpl] Imported ${imported.length} atoms.`);\n                if (rejected.length > 0) {\n                    console.warn(`[ChannelManagerImpl] Rejected ${rejected.length} atoms:`);\n                    rejected.forEach(r => {\n                        console.warn(`[ChannelManagerImpl] ${Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(r.atom.id)}: ${r.reason}`);\n                    });\n                }\n                this._store.add(info.id, imported);\n            }\n            catch (e) {\n                console.log('[ChannelManagerImpl] Could not import atoms from remote.', e);\n            }\n            // TODO: If a version is provided then we should\n            // return only the atoms that are needed to sync.\n            const exported = tree.export();\n            console.log(`[ChannelManagerImpl] Sending ${exported.weave.length} atoms.`);\n            return exported;\n        });\n    }\n    _registerListeners(info, tree, events) {\n        let list = this._listenerScriptions.get(info.id);\n        if (!list) {\n            list = [];\n            this._listenerScriptions.set(info.id, list);\n        }\n        for (let listener of this._listeners) {\n            const subs = listener(tree, info, events);\n            list.push(...subs);\n        }\n    }\n    _unloadChannel(info) {\n        console.log(`[ChannelManagerImpl] Cleaning up ${info.id} because nothing is using it anymore...`);\n        this._loadedTrees.delete(info.id);\n        this._finishedTrees.delete(info.id);\n        const sub = this._treeSubscription.get(info.id);\n        if (sub) {\n            sub.unsubscribe();\n        }\n        this._treeSubscription.delete(info.id);\n        let listenerSubs = this._listenerScriptions.get(info.id);\n        if (listenerSubs) {\n            for (let sub of listenerSubs) {\n                sub.unsubscribe();\n            }\n            listenerSubs.length = 0;\n        }\n    }\n    _addSubscription(info) {\n        let list = this._treeLoadedSubscriptions.get(info.id);\n        if (!list) {\n            list = [];\n            this._treeLoadedSubscriptions.set(info.id, list);\n        }\n        let sub = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"](() => {\n            const index = list.indexOf(sub);\n            if (index >= 0) {\n                list.splice(index, 1);\n                if (list.length === 0) {\n                    this._unloadChannel(info);\n                }\n            }\n        });\n        list.push(sub);\n        return sub;\n    }\n    _loadTree(info) {\n        let promise = this._loadedTrees.get(info.id);\n        if (!promise) {\n            promise = this._loadTreeCore(info);\n            this._loadedTrees.set(info.id, promise);\n        }\n        promise.then(tree => {\n            this._finishedTrees.set(info.id, [tree, info]);\n        }, er => { });\n        return promise;\n    }\n    _loadTreeCore(info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let tree;\n            console.log(`[ChannelManagerImpl] Getting tree (${info.id}) from database...`);\n            const stored = yield this._store.get(info.id, false);\n            if (stored && stored.weave.length > 0) {\n                tree = yield this._createFromExisting(info, stored);\n            }\n            else {\n                if (stored) {\n                    console.log(`[ChannelManagerImpl] Found tree information but it didn't contain any atoms...`);\n                }\n                tree = yield this._createNewTree(info);\n            }\n            let sub = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"]();\n            sub.add(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"bindChangesToStore\"])(info.id, tree, this._store));\n            this._treeSubscription.set(info.id, sub);\n            let events = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n            this._registerListeners(info, tree, events);\n            console.log(`[ChannelManagerImpl] Done.`);\n            return [tree, events];\n        });\n    }\n    _createFromExisting(info, stored) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log(`[ChannelManagerImpl] Building from stored tree (version ${stored.formatVersion})...`);\n            try {\n                // Dont generate keys for existing trees because\n                // that would suddenly cause atoms created by the server to\n                // be rejected by the remotes.\n                const tree = yield this._createTree(info.id, info.type, false);\n                const sub = tree.atomsArchived\n                    .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"flatMap\"])((refs) => __awaiter(this, void 0, void 0, function* () {\n                    console.log(`[ChannelManagerImpl] Archiving ${refs.length} atoms...`);\n                    const atoms = refs.map(r => r);\n                    yield this._store.add(info.id, atoms, true);\n                })))\n                    .subscribe(null, err => console.error(err));\n                const { added: loaded } = yield tree.import(stored);\n                sub.unsubscribe();\n                console.log(`[ChannelManagerImpl] ${loaded.length} atoms loaded.`);\n                if (stored.formatVersion < _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"currentFormatVersion\"]) {\n                    // Update the stored data but don't delete archived atoms\n                    console.log(`[ChannelManagerImpl] Updating stored atoms from ${stored.formatVersion} to ${_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"currentFormatVersion\"]}...`);\n                    const exported = tree.export();\n                    yield this._store.put(info.id, exported, false);\n                    const upgraded = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"upgrade\"])(exported);\n                    yield this._store.add(info.id, upgraded.weave, false);\n                }\n                return tree;\n            }\n            catch (ex) {\n                // TODO: Improve to be able to issue an error to the client\n                // saying that the data became corrupted somehow.\n                console.warn('[ChannelManagerImpl] Unable to load tree', info.id, ex);\n                throw ex;\n            }\n        });\n    }\n    _createNewTree(info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log(`[ChannelManagerImpl] Creating new...`);\n            const tree = yield this._createTree(info.id, info.type, true);\n            if (!info.bare) {\n                const { added, rejected } = yield tree.root();\n                if (rejected) {\n                    throw new Error('[ChannelManagerImpl] Unable to add a root atom to the tree: ' +\n                        rejected.reason);\n                }\n                console.log(`[ChannelManagerImpl] Storing initial tree version...`);\n                yield this._store.put(info.id, tree.export(), true);\n            }\n            else {\n                console.log(`[ChannelManagerImpl] Skipping root node because a bare tree was requested.`);\n            }\n            return tree;\n        });\n    }\n    _createTree(id, type, generateKeys) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let keys = yield this._store.getKeys(id);\n            let signingKey = null;\n            let treeWithCrypto;\n            if (keys && this._crypto.supported()) {\n                // Use the existing keys because we've already created them.\n                console.log('[ChannelManagerImpl] Using existing keys...');\n                treeWithCrypto = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"storedTree\"])(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"site\"])(1, {\n                    // TODO: Allow storing the crypto algorithm with the keys\n                    signatureAlgorithm: 'ECDSA-SHA256-NISTP256',\n                    publicKey: keys.publicKey,\n                }));\n                signingKey = yield this._crypto.importPrivateKey(keys.privateKey);\n                console.log('[ChannelManagerImpl] Keys imported.');\n            }\n            else if (generateKeys && this._crypto.supported()) {\n                // Create new keys because we haven't stored any under this ID\n                console.log('[ChannelManagerImpl] Creating new keys...');\n                let [pubKey, privKey] = yield this._crypto.generateKeyPair();\n                signingKey = privKey;\n                let publicKey = yield this._crypto.exportKey(pubKey);\n                let privateKey = yield this._crypto.exportKey(privKey);\n                yield this._store.putKeys(id, privateKey, publicKey);\n                treeWithCrypto = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"storedTree\"])(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"site\"])(1, {\n                    // TODO: Allow storing the crypto algorithm with the keys\n                    signatureAlgorithm: 'ECDSA-SHA256-NISTP256',\n                    publicKey: publicKey,\n                }));\n                console.log('[ChannelManagerImpl] Keys created.');\n            }\n            else {\n                console.log('[ChannelManagerImpl] Not generating keys.');\n                treeWithCrypto = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"storedTree\"])(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"site\"])(1));\n            }\n            let validator = new _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"AtomValidator\"](this._crypto);\n            return this._factory.create(type, treeWithCrypto, {\n                garbageCollect: true,\n                validator: validator,\n                signingKey: signingKey,\n            });\n        });\n    }\n}\n//# sourceMappingURL=ChannelManagerImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/ChannelManagerImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/DeviceManagerHelpers.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/DeviceManagerHelpers.js ***!
  \************************************************************************************/
/*! exports provided: connectDeviceChannel, devicesForEvent, isEventForDevice */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"connectDeviceChannel\", function() { return connectDeviceChannel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"devicesForEvent\", function() { return devicesForEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEventForDevice\", function() { return isEventForDevice; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n/**\n * Creates a new cold observable which joins the given device to the given channel\n * and leaves the channel when unsubscribed from.\n * @param manager The manager.\n * @param device The device to connect to the channel.\n * @param info The info about the channel.\n */\nfunction connectDeviceChannel(manager, device, info) {\n    return rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Observable\"].create((observer) => {\n        setup();\n        return () => {\n            manager.leaveChannel(device, info);\n        };\n        function setup() {\n            return __awaiter(this, void 0, void 0, function* () {\n                const connection = yield manager.joinChannel(device, info);\n                observer.next(connection);\n            });\n        }\n    });\n}\nfunction devicesForEvent(event, devices) {\n    return devices.filter(d => isEventForDevice(event, d[1])).map(d => d[0]);\n}\nfunction isEventForDevice(event, device) {\n    if (event.username === device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]]) {\n        return true;\n    }\n    else if (event.sessionId === device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]]) {\n        return true;\n    }\n    else if (event.deviceId === device.claims[_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"DEVICE_ID_CLAIM\"]]) {\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=DeviceManagerHelpers.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/DeviceManagerHelpers.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/DeviceManagerImpl.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/DeviceManagerImpl.js ***!
  \*********************************************************************************/
/*! exports provided: DeviceManagerImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DeviceManagerImpl\", function() { return DeviceManagerImpl; });\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\nclass DeviceManagerImpl {\n    constructor() {\n        this._connectedDevices = new Map();\n        this._activeChannels = new Map();\n        this._listeners = [];\n    }\n    get connectedDevices() {\n        return [...this._connectedDevices.keys()];\n    }\n    getConnectedChannels(device) {\n        let channels = this._connectedDevices.get(device) || [];\n        return channels.slice();\n    }\n    getConnectedDevices(info) {\n        let devices = this._activeChannels.get(info.id) || [];\n        return devices.slice();\n    }\n    whenConnectedToChannel(listener) {\n        this._listeners.push(listener);\n        return new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subscription\"](() => {\n            const index = this._listeners.indexOf(listener);\n            if (index >= 0) {\n                this._listeners.splice(index, 1);\n            }\n        });\n    }\n    connectDevice(deviceId, extra) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const device = {\n                id: deviceId,\n                extra: extra,\n            };\n            this._connectedDevices.set(device, []);\n            return device;\n        });\n    }\n    disconnectDevice(device) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const channels = this.getConnectedChannels(device);\n            for (let channel of channels) {\n                yield this.leaveChannel(device, channel.info);\n            }\n            this._connectedDevices.delete(device);\n        });\n    }\n    joinChannel(device, info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let subs = [];\n            const channel = {\n                info: info,\n                subs: subs,\n            };\n            if (this._connectedDevices.has(device)) {\n                const list = this._connectedDevices.get(device);\n                list.push(channel);\n            }\n            let list = this._activeChannels.get(info.id);\n            if (!list) {\n                list = [];\n                this._activeChannels.set(info.id, list);\n            }\n            list.push(device);\n            for (let listener of this._listeners) {\n                subs.push(...(yield listener(device, channel)));\n            }\n            return channel;\n        });\n    }\n    leaveChannel(device, info) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._connectedDevices.has(device)) {\n                const list = this._connectedDevices.get(device);\n                const index = Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"findIndex\"])(list, c => c.info.id === info.id);\n                if (index >= 0) {\n                    const channel = list[index];\n                    channel.subs.forEach(s => s.unsubscribe());\n                    list.splice(index, 1);\n                }\n            }\n            let list = this._activeChannels.get(info.id);\n            if (list) {\n                const index = Object(lodash__WEBPACK_IMPORTED_MODULE_0__[\"findIndex\"])(list, d => d === device);\n                if (index >= 0) {\n                    list.splice(index, 1);\n                }\n            }\n        });\n    }\n}\n//# sourceMappingURL=DeviceManagerImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/DeviceManagerImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/NullChannelAuthorizer.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/NullChannelAuthorizer.js ***!
  \*************************************************************************************/
/*! exports provided: NullChannelAuthorizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullChannelAuthorizer\", function() { return NullChannelAuthorizer; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * Defines a channel authorizer that always allows access.\n */\nclass NullChannelAuthorizer {\n    isAllowedToLoad(device, info) {\n        return Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"of\"])(true);\n    }\n    isAllowedAccess(device, channel) {\n        return Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"of\"])(true);\n    }\n}\n//# sourceMappingURL=NullChannelAuthorizer.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/NullChannelAuthorizer.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/NullDeviceAuthenticator.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/NullDeviceAuthenticator.js ***!
  \***************************************************************************************/
/*! exports provided: NullDeviceAuthenticator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullDeviceAuthenticator\", function() { return NullDeviceAuthenticator; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid/v4 */ \"uuid/v4\");\n/* harmony import */ var uuid_v4__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(uuid_v4__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n/**\n * Defines a device authenticator that always returns empty device info.\n */\nclass NullDeviceAuthenticator {\n    authenticate(token) {\n        return Object(rxjs__WEBPACK_IMPORTED_MODULE_1__[\"of\"])({\n            success: true,\n            info: {\n                claims: {\n                    [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]]: token.username,\n                    [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"DEVICE_ID_CLAIM\"]]: token.username,\n                    [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]]: uuid_v4__WEBPACK_IMPORTED_MODULE_2___default()(),\n                },\n                roles: [_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"USER_ROLE\"]],\n            },\n        });\n    }\n}\n//# sourceMappingURL=NullDeviceAuthenticator.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/NullDeviceAuthenticator.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-server/index.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-server/index.js ***!
  \*********************************************************************/
/*! exports provided: loadChannel, ChannelManagerImpl, connectDeviceChannel, devicesForEvent, isEventForDevice, DeviceManagerImpl, NullChannelAuthorizer, NullDeviceAuthenticator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ChannelManagerHelpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ChannelManagerHelpers */ \"./node_modules/@casual-simulation/causal-tree-server/ChannelManagerHelpers.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"loadChannel\", function() { return _ChannelManagerHelpers__WEBPACK_IMPORTED_MODULE_0__[\"loadChannel\"]; });\n\n/* harmony import */ var _ChannelManagerImpl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ChannelManagerImpl */ \"./node_modules/@casual-simulation/causal-tree-server/ChannelManagerImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ChannelManagerImpl\", function() { return _ChannelManagerImpl__WEBPACK_IMPORTED_MODULE_1__[\"ChannelManagerImpl\"]; });\n\n/* harmony import */ var _DeviceManagerHelpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DeviceManagerHelpers */ \"./node_modules/@casual-simulation/causal-tree-server/DeviceManagerHelpers.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"connectDeviceChannel\", function() { return _DeviceManagerHelpers__WEBPACK_IMPORTED_MODULE_2__[\"connectDeviceChannel\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"devicesForEvent\", function() { return _DeviceManagerHelpers__WEBPACK_IMPORTED_MODULE_2__[\"devicesForEvent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isEventForDevice\", function() { return _DeviceManagerHelpers__WEBPACK_IMPORTED_MODULE_2__[\"isEventForDevice\"]; });\n\n/* harmony import */ var _DeviceManagerImpl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DeviceManagerImpl */ \"./node_modules/@casual-simulation/causal-tree-server/DeviceManagerImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DeviceManagerImpl\", function() { return _DeviceManagerImpl__WEBPACK_IMPORTED_MODULE_3__[\"DeviceManagerImpl\"]; });\n\n/* harmony import */ var _NullChannelAuthorizer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./NullChannelAuthorizer */ \"./node_modules/@casual-simulation/causal-tree-server/NullChannelAuthorizer.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NullChannelAuthorizer\", function() { return _NullChannelAuthorizer__WEBPACK_IMPORTED_MODULE_4__[\"NullChannelAuthorizer\"]; });\n\n/* harmony import */ var _NullDeviceAuthenticator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./NullDeviceAuthenticator */ \"./node_modules/@casual-simulation/causal-tree-server/NullDeviceAuthenticator.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NullDeviceAuthenticator\", function() { return _NullDeviceAuthenticator__WEBPACK_IMPORTED_MODULE_5__[\"NullDeviceAuthenticator\"]; });\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-server/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-store-browser/BrowserCausalTreeStore.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-store-browser/BrowserCausalTreeStore.js ***!
  \*********************************************************************************************/
/*! exports provided: BrowserCausalTreeStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserCausalTreeStore\", function() { return BrowserCausalTreeStore; });\n/* harmony import */ var _casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/causal-trees */ \"./node_modules/@casual-simulation/causal-trees/index.js\");\n/* harmony import */ var dexie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dexie */ \"dexie\");\n/* harmony import */ var dexie__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(dexie__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\nclass BrowserCausalTreeStore {\n    constructor() {\n        this._db = new CausalTreeDatabase();\n    }\n    init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._db.open();\n        });\n    }\n    put(id, tree, fullUpdate = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('[BrowserCausalTreeStore] Updating tree', id);\n            const upgraded = Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"upgrade\"])(tree);\n            const stored = {\n                id: id,\n                formatVersion: upgraded.formatVersion,\n                knownSites: upgraded.knownSites,\n                site: upgraded.site,\n            };\n            yield this._db.trees.put(stored);\n            if (fullUpdate) {\n                console.log('[BrowserCausalTreeStore] Deleting old atoms...');\n                const num = yield this._db.atoms\n                    .where('tree')\n                    .equals(id)\n                    .delete();\n                console.log('[BrowserCausalTreeStore] Deleted', num, 'atoms.');\n                if (upgraded.weave) {\n                    console.log('[BrowserCausalTreeStore] Adding', upgraded.weave.length, 'atoms...');\n                    yield this.add(id, upgraded.weave, false);\n                }\n            }\n        });\n    }\n    get(id, archived) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const value = yield this._db.trees.get(id);\n            if (!value) {\n                return null;\n            }\n            if (typeof value.wrapperVersion === 'undefined') {\n                console.log('[BrowserCausalTreeStore] Getting tree', id);\n                const query = yield this._db.atoms.where('tree').equals(id);\n                let stored;\n                if (typeof archived !== 'undefined') {\n                    stored = yield query\n                        .filter(a => a.archived === archived)\n                        .toArray();\n                }\n                else {\n                    stored = yield query.toArray();\n                }\n                let atoms = new Map();\n                for (let i = 0; i < stored.length; i++) {\n                    const arr = stored[i].atoms;\n                    for (let b = 0; b < arr.length; b++) {\n                        const a = arr[b];\n                        atoms.set(Object(_casual_simulation_causal_trees__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(a.id), a);\n                    }\n                }\n                let vals = new Array(...atoms.values());\n                console.log('[BrowserCausalTreeStore] Returning', vals.length, 'atoms');\n                return {\n                    formatVersion: 3,\n                    knownSites: value.knownSites,\n                    site: value.site,\n                    weave: vals,\n                    ordered: false,\n                };\n            }\n            else {\n                throw new Error(`[BrowserCausalTreeStore] Got unrecognized wrapper version: ${value.wrapperVersion}.`);\n            }\n        });\n    }\n    add(id, atoms, archived = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = {\n                tree: id,\n                atoms: atoms,\n                archived: archived,\n            };\n            yield this._db.atoms.add(stored);\n        });\n    }\n    putKeys(id, privateKey, publicKey) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = {\n                id: id,\n                keys: {\n                    privateKey: privateKey,\n                    publicKey: publicKey,\n                },\n            };\n            yield this._db.keys.put(stored);\n        });\n    }\n    getKeys(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const item = yield this._db.keys.get(id);\n            if (item) {\n                return item.keys;\n            }\n            else {\n                return null;\n            }\n        });\n    }\n}\nclass CausalTreeDatabase extends dexie__WEBPACK_IMPORTED_MODULE_1___default.a {\n    constructor() {\n        super('AuxCausalTrees');\n        this.version(5)\n            .stores({\n            trees: 'id,site.id',\n            atoms: '++,tree,archived',\n            keys: 'id',\n        })\n            .upgrade((trans) => __awaiter(this, void 0, void 0, function* () {\n            console.log('[BrowserCausalTreeStore] Upgrading database to version 4...');\n            yield trans\n                .table('atoms')\n                .toCollection()\n                .delete();\n            console.log('[BrowserCausalTreeStore] Upgraded database.');\n        }));\n        this.version(4)\n            .stores({\n            trees: 'id,site.id',\n            atoms: 'id,tree,atom.id.timestamp,atom.id.site,archived',\n            keys: 'id',\n        })\n            .upgrade(trans => { });\n        this.version(3)\n            .stores({\n            trees: 'id,site.id',\n            atoms: 'id,tree,atom.id.timestamp,atom.id.site,archived',\n        })\n            .upgrade(trans => {\n            console.log('[BrowserCausalTreeStore] Upgrading database to version 3...');\n            return trans\n                .table('atoms')\n                .toCollection()\n                .modify(atom => {\n                atom.archived = !!atom.archived;\n            });\n        });\n        this.version(2).stores({\n            trees: 'id,site.id',\n            atoms: 'id,tree,atom.id.timestamp,atom.id.site,archived',\n        });\n        this.version(1).stores({\n            trees: 'id,site.id',\n            atoms: 'id,tree,atom.id.timestamp,atom.id.site',\n        });\n        this.trees = this.table('trees');\n        this.atoms = this.table('atoms');\n        this.keys = this.table('keys');\n    }\n}\n//# sourceMappingURL=BrowserCausalTreeStore.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-store-browser/BrowserCausalTreeStore.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-tree-store-browser/index.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-tree-store-browser/index.js ***!
  \****************************************************************************/
/*! exports provided: BrowserCausalTreeStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BrowserCausalTreeStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BrowserCausalTreeStore */ \"./node_modules/@casual-simulation/causal-tree-store-browser/BrowserCausalTreeStore.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BrowserCausalTreeStore\", function() { return _BrowserCausalTreeStore__WEBPACK_IMPORTED_MODULE_0__[\"BrowserCausalTreeStore\"]; });\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-tree-store-browser/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/AddResult.js":
/*!************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/AddResult.js ***!
  \************************************************************************/
/*! exports provided: mergeIntoBatch */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mergeIntoBatch\", function() { return mergeIntoBatch; });\n/**\n * Merges the given array of atom add results into a single atom batch.\n * @param results The results.\n */\nfunction mergeIntoBatch(results) {\n    let added = results.map(r => r.added).filter(a => a);\n    let rejected = results.map(r => r.rejected).filter(a => a);\n    let archived = results.map(r => r.archived).filter(a => a);\n    return {\n        added,\n        rejected,\n        archived,\n    };\n}\n//# sourceMappingURL=AddResult.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/AddResult.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/Atom.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/Atom.js ***!
  \*******************************************************************/
/*! exports provided: idEquals, atomId, atom, atomMatchesChecksum, atomIdToString */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"idEquals\", function() { return idEquals; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"atomId\", function() { return atomId; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"atom\", function() { return atom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"atomMatchesChecksum\", function() { return atomMatchesChecksum; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"atomIdToString\", function() { return atomIdToString; });\n/* harmony import */ var _casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/crypto */ \"./node_modules/@casual-simulation/crypto/index.js\");\n\n/**\n * Determines if the two given IDs equal each other.\n * @param first\n * @param second\n */\nfunction idEquals(first, second) {\n    return (first === second ||\n        (first &&\n            second &&\n            second.site === first.site &&\n            second.timestamp === first.timestamp &&\n            second.priority === first.priority));\n}\n/**\n * Creates a new Atom ID.\n * @param site\n * @param timestamp\n * @param priority\n */\nfunction atomId(site, timestamp, priority = 0) {\n    return {\n        site,\n        timestamp,\n        priority,\n    };\n}\n/**\n * Creates a new atom.\n * @param id\n * @param cause\n * @param value\n */\nfunction atom(id, cause, value) {\n    const hash = Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"getHashBuffer\"])([id, cause, value]);\n    return {\n        id,\n        cause,\n        value,\n        // Read only 32 bits of the hash.\n        // This should be good enough to prevent collisions for weaves\n        // of up to ~2 billion atoms instead of never.\n        checksum: hash.readUInt32BE(0),\n    };\n}\n/**\n * Verifies that the given atom matches its own checksum.\n * @param atom The atom to check.\n */\nfunction atomMatchesChecksum(atom) {\n    const hash = Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"getHashBuffer\"])([atom.id, atom.cause, atom.value]);\n    const checksum = hash.readUInt32BE(0);\n    return checksum === atom.checksum;\n}\n/**\n * Converts the given atom ID into a string that is suitable for\n * storage.\n * @param id The ID.\n */\nfunction atomIdToString(id) {\n    return `${id.site}@${id.timestamp}:${id.priority}`;\n}\n//# sourceMappingURL=Atom.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/Atom.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/AtomFactory.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/AtomFactory.js ***!
  \**************************************************************************/
/*! exports provided: AtomFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AtomFactory\", function() { return AtomFactory; });\n/* harmony import */ var _Atom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Atom */ \"./node_modules/@casual-simulation/causal-trees/core/Atom.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n/**\n * Defines a class that can create atoms based on a site ID and lamport timestamp.\n */\nclass AtomFactory {\n    /**\n     * Creates a new atom factory with the given site.\n     * @param site The site that this factory creates atoms for.\n     * @param timestamp The timestamp that this factory is starting at.\n     * @param validator The atom validator that should be used to sign atoms.\n     * @param signingKey The key that should be used to sign atoms.\n     */\n    constructor(site, timestamp = 0, validator = null, signingKey = null) {\n        this._site = site;\n        this._time = timestamp;\n        this._validator = validator;\n        this._signingKey = signingKey;\n    }\n    /**\n     * Gets the key that this factory uses to sign atoms.\n     */\n    get signingKey() {\n        return this._signingKey;\n    }\n    /**\n     * Gets the site ID for this factory.\n     */\n    get site() {\n        return this._site.id;\n    }\n    /**\n     * Gets the current lamport time from this factory.\n     */\n    get time() {\n        return this._time;\n    }\n    /**\n     * Updates the timestamp stored by this factory.\n     * @param atom The atom that is being added to the tree.\n     */\n    updateTime(atom) {\n        if (atom.id.site !== this.site) {\n            this._time = Math.max(this._time, atom.id.timestamp) + 1;\n        }\n        else {\n            this._time = Math.max(this._time, atom.id.timestamp);\n        }\n    }\n    /**\n     * Creates a new Atom with the given op.\n     * @param op The operation to include with the atom.\n     * @param cause The parent cause of this atom.\n     */\n    create(op, cause, priority) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let causeId = null;\n            if (cause) {\n                causeId = ((!!cause.id ? cause.id : cause));\n            }\n            this._time += 1;\n            const a = Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atom\"])(Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomId\"])(this.site, this._time, priority), causeId, op);\n            if (this._validator && this._signingKey) {\n                return yield this._validator.sign(this._signingKey, a);\n            }\n            else {\n                return a;\n            }\n        });\n    }\n}\n//# sourceMappingURL=AtomFactory.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/AtomFactory.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/AtomValidator.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/AtomValidator.js ***!
  \****************************************************************************/
/*! exports provided: AtomValidator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AtomValidator\", function() { return AtomValidator; });\n/* harmony import */ var fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fast-json-stable-stringify */ \"fast-json-stable-stringify\");\n/* harmony import */ var fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var base64_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! base64-js */ \"base64-js\");\n/* harmony import */ var base64_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(base64_js__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n/**\n * Defines a class that can produce and validate signatures for atoms.\n */\nclass AtomValidator {\n    /**\n     * Gets the crypto implementation that this validator is using.\n     */\n    get impl() {\n        return this._impl;\n    }\n    /**\n     * Creates a new Atom Validator instance that uses the given crypto implementation.\n     * @param impl The implementation.\n     */\n    constructor(impl) {\n        this._impl = impl;\n    }\n    /**\n     * Signs the given atom with the given private key and returns a new\n     * atom that contains the signature.\n     * @param key The key to sign the atom with.\n     * @param atom The atom to sign.\n     */\n    sign(key, atom) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buffer = this._getData(atom);\n            const signature = yield this._impl.sign(key, buffer);\n            const ints = new Uint8Array(signature);\n            const base64 = Object(base64_js__WEBPACK_IMPORTED_MODULE_1__[\"fromByteArray\"])(ints);\n            return Object.assign({}, atom, { signature: base64 });\n        });\n    }\n    /**\n     * Verifies that the given atom was signed with the private key associated with the given public key.\n     * Returns true if the atom's signature is valid. Returns false if the atom does not have a signature or if the\n     * signature is invalid.\n     * @param key The key to use for decrypting the signature.\n     * @param atom The atom to verify.\n     */\n    verify(key, atom) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!atom.signature) {\n                return false;\n            }\n            const ints = Object(base64_js__WEBPACK_IMPORTED_MODULE_1__[\"toByteArray\"])(atom.signature);\n            const buf = this._getData(atom);\n            return yield this._impl.verify(key, ints, buf);\n        });\n    }\n    /**\n     * Verifies that the given atoms were signed with the private key associated with the given public key.\n     * Returns an array of booleans that represent whether the atom at the corresponding index is valid or not.\n     * @param key The key to use.\n     * @param atoms The atoms to verify.\n     */\n    verifyBatch(key, atoms) {\n        let signatures = new Array(atoms.length);\n        let buffers = new Array(atoms.length);\n        for (let i = 0; i < atoms.length; i++) {\n            const a = atoms[i];\n            signatures[i] = Object(base64_js__WEBPACK_IMPORTED_MODULE_1__[\"toByteArray\"])(a.signature);\n            buffers[i] = this._getData(a);\n        }\n        return this._impl.verifyBatch(key, signatures, buffers);\n    }\n    _getData(atom) {\n        const fields = [atom.id, atom.cause, atom.value];\n        const json = fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_0___default()(fields);\n        const buffer = Buffer.from(json);\n        return buffer;\n    }\n}\n//# sourceMappingURL=AtomValidator.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/AtomValidator.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/CausalTree.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/CausalTree.js ***!
  \*************************************************************************/
/*! exports provided: CausalTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CausalTree\", function() { return CausalTree; });\n/* harmony import */ var _Weave__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Weave */ \"./node_modules/@casual-simulation/causal-trees/core/Weave.js\");\n/* harmony import */ var _AtomFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AtomFactory */ \"./node_modules/@casual-simulation/causal-trees/core/AtomFactory.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _AddResult__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AddResult */ \"./node_modules/@casual-simulation/causal-trees/core/AddResult.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n/**\n * Defines a class that represents a Causal Tree.\n * That is, a conflict-free replicated data type. (CRDT)\n */\nclass CausalTree {\n    /**\n     * Creates a new Causal Tree with the given site ID.\n     * @param tree The stored tree that this causal tree should be made from.\n     * @param reducer The reducer used to convert a list of operations into a single value.\n     * @param options The options to use.\n     */\n    constructor(tree, reducer, options = {}) {\n        this._options = options;\n        this._site = tree.site;\n        this._knownSites = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"unionBy\"])([this.site], tree.knownSites || [], site => site.id);\n        this._validator = options.validator || null;\n        this._keyMap = new Map();\n        this._weave = new _Weave__WEBPACK_IMPORTED_MODULE_0__[\"Weave\"]();\n        this._factory = new _AtomFactory__WEBPACK_IMPORTED_MODULE_1__[\"AtomFactory\"](this._site, 0, this._validator, options.signingKey);\n        this._reducer = reducer;\n        this._value = undefined;\n        this._metadata = undefined;\n        this._dirty = false;\n        this._atomAdded = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._atomArchived = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._atomRejected = new rxjs__WEBPACK_IMPORTED_MODULE_3__[\"Subject\"]();\n        this._isBatching = false;\n        this._batch = [];\n        this._rejected = [];\n        this.garbageCollect = options.garbageCollect || false;\n        if (this._validator &&\n            options.signingKey &&\n            (!tree.site.crypto || !tree.site.crypto.publicKey)) {\n            console.warn(`[CausalTree] Created a tree with a signing key but no public key. This might cause some remotes to reject atoms because they shouldn't be signed.`);\n        }\n    }\n    /**\n     * Gets the site that this causal tree represents.\n     */\n    get site() {\n        return this._site;\n    }\n    /**\n     * Gets the most recent time that this causal tree\n     * has observed.\n     */\n    get time() {\n        return this.factory.time;\n    }\n    /**\n     * Gets the weave stored by this tree.\n     */\n    get weave() {\n        return this._weave;\n    }\n    /**\n     * Gets the atom factory used by this tree.\n     */\n    get factory() {\n        return this._factory;\n    }\n    /**\n     * Gets the currently stored value in the tree.\n     */\n    get value() {\n        if (this._dirty) {\n            [this._value, this._metadata] = this._calculateValue(this._batch);\n        }\n        return this._value;\n    }\n    /**\n     * Gets the currently stored metadata.\n     */\n    get metadata() {\n        return this._metadata;\n    }\n    /**\n     * Gets the list of sites that this tree knows about.\n     */\n    get knownSites() {\n        return this._knownSites;\n    }\n    /**\n     * Gets an observable that resolves whenever a new atom is added to this tree.\n     */\n    get atomAdded() {\n        return this._atomAdded;\n    }\n    /**\n     * Gets an observable that resolves whenever one or more atoms are garbage collected and should be archived.\n     */\n    get atomsArchived() {\n        return this._atomArchived;\n    }\n    /**\n     * Gets an observable that resolves whenever one or more atoms are rejected.\n     */\n    get atomRejected() {\n        return this._atomRejected;\n    }\n    /**\n     * Creates a root element on this tree.\n     */\n    root() {\n        throw new Error('Must be implemented in inheriting class');\n    }\n    /**\n     * Adds the given atom to this Causal Tree's history.\n     * @param atom The atom to add to the tree.\n     * @param verifySignature Whether to verify the signature on the given atom. (Default true)\n     */\n    add(atom, verifySignature = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (verifySignature) {\n                const [rej] = yield this._validate([atom]);\n                if (rej) {\n                    if (this._isBatching) {\n                        this._rejected.push(rej);\n                    }\n                    else {\n                        this._atomRejected.next([rej]);\n                    }\n                    return {\n                        added: null,\n                        rejected: rej,\n                    };\n                }\n            }\n            this.factory.updateTime(atom);\n            let [ref, rejected] = this.weave.insert(atom);\n            let archived;\n            if (ref) {\n                if (this._isBatching) {\n                    this._batch.push(ref);\n                    this._dirty = true;\n                }\n                else {\n                    const refs = [ref];\n                    const removed = this.triggerGarbageCollection(refs);\n                    const left = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"difference\"])(refs, removed);\n                    ref = left[0] || null;\n                    archived = removed[0];\n                    [this._value, this._metadata] = this._calculateValue(left);\n                    this._atomAdded.next(left);\n                }\n            }\n            if (rejected) {\n                if (this._isBatching) {\n                    this._rejected.push(rejected);\n                }\n                else {\n                    this._atomRejected.next([rejected]);\n                }\n            }\n            return {\n                added: ref,\n                rejected: rejected,\n                archived: archived,\n            };\n        });\n    }\n    /**\n     * Adds the given list of references to this causal tree's history.\n     * @param refs The references to add.\n     * @param verifySignatures Whether to verify that the signatures on the atoms are valid. (Default false)\n     */\n    addMany(refs, verifySignatures = false, loadingCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            loadingCallback = loadingCallback || (() => { });\n            if (verifySignatures) {\n                loadingCallback({\n                    message: `Validating ${refs.length} atoms...`,\n                });\n                const invalid = yield this._validate(refs);\n                if (invalid.length > 0) {\n                    return {\n                        added: [],\n                        rejected: invalid,\n                        archived: [],\n                    };\n                }\n            }\n            loadingCallback({\n                message: `Sorting ${refs.length} atoms...`,\n            });\n            const atoms = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(refs, a => a.id.timestamp);\n            loadingCallback({\n                message: `Adding ${refs.length} atoms...`,\n                progressPercent: 0,\n            });\n            return yield this.batch(() => __awaiter(this, void 0, void 0, function* () {\n                let added = [];\n                let rejected = [];\n                for (let i = 0; i < atoms.length; i++) {\n                    let atom = atoms[i];\n                    if (atom) {\n                        let { added: result, rejected: rej } = yield this.add(atom, verifySignatures);\n                        if (result) {\n                            added.push(result);\n                        }\n                        if (rej) {\n                            rejected.push(rej);\n                        }\n                    }\n                    loadingCallback({\n                        progressPercent: i / atoms.length,\n                    });\n                }\n                return { added, rejected, archived: [] };\n            }));\n        });\n    }\n    /**\n     * Batches all the operations in the given function so that\n     * only a single notification is sent.\n     * @param func\n     */\n    batch(func) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._isBatching) {\n                return yield func();\n            }\n            let added = [];\n            let rejected = [];\n            let archived = [];\n            try {\n                this._isBatching = true;\n                let result = yield func();\n                if (result) {\n                    ({ added, rejected, archived } = result);\n                }\n            }\n            finally {\n                if (this._batch.length > 0) {\n                    let removed = this.triggerGarbageCollection(this._batch);\n                    let left = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"difference\"])(this._batch, removed);\n                    this._batch = left;\n                    archived = removed;\n                    [this._value, this._metadata] = this._calculateValue(this._batch);\n                    this._atomAdded.next(this._batch);\n                    this._batch = [];\n                }\n                if (this._rejected.length > 0) {\n                    this._atomRejected.next(this._rejected);\n                    this._rejected = [];\n                }\n                this._isBatching = false;\n            }\n            return {\n                added,\n                rejected,\n                archived,\n            };\n        });\n    }\n    /**\n     * Imports the given list of weave references into the tree.\n     * The references are expected to be sorted as a valid weave and also to match\n     * @param refs The references to import.\n     * @param validate Whether to validate the incoming weave.\n     * @param verifySignatures Whether to verify the signatures of the incoming atoms. (Default false)\n     */\n    importWeave(refs, validate = true, verifySignatures = false, loadingCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            loadingCallback = loadingCallback || (() => { });\n            if (validate) {\n                let weave = new _Weave__WEBPACK_IMPORTED_MODULE_0__[\"Weave\"]();\n                loadingCallback({\n                    message: `Importing ${refs.length} atoms...`,\n                });\n                weave.import(refs);\n                if (!weave.isValid()) {\n                    loadingCallback({\n                        error: 'Imported references are not valid.',\n                    });\n                    throw new Error('[CausalTree] Imported references are not valid.');\n                }\n            }\n            if (verifySignatures) {\n                loadingCallback({\n                    message: `Verifying ${refs.length} atoms...`,\n                });\n                const bad = yield this._validate(refs);\n                if (bad.length > 0) {\n                    this._atomRejected.next(bad);\n                    return {\n                        added: [],\n                        rejected: bad,\n                        archived: [],\n                    };\n                }\n            }\n            loadingCallback({\n                message: 'Updating atom factory time...',\n            });\n            const [newAtoms, rejected] = this.weave.import(refs);\n            const sortedAtoms = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"sortBy\"])(newAtoms, a => a.id.timestamp);\n            for (let i = 0; i < sortedAtoms.length; i++) {\n                const atom = sortedAtoms[i];\n                this.factory.updateTime(atom);\n            }\n            // if (!this.weave.isValid()) {\n            //     throw new Error('[CausalTree] Tree became invalid after import.');\n            // }\n            loadingCallback({\n                message: 'Running atom garbage collection...',\n            });\n            let archived = this.triggerGarbageCollection(newAtoms);\n            let left = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"difference\"])(newAtoms, archived);\n            // if (!this.weave.isValid()) {\n            //     throw new Error('[CausalTree] Tree became invalid after garbage collection.');\n            // }\n            [this._value, this._metadata] = this._calculateValue(left);\n            if (rejected) {\n                this._atomRejected.next(rejected);\n            }\n            return {\n                added: newAtoms,\n                rejected: rejected,\n                archived: archived,\n            };\n        });\n    }\n    /**\n     * Imports the given tree into this one and returns the list of atoms that were imported.\n     * @param tree The tree to import.\n     * @param verifySignatures Whether to verify the signatures of the incoming atoms. (Default false)\n     */\n    import(tree, verifySignatures = false, loadingCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            loadingCallback = loadingCallback || (() => { });\n            if (tree.knownSites) {\n                tree.knownSites.forEach(s => {\n                    this.registerSite(s);\n                });\n            }\n            let added;\n            if (tree.weave) {\n                if (tree.formatVersion === 2) {\n                    added = yield this.importWeave(tree.weave, true, verifySignatures, loadingCallback);\n                }\n                else if (tree.formatVersion === 3) {\n                    if (tree.ordered) {\n                        added = yield this.importWeave(tree.weave, true, verifySignatures, loadingCallback);\n                    }\n                    else {\n                        added = yield this.addMany(tree.weave, verifySignatures, loadingCallback);\n                    }\n                }\n                else if (typeof tree.formatVersion === 'undefined') {\n                    added = yield this.importWeave(tree.weave.map(ref => ref.atom), true, verifySignatures, loadingCallback);\n                }\n                else {\n                    console.warn(\"[CausalTree] Don't know how to import tree version:\", tree.formatVersion);\n                    added = {\n                        added: [],\n                        rejected: [],\n                        archived: [],\n                    };\n                }\n            }\n            return added;\n        });\n    }\n    /**\n     * Exports this tree into a storable format.\n     */\n    export() {\n        return {\n            formatVersion: 3,\n            site: this._site,\n            ordered: true,\n            knownSites: this.knownSites.slice(),\n            weave: this.weave.atoms.slice(),\n        };\n    }\n    /**\n     * Creates a new atom and adds it to the tree's history.\n     * @param op The operation to store in the atom.\n     * @param parent The parent atom.\n     * @param priority The priority.\n     */\n    create(op, parent, priority) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const atom = yield this.factory.create(op, parent, priority);\n            return yield this.add(atom);\n        });\n    }\n    /**\n     * Creates a new atom from the given precalculated operation and adds it to the tree's history.\n     * @param precalc The operation to create and add.\n     */\n    createFromPrecalculated(precalc) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (precalc) {\n                return yield this.create(precalc.op, precalc.cause, precalc.priority);\n            }\n            else {\n                return null;\n            }\n        });\n    }\n    /**\n     * Creates a new atom from the given precalculated operation and adds it to the tree's history.\n     * @param precalc The operation to create and add.\n     */\n    createManyFromPrecalculated(precalc) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const nonNull = precalc.filter(pc => !!pc);\n            const promises = nonNull.map(pc => this.createFromPrecalculated(pc));\n            let results = yield Promise.all(promises);\n            return Object(_AddResult__WEBPACK_IMPORTED_MODULE_4__[\"mergeIntoBatch\"])(results);\n        });\n    }\n    /**\n     * Registers the given site in this tree's known sites list.\n     * @param site The site.\n     */\n    registerSite(site) {\n        let existing = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"find\"])(this._knownSites, s => s.id === site.id);\n        if (!existing) {\n            this._knownSites.push(site);\n        }\n    }\n    /**\n     * Gets the version of the tree.\n     */\n    getVersion() {\n        return {\n            site: this.site,\n            knownSites: this.knownSites,\n            version: this.weave.getVersion(),\n        };\n    }\n    /**\n     * Forks the given causal tree and returns a new tree that contains the same state.\n     * Note that this method should be overridden in child classes to ensure that the proper type\n     * is being created.\n     * @param type The type of the tree that is being forked.\n     * @param tree The tree to fork.\n     */\n    fork() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = this.export();\n            const tree = new CausalTree(stored, this._reducer, this._options);\n            yield tree.import(stored);\n            return tree;\n        });\n    }\n    /**\n     * Performs garbage collection of the tree's weave after a set of atoms were added to the tree.\n     * Returns the references that were removed from the tree.\n     * @param refs The weave references that were added to the tree.\n     */\n    collectGarbage(refs) {\n        return [];\n    }\n    /**\n     * Triggers a round of garbage collection on the given atoms.\n     * @param atoms The atoms to garbage collect.\n     */\n    triggerGarbageCollection(atoms) {\n        if (this.garbageCollect) {\n            const removed = this.collectGarbage(atoms);\n            if (removed.length > 0) {\n                this._atomArchived.next(removed);\n            }\n            return removed;\n        }\n        return [];\n    }\n    /**\n     * Recalculates the values associated the given references.\n     * This can be used as a performance improvement to only recalculate the parts of the\n     * tree's value that were affected by the additions.\n     * @param refs The references that were added to the tree.\n     */\n    recalculateValues(refs) { }\n    /**\n     * Ensures that the given atom is valid.\n     * @param atom The atom to validate.\n     */\n    _validate(atoms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const grouped = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"groupBy\"])(atoms, a => a.id.site);\n            const sites = Object.keys(grouped);\n            let rejected = [];\n            for (let i = 0; i < sites.length; i++) {\n                const site = sites[i];\n                const siteAtoms = grouped[site];\n                const key = yield this._getPublicKey(parseInt(site));\n                const first = siteAtoms[0];\n                if (key) {\n                    const valid = yield this._validator.verifyBatch(key, siteAtoms);\n                    const rej = valid\n                        .map((v, i) => {\n                        if (!v) {\n                            return {\n                                atom: siteAtoms[i],\n                                reason: 'signature_failed',\n                            };\n                        }\n                        return null;\n                    })\n                        .filter(a => a);\n                    rejected.push(...rej);\n                }\n                else if (!key &&\n                    !!first.signature &&\n                    this._validator &&\n                    this._validator.impl.supported()) {\n                    rejected.push({\n                        atom: first,\n                        reason: 'no_public_key',\n                    });\n                }\n            }\n            return rejected;\n        });\n    }\n    /**\n     * Gets the public key for the given site.\n     * If the site does not have a public key, then null is returned.\n     * @param siteId The site that the public key should be retrieved for.\n     */\n    _getPublicKey(siteId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let key = this._keyMap.get(siteId);\n            if (!key) {\n                const site = Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"find\"])(this.knownSites, s => s.id === siteId);\n                if (site &&\n                    site.crypto &&\n                    site.crypto.publicKey &&\n                    this._validator &&\n                    this._validator.impl.supported()) {\n                    key = yield this._validator.impl.importPublicKey(site.crypto.publicKey);\n                }\n                if (key) {\n                    this._keyMap.set(siteId, key);\n                }\n            }\n            return key;\n        });\n    }\n    _calculateValue(refs) {\n        this._dirty = false;\n        return this._reducer.eval(this._weave, refs, this._value, this._metadata);\n    }\n}\n//# sourceMappingURL=CausalTree.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/CausalTree.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/CausalTreeFactory.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/CausalTreeFactory.js ***!
  \********************************************************************************/
/*! exports provided: CausalTreeFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CausalTreeFactory\", function() { return CausalTreeFactory; });\n/**\n * Defines a class that is able to create new causal trees from a given type.\n */\nclass CausalTreeFactory {\n    constructor(map) {\n        this._map = map;\n    }\n    /**\n     * Creates a new Causal Tree.\n     * @param type The type of tree to create.\n     * @param site The info of the site.\n     */\n    create(type, storedTree, options) {\n        const factory = this._map[type];\n        if (factory) {\n            return factory(storedTree, options);\n        }\n        else {\n            return null;\n        }\n    }\n}\n//# sourceMappingURL=CausalTreeFactory.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/CausalTreeFactory.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/CausalTreeStoreHelpers.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/CausalTreeStoreHelpers.js ***!
  \*************************************************************************************/
/*! exports provided: bindChangesToStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindChangesToStore\", function() { return bindChangesToStore; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Atom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Atom */ \"./node_modules/@casual-simulation/causal-trees/core/Atom.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n/**\n * Listens for new atoms from the given tree and pipes them into the given store at the given ID.\n * @param id The ID that the atoms should be stored at.\n * @param tree The tree that should be continually stored.\n * @param store The store that the tree should be stored in.\n */\nfunction bindChangesToStore(id, tree, store) {\n    let sub = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subscription\"]();\n    sub.add(tree.atomsArchived\n        .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"bufferTime\"])(1000), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"filter\"])(batch => batch.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"flatMap\"])(batch => batch), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"concatMap\"])((refs) => __awaiter(this, void 0, void 0, function* () {\n        const atoms = refs.map(r => r);\n        yield store.add(id, atoms, true);\n    })))\n        .subscribe(null, err => console.error(err)));\n    sub.add(tree.atomAdded\n        .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"bufferTime\"])(1000), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"filter\"])(batch => batch.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"flatMap\"])(batch => batch), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"concatMap\"])((atoms) => __awaiter(this, void 0, void 0, function* () {\n        yield store.add(id, atoms, false);\n        let stored = tree.export();\n        stored.weave = [];\n        yield store.put(id, stored, false);\n    })))\n        .subscribe(null, err => console.error(err)));\n    sub.add(tree.atomRejected\n        .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"bufferTime\"])(1000), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"filter\"])(batch => batch.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"flatMap\"])(batch => batch), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"flatMap\"])(batch => batch), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"tap\"])(ref => {\n        console.warn(`[CausalTreeSever] ${id}: Atom (${Object(_Atom__WEBPACK_IMPORTED_MODULE_2__[\"atomIdToString\"])(ref.atom.id)}) rejected: ${ref.reason}`);\n    }))\n        .subscribe(null, err => console.error(err)));\n    return sub;\n}\n//# sourceMappingURL=CausalTreeStoreHelpers.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/CausalTreeStoreHelpers.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/DeviceInfo.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/DeviceInfo.js ***!
  \*************************************************************************/
/*! exports provided: USER_ROLE, ADMIN_ROLE, SERVER_ROLE, GUEST_ROLE, USERNAME_CLAIM, DEVICE_ID_CLAIM, SESSION_ID_CLAIM */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"USER_ROLE\", function() { return USER_ROLE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ADMIN_ROLE\", function() { return ADMIN_ROLE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SERVER_ROLE\", function() { return SERVER_ROLE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GUEST_ROLE\", function() { return GUEST_ROLE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"USERNAME_CLAIM\", function() { return USERNAME_CLAIM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEVICE_ID_CLAIM\", function() { return DEVICE_ID_CLAIM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SESSION_ID_CLAIM\", function() { return SESSION_ID_CLAIM; });\n/**\n * Defines a role that identifies the device as a user with basic access to a channel.\n */\nconst USER_ROLE = 'user';\n/**\n * Defines a role that identifies the device as an admin.\n */\nconst ADMIN_ROLE = 'admin';\n/**\n * Defines a role that identifies the device as the server.\n */\nconst SERVER_ROLE = 'server';\n/**\n * Defines a role that identifies the device as a guest.\n */\nconst GUEST_ROLE = 'guest';\n/**\n * Defines a claim that gets the username that the device is representing.\n */\nconst USERNAME_CLAIM = 'username';\n/**\n * Defines a claim that gets the ID of the device.\n */\nconst DEVICE_ID_CLAIM = 'device_id';\n/**\n * Defines a claim that gets the ID of the session.\n */\nconst SESSION_ID_CLAIM = 'session_id';\n//# sourceMappingURL=DeviceInfo.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/DeviceInfo.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/Event.js":
/*!********************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/Event.js ***!
  \********************************************************************/
/*! exports provided: remote, device */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"remote\", function() { return remote; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"device\", function() { return device; });\n/**\n * Creates a new remote event.\n * @param event The event.\n */\nfunction remote(event, selector) {\n    return Object.assign({ type: 'remote', event: event }, selector);\n}\n/**\n * Creates a new device event.\n * @param info The info about the device that is sending the event.\n * @param event The event that is being sent.\n */\nfunction device(info, event) {\n    return {\n        type: 'device',\n        device: info,\n        event: event,\n    };\n}\n//# sourceMappingURL=Event.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/Event.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/LocalRealtimeCausalTree.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/LocalRealtimeCausalTree.js ***!
  \**************************************************************************************/
/*! exports provided: LocalRealtimeCausalTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LocalRealtimeCausalTree\", function() { return LocalRealtimeCausalTree; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\nclass LocalRealtimeCausalTree {\n    constructor(tree, options) {\n        this.tree = tree;\n        this._subs = [];\n        this._updated = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._rejected = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._status = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this.onError = Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"never\"])();\n    }\n    get onUpdated() {\n        return this._updated;\n    }\n    get statusUpdated() {\n        return this._status;\n    }\n    get onRejected() {\n        return this._rejected;\n    }\n    get events() {\n        return Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"never\"])();\n    }\n    connect(loadingCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._subs.push(this.tree.atomAdded.subscribe(this._updated), this.tree.atomRejected.subscribe(this._rejected));\n            this._status.next({\n                type: 'sync',\n                synced: true,\n            });\n        });\n    }\n    waitUntilSynced() {\n        return Promise.resolve();\n    }\n    getVersion() {\n        return this.tree.getVersion();\n    }\n    unsubscribe() {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        this.tree = null;\n        this._updated.unsubscribe();\n        this._updated = null;\n        this._rejected.unsubscribe();\n        this._rejected = null;\n        this._subs.forEach(s => s.unsubscribe());\n        this._subs = [];\n    }\n}\n//# sourceMappingURL=LocalRealtimeCausalTree.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/LocalRealtimeCausalTree.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/NullCausalTreeStore.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/NullCausalTreeStore.js ***!
  \**********************************************************************************/
/*! exports provided: NullCausalTreeStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullCausalTreeStore\", function() { return NullCausalTreeStore; });\nclass NullCausalTreeStore {\n    init() {\n        return Promise.resolve();\n    }\n    put(id, tree, fullUpdate) {\n        return Promise.resolve();\n    }\n    add(id, atoms, archived) {\n        return Promise.resolve();\n    }\n    get(id, archived) {\n        return Promise.resolve(null);\n    }\n    putKeys(id, privateKey, publicKey) {\n        return Promise.resolve();\n    }\n    getKeys(id) {\n        return Promise.resolve(null);\n    }\n}\n//# sourceMappingURL=NullCausalTreeStore.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/NullCausalTreeStore.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/PrecalculatedOp.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/PrecalculatedOp.js ***!
  \******************************************************************************/
/*! exports provided: precalculatedOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"precalculatedOp\", function() { return precalculatedOp; });\n/**\n * Creates a new precalculated operation.\n * @param op\n * @param cause\n */\nfunction precalculatedOp(op, cause = null, priority) {\n    return {\n        op,\n        cause,\n        priority,\n    };\n}\n//# sourceMappingURL=PrecalculatedOp.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/PrecalculatedOp.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/RealtimeChannelImpl.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/RealtimeChannelImpl.js ***!
  \**********************************************************************************/
/*! exports provided: RealtimeChannelImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RealtimeChannelImpl\", function() { return RealtimeChannelImpl; });\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * Defines a class that represents an active connection to a channel.\n * Manages the login state for the channel.\n */\nclass RealtimeChannelImpl {\n    get connection() {\n        return this._connection;\n    }\n    /**\n     * The observable list of status updates from this channel.\n     */\n    get statusUpdated() {\n        return this._status;\n    }\n    get user() {\n        return this._user.value;\n    }\n    constructor(connection, user) {\n        this._connection = connection;\n        this._user = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorSubject\"](user);\n        this._grants = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorSubject\"](null);\n        this._status = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subject\"]();\n        this._sub = new rxjs__WEBPACK_IMPORTED_MODULE_0__[\"Subscription\"]();\n    }\n    connect() {\n        this._sub.add(this._connection.connectionStateChanged\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"combineLatest\"])(this.user ? this._user : this._user.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"skip\"])(1)), this._grants), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"switchMap\"])(([state, user, grant]) => this._connectionStateChanged(state, user, grant)))\n            .subscribe());\n        this._sub.add(this._connection);\n        this._connection.connect();\n    }\n    setGrant(grant) {\n        this._grants.next(grant);\n    }\n    setUser(user) {\n        this._user.next(user);\n    }\n    _connectionStateChanged(state, user, grant) {\n        this._status.next({\n            type: 'connection',\n            connected: state,\n        });\n        if (!state || !user) {\n            this._status.next({\n                type: 'authorization',\n                authorized: null,\n            });\n            this._status.next({\n                type: 'authentication',\n                authenticated: null,\n            });\n            return Object(rxjs__WEBPACK_IMPORTED_MODULE_0__[\"never\"])();\n        }\n        return this._authenticate(user, grant).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"filter\"])(authenticated => authenticated), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"switchMap\"])(a => this._authorize()), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(() => { }));\n    }\n    _authenticate(user, grant) {\n        console.log('[RealtimeChannelImpl] Authenticating...');\n        return this._connection\n            .login(Object.assign({}, user, { grant }))\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(loginResponse => {\n            if (!loginResponse.success) {\n                if (loginResponse.error.type === 'not_authenticated') {\n                    this._status.next({\n                        type: 'authentication',\n                        authenticated: false,\n                        reason: loginResponse.error.reason,\n                    });\n                }\n                return false;\n            }\n            else {\n                console.log('[RealtimeChannelImpl] Authenticated!');\n                this._status.next({\n                    type: 'authentication',\n                    authenticated: true,\n                    user: user,\n                    info: loginResponse.value,\n                });\n                return true;\n            }\n        }));\n    }\n    _authorize() {\n        console.log('[RealtimeChannelImpl] Joining Channel...');\n        return this._connection.joinChannel().pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__[\"map\"])(joinResponse => {\n            if (!joinResponse.success) {\n                if (joinResponse.error.type === 'not_authorized') {\n                    this._status.next({\n                        type: 'authorization',\n                        authorized: false,\n                        reason: joinResponse.error.reason,\n                    });\n                }\n                return false;\n            }\n            else {\n                console.log('[RealtimeChannelImpl] Joined!');\n                this._status.next({\n                    type: 'authorization',\n                    authorized: true,\n                });\n                return true;\n            }\n        }));\n    }\n    unsubscribe() {\n        this._sub.unsubscribe();\n    }\n    get closed() {\n        return this._sub.closed;\n    }\n}\n//# sourceMappingURL=RealtimeChannelImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/RealtimeChannelImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/SiteIdInfo.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/SiteIdInfo.js ***!
  \*************************************************************************/
/*! exports provided: site */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"site\", function() { return site; });\n/**\n * Creates a new SiteInfo object with the given ID.\n * @param id The ID.\n */\nfunction site(id, crypto) {\n    return {\n        id: id,\n        crypto,\n    };\n}\n//# sourceMappingURL=SiteIdInfo.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/SiteIdInfo.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/StatusUpdateUtils.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/StatusUpdateUtils.js ***!
  \********************************************************************************/
/*! exports provided: remapProgressPercent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"remapProgressPercent\", function() { return remapProgressPercent; });\nfunction remapProgressPercent(start, end) {\n    let ratio = end - start;\n    return (msg) => {\n        if (msg.type !== 'progress') {\n            return msg;\n        }\n        let realProgress = start + ratio * msg.progress;\n        return Object.assign({}, msg, { progress: realProgress });\n    };\n}\n//# sourceMappingURL=StatusUpdateUtils.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/StatusUpdateUtils.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/StoredCausalTree.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/StoredCausalTree.js ***!
  \*******************************************************************************/
/*! exports provided: currentFormatVersion, storedTree, upgrade */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"currentFormatVersion\", function() { return currentFormatVersion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"storedTree\", function() { return storedTree; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"upgrade\", function() { return upgrade; });\nconst currentFormatVersion = 3;\n/**\n * Creates a stored causal tree with the given data.\n * @param site\n * @param knownSites\n * @param weave\n */\nfunction storedTree(site, knownSites = null, weave = null) {\n    return {\n        formatVersion: currentFormatVersion,\n        site: site,\n        knownSites: knownSites,\n        weave: weave,\n        ordered: true,\n    };\n}\n/**\n * Upgrades the given stored causal tree to the latest version.\n * @param stored The stored tree.\n */\nfunction upgrade(stored) {\n    if (!stored) {\n        return null;\n    }\n    if (stored.formatVersion === 3) {\n        return stored;\n    }\n    else if (stored.formatVersion === 2) {\n        return {\n            formatVersion: 3,\n            knownSites: stored.knownSites,\n            site: stored.site,\n            weave: stored.weave,\n            ordered: true,\n        };\n    }\n    else if (typeof stored.formatVersion === 'undefined') {\n        return {\n            formatVersion: 3,\n            knownSites: stored.knownSites,\n            site: stored.site,\n            weave: stored.weave ? stored.weave.map(a => a.atom) : null,\n            ordered: true,\n        };\n    }\n    else {\n        throw new Error(`[StoredCausalTree] Unable to update the given tree version ${stored.formatVersion}`);\n    }\n}\n//# sourceMappingURL=StoredCausalTree.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/StoredCausalTree.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/SyncedRealtimeCausalTree.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/SyncedRealtimeCausalTree.js ***!
  \***************************************************************************************/
/*! exports provided: SyncedRealtimeCausalTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SyncedRealtimeCausalTree\", function() { return SyncedRealtimeCausalTree; });\n/* harmony import */ var _SiteIdInfo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SiteIdInfo */ \"./node_modules/@casual-simulation/causal-trees/core/SiteIdInfo.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"rxjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ \"rxjs/operators\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _StoredCausalTree__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./StoredCausalTree */ \"./node_modules/@casual-simulation/causal-trees/core/StoredCausalTree.js\");\n/* harmony import */ var _WeaveVersion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./WeaveVersion */ \"./node_modules/@casual-simulation/causal-trees/core/WeaveVersion.js\");\n/* harmony import */ var _StatusUpdateUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./StatusUpdateUtils */ \"./node_modules/@casual-simulation/causal-trees/core/StatusUpdateUtils.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n\n\n\n\n/**\n * Defines a synced realtime causal tree.\n * That is, an object that is able to keep a causal tree updated\n * based on events from a realtime channel.\n */\nclass SyncedRealtimeCausalTree {\n    /**\n     * Creates a new Realtime Causal Tree.\n     * @param type The type of the tree.\n     * @param factory The factory used to create new trees.\n     * @param store The store used to persistently store the tree.\n     * @param channel The channel used to communicate with other devices.\n     * @param options The options that should be used for the causal tree.\n     */\n    constructor(factory, store, channel, options) {\n        this.closed = false;\n        this._synced = false;\n        this._factory = factory;\n        this._store = store;\n        this._channel = channel;\n        this._updated = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._errors = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._rejected = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._status = new rxjs__WEBPACK_IMPORTED_MODULE_1__[\"Subject\"]();\n        this._tree = ((options ? options.tree : null) || null);\n        this._subs = [];\n        this._options = options || {};\n        this._storeAtoms =\n            typeof this._options.storeAtoms === 'undefined'\n                ? true\n                : this._options.storeAtoms;\n        this._bufferTime =\n            typeof this._options.bufferTimeSpan === 'undefined'\n                ? 1000\n                : this._options.bufferTimeSpan;\n        this._channel.statusUpdated.subscribe(this._status);\n        if (this._storeAtoms) {\n            this._subs.push(this._updated\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(a => a.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"bufferTime\"])(1000), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"concatMap\"])(atoms => atoms), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"concatMap\"])((atoms) => __awaiter(this, void 0, void 0, function* () { return yield this._store.add(this.id, atoms); })))\n                .subscribe(null, err => this._errors.next(err)));\n        }\n    }\n    /**\n     * Gets the realtime channel that this tree is using.\n     */\n    get channel() {\n        return this._channel;\n    }\n    /**\n     * Gets the tree that this class is currently wrapping.\n     */\n    get tree() {\n        return this._tree;\n    }\n    /**\n     * Gets the ID of the tree.\n     */\n    get id() {\n        return this._channel.connection.info.id;\n    }\n    /**\n     * Gets the type of the tree.\n     */\n    get type() {\n        return this._channel.connection.info.type;\n    }\n    /**\n     * Gets an observable that resolves whenever this tree is updated.\n     */\n    get onUpdated() {\n        return this._updated;\n    }\n    /**\n     * Gets an observable that resolves whenever an error happens in this tree.\n     */\n    get onError() {\n        return this._errors;\n    }\n    /**\n     * Gets an observable that resolves whenever an atom is rejected.\n     */\n    get onRejected() {\n        return this._rejected;\n    }\n    get statusUpdated() {\n        return this._status;\n    }\n    get events() {\n        return this._channel.connection.events;\n    }\n    /**\n     * Initializes the realtime causal tree.\n     */\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Skip using the stored tree if\n            // we should always load from the server.\n            if (!this._tree && !this._alwaysRequestNewSiteId) {\n                yield this._loadTreeFromStore();\n            }\n            else {\n                console.log(`[RealtimeCausalTree] Using pre-configured tree.`);\n            }\n            this._subs.push(this._channel.statusUpdated.subscribe(status => this._channelStatusUpdated(status), err => this._errors.next(err)));\n            this._subs.push(this._channel.connection.atoms\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(e => this.tree !== null), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"concatMap\"])(e => this.tree.addMany(e)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(refs => this._updated.next(refs.added)))\n                .subscribe(null, err => this._errors.next(err)));\n            this._subs.push(this._channel.connection.sites\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(e => this.tree !== null), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(site => {\n                console.log(`[RealtimeCausalTree] ${this.id}: Discovered new site from server:`, site);\n                this.tree.registerSite(site);\n            }))\n                .subscribe(null, err => this._errors.next(err)));\n            this._status.next({\n                type: 'progress',\n                message: 'Connecting to server...',\n                progress: 0.1,\n            });\n            this.channel.connect();\n        });\n    }\n    waitUntilSynced() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._synced) {\n                return;\n            }\n            yield this._status\n                .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"first\"])(a => a.type === 'sync' && a.synced))\n                .toPromise();\n        });\n    }\n    _channelStatusUpdated(status) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (status.type === 'authorization') {\n                if (status.authorized) {\n                    console.log('[SyncedRealtimeCausalTree] Syncing with the server...');\n                    yield this._sync();\n                    this._synced = true;\n                    this._updateSyncedStatus();\n                    return;\n                }\n                else {\n                    this._synced = false;\n                    this._updateSyncedStatus();\n                }\n            }\n        });\n    }\n    _loadTreeFromStore() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._updateStatus({\n                type: 'message',\n                source: 'SyncedRealtimeCausalTree',\n                message: 'Checking for stored causal tree...',\n            });\n            const stored = yield this._store.get(this.id, false);\n            if (stored) {\n                this._updateStatus({\n                    type: 'message',\n                    source: 'SyncedRealtimeCausalTree',\n                    message: 'Retrieving stored keys...',\n                });\n                const keys = yield this._store.getKeys(this.id);\n                let tree;\n                if (keys) {\n                    this._updateStatus({\n                        type: 'message',\n                        source: 'SyncedRealtimeCausalTree',\n                        message: 'Importing private signing key...',\n                    });\n                    const signingKey = yield this._options.validator.impl.importPrivateKey(keys.privateKey);\n                    tree = this._createTree({\n                        site: Object(_SiteIdInfo__WEBPACK_IMPORTED_MODULE_0__[\"site\"])(stored.site.id, {\n                            signatureAlgorithm: 'ECDSA-SHA256-NISTP256',\n                            publicKey: keys.publicKey,\n                        }),\n                        signingKey: signingKey,\n                    }, stored.knownSites);\n                }\n                else {\n                    this._updateStatus({\n                        type: 'message',\n                        source: 'SyncedRealtimeCausalTree',\n                        message: 'Creating new casual tree...',\n                    });\n                    tree = (this._factory.create(this.type, stored, this._options));\n                }\n                this._listenForRejectedAtoms(tree);\n                this._updateStatus({\n                    type: 'message',\n                    source: 'SyncedRealtimeCausalTree',\n                    message: 'Importing stored tree...',\n                });\n                yield tree.import(stored, undefined);\n                this._setTree(tree);\n                this._updateStatus({\n                    type: 'message',\n                    source: 'SyncedRealtimeCausalTree',\n                    message: 'Updating stored tree...',\n                });\n                yield this._putTree(tree, true);\n            }\n        });\n    }\n    _sync() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.tree === null) {\n                this._status.next({\n                    type: 'progress',\n                    message: 'Loading data...',\n                    progress: 0.2,\n                });\n                yield this._loadTreeFromServer();\n            }\n            else {\n                yield this._updateTreeFromServer();\n            }\n            return true;\n        });\n    }\n    _loadTreeFromServer() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const versionResponse = yield this._channel.connection.exchangeInfo(this.getVersion());\n            const version = versionResponse.value;\n            const site = yield this._requestSiteId(this.id, version);\n            const tree = this._createTree(site, version.knownSites);\n            this._listenForRejectedAtoms(tree);\n            const imported = yield this._channel.connection.exchangeWeaves(tree.export());\n            const added = yield this._import(tree, imported.value);\n            yield this._putTree(tree, false);\n            this._setTree(tree);\n            this._updated.next(added);\n        });\n    }\n    _updateTreeFromServer() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const localVersion = this.getVersion();\n            const versionResponse = yield this._channel.connection.exchangeInfo(localVersion);\n            const remoteVersion = versionResponse.value;\n            if (Object(_WeaveVersion__WEBPACK_IMPORTED_MODULE_5__[\"versionsEqual\"])(localVersion.version, remoteVersion.version)) {\n                return;\n            }\n            const weaveResponse = yield this._channel.connection.exchangeWeaves(this.tree.export());\n            const weave = weaveResponse.value;\n            const added = yield this._import(this.tree, weave);\n            this._importKnownSites(remoteVersion);\n            yield this._putTree(this._tree, true);\n            this._updated.next(added);\n        });\n    }\n    _updateSyncedStatus() {\n        this._status.next({\n            type: 'sync',\n            synced: this._synced,\n        });\n    }\n    _updateStatus(status) {\n        this._status.next(status);\n    }\n    /**\n     * Returns a promise that waits to get the tree from the server if it hasn't been retrieved yet.\n     */\n    waitToGetTreeFromServer() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.tree) {\n                yield this.waitForUpdateFromServer();\n                this._updateStatus({\n                    type: 'message',\n                    source: 'SyncedRealtimeCausalTree',\n                    message: 'Tree initialization complete.',\n                });\n            }\n        });\n    }\n    /**\n     * Returns a promise that waits for an update from the server.\n     */\n    waitForUpdateFromServer() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.onUpdated.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"first\"])()).toPromise();\n        });\n    }\n    /**\n     * Gets the version info from the tree.\n     */\n    getVersion() {\n        if (this.tree) {\n            return this.tree.getVersion();\n        }\n        else {\n            return {\n                site: null,\n                knownSites: null,\n                version: null,\n            };\n        }\n    }\n    _putTree(tree, fullUpdate) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._storeAtoms) {\n                yield this._store.put(this.id, tree.export(), fullUpdate);\n            }\n        });\n    }\n    get _alwaysRequestNewSiteId() {\n        if (this._options) {\n            return this._options.alwaysRequestNewSiteId || false;\n        }\n        return false;\n    }\n    _createTree(site, knownSites) {\n        const tree = this._factory.create(this.type, Object(_StoredCausalTree__WEBPACK_IMPORTED_MODULE_4__[\"storedTree\"])(site.site, knownSites), Object.assign({}, this._options, { signingKey: site.signingKey }));\n        return tree;\n    }\n    _import(tree, weave) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log(`[RealtimeCausalTree] ${this.id}: Importing ${weave.weave.length} atoms....`);\n            let mapper = Object(_StatusUpdateUtils__WEBPACK_IMPORTED_MODULE_6__[\"remapProgressPercent\"])(0.4, 0.1);\n            let percent = 0;\n            const { added: results } = yield tree.import(weave, this._options.verifyAllSignatures || false, progress => {\n                if (progress.progressPercent) {\n                    percent = progress.progressPercent;\n                }\n                let msg = {\n                    type: 'progress',\n                    progress: percent,\n                    message: progress.message ||\n                        `[RealtimeCausalTree] ${this.id}: Importing ${weave.weave.length} atoms....`,\n                };\n                this._status.next(mapper(msg));\n            });\n            console.log(`[RealtimeCausalTree] ${this.id}: Imported ${results.length} atoms.`);\n            return results;\n        });\n    }\n    _setTree(tree) {\n        this._tree = tree;\n        this._subs.push(this._tree.atomAdded\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"map\"])(refs => refs.filter(ref => ref.id.site === this._tree.site.id)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(refs => refs.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(refs => this._channel.connection.emit(refs)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(ref => this._updated.next(ref)))\n            .subscribe(null, error => this._errors.next(error)));\n    }\n    _listenForRejectedAtoms(tree) {\n        this._subs.push(tree.atomRejected\n            .pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"filter\"])(refs => refs.length > 0), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__[\"tap\"])(refs => this._rejected.next(refs)))\n            .subscribe(null, ex => this._errors.next(ex)));\n    }\n    _importKnownSites(version) {\n        version.knownSites.forEach(site => {\n            this._tree.registerSite(site);\n        });\n    }\n    _requestSiteId(id, serverVersion) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let crypto;\n            let signingKey;\n            if (this._options.validator &&\n                this._options.validator.impl.supported()) {\n                let keys = yield this._store.getKeys(id);\n                if (!keys && this._options.validator) {\n                    console.log(`[RealtimeCausalTree] ${id}: Generating crypto keys...`);\n                    this._updateStatus({\n                        type: 'message',\n                        source: 'SyncedRealtimeCausalTree',\n                        message: 'Generating crypto keys...',\n                    });\n                    const [pubKey, privKey,] = yield this._options.validator.impl.generateKeyPair();\n                    const publicKey = yield this._options.validator.impl.exportKey(pubKey);\n                    const privateKey = yield this._options.validator.impl.exportKey(privKey);\n                    crypto = {\n                        publicKey: publicKey,\n                        signatureAlgorithm: 'ECDSA-SHA256-NISTP256',\n                    };\n                    signingKey = privKey;\n                    yield this._store.putKeys(id, privateKey, publicKey);\n                }\n                else if (keys) {\n                    console.log(`[RealtimeCausalTree] ${id}: Using existing keys...`);\n                    this._updateStatus({\n                        type: 'message',\n                        source: 'SyncedRealtimeCausalTree',\n                        message: 'Using exisiting crypto keys...',\n                    });\n                    crypto = {\n                        publicKey: keys.publicKey,\n                        signatureAlgorithm: 'ECDSA-SHA256-NISTP256',\n                    };\n                    signingKey = yield this._options.validator.impl.importPrivateKey(keys.privateKey);\n                }\n            }\n            if (!crypto) {\n                console.log(`[RealtimeCausalTree] ${id}: Not using crypto.`);\n            }\n            let newestSite = Object(lodash__WEBPACK_IMPORTED_MODULE_3__[\"maxBy\"])(serverVersion.knownSites, site => site.id);\n            let nextSite = newestSite ? newestSite.id : 0;\n            let mySite;\n            let success = false;\n            while (!success) {\n                nextSite += 1;\n                mySite = Object(_SiteIdInfo__WEBPACK_IMPORTED_MODULE_0__[\"site\"])(nextSite, crypto);\n                this._updateStatus({\n                    type: 'message',\n                    source: 'SyncedRealtimeCausalTree',\n                    message: `Requesting site id ${mySite.id} from remote...`,\n                });\n                this._status.next({\n                    type: 'progress',\n                    message: `Requesting site id ${mySite.id} from remote...`,\n                    progress: 0.3,\n                });\n                const result = yield this._channel.connection.requestSiteId(mySite);\n                success = result.value;\n            }\n            return {\n                site: mySite,\n                signingKey: signingKey,\n            };\n        });\n    }\n    unsubscribe() {\n        this._channel.unsubscribe();\n        this._subs.forEach(s => s.unsubscribe());\n        this.closed = true;\n    }\n}\n//# sourceMappingURL=SyncedRealtimeCausalTree.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/SyncedRealtimeCausalTree.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/VirtualArray.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/VirtualArray.js ***!
  \***************************************************************************/
/*! exports provided: VirtualArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VirtualArray\", function() { return VirtualArray; });\n/**\n * Defines an array that wraps part another array.\n */\nclass VirtualArray {\n    /**\n     * Creates a new virtual array that wraps over the given array from the start index to the end index.\n     * @param array\n     * @param start\n     * @param end\n     */\n    constructor(array, start, end) {\n        this._array = array;\n        this._start = start || 0;\n        this._end = typeof end === 'undefined' ? this._array.length : end || 0;\n    }\n    get start() {\n        return this._start;\n    }\n    get end() {\n        return this._end;\n    }\n    /**\n     * Gets the length of the virtual array.\n     */\n    get length() {\n        return this._end - this._start;\n    }\n    /**\n     * Gets the value at the given index.\n     * @param index The index.\n     */\n    get(index) {\n        if (index < 0 || index >= this.length) {\n            throw VirtualArray._indexOutOfRange();\n        }\n        const final = this._start + index;\n        return this._array[final];\n    }\n    /**\n     * Sets the value at the given index.\n     * @param index\n     * @param value\n     */\n    set(index, value) {\n        if (index < 0) {\n            throw VirtualArray._indexOutOfRange();\n        }\n        if (index >= this.length) {\n            const newElements = index - (this.length - 1);\n            this._array.splice(this.end, 0, ...new Array(newElements));\n            this._end = this.end + newElements;\n        }\n        const final = this._start + index;\n        this._array[final] = value;\n    }\n    /**\n     * Adds the given value at the given index in the array.\n     * @param index The index.\n     * @param value The value.\n     */\n    insert(index, value) {\n        if (index < 0 || index > this.length) {\n            throw VirtualArray._indexOutOfRange();\n        }\n        const final = this._start + index;\n        this._array.splice(final, 0, value);\n        this._end++;\n    }\n    /**\n     * Removes the item from the given index.\n     * @param index The index.\n     */\n    remove(index) {\n        if (index < 0 || index >= this.length) {\n            throw VirtualArray._indexOutOfRange();\n        }\n        const final = this._start + index;\n        const val = this._array.splice(final, 1)[0];\n        this._end--;\n        return val;\n    }\n    static _indexOutOfRange() {\n        return new Error('Index out of range');\n    }\n}\n//# sourceMappingURL=VirtualArray.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/VirtualArray.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/Weave.js":
/*!********************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/Weave.js ***!
  \********************************************************************/
/*! exports provided: Weave, weaveIndexOf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Weave\", function() { return Weave; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"weaveIndexOf\", function() { return weaveIndexOf; });\n/* harmony import */ var _Atom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Atom */ \"./node_modules/@casual-simulation/causal-trees/core/Atom.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @casual-simulation/crypto */ \"./node_modules/@casual-simulation/crypto/index.js\");\n\n\n\n/**\n * Defines a weave.\n * That is, the depth-first preorder traversal of a causal tree.\n */\nclass Weave {\n    /**\n     * Creates a new weave.\n     */\n    constructor() {\n        this._atoms = [];\n        this._sites = {};\n        this._sizeMap = new Map();\n    }\n    /**\n     * Gets the list of atoms stored in this weave.\n     * The order is the depth-first traversal of the causal tree.\n     */\n    get atoms() {\n        return this._atoms;\n    }\n    /**\n     * Gets the list of atoms for a site.\n     * @param site The site identifier.\n     */\n    getSite(siteId) {\n        let site = this._sites[siteId];\n        if (typeof site === 'undefined') {\n            site = [];\n            this._sites[siteId] = site;\n        }\n        return site;\n    }\n    /**\n     * Inserts the given atom into the weave and returns it.\n     * @param atom The atom.\n     */\n    insert(atom) {\n        if (!Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomMatchesChecksum\"])(atom)) {\n            console.warn(`[Weave] Atom ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(atom.id)} rejected because its checksum didn't match itself.`);\n            return [\n                null,\n                {\n                    atom: atom,\n                    reason: 'checksum_failed',\n                },\n            ];\n        }\n        const site = this.getSite(atom.id.site);\n        if (!atom.cause) {\n            // check for an existing root atom\n            if (this.atoms.length > 0) {\n                return [\n                    null,\n                    {\n                        atom: atom,\n                        reason: 'second_root_not_allowed',\n                    },\n                ];\n            }\n            // Add the atom at the root of the weave.\n            this._atoms.splice(0, 0, atom);\n            site[atom.id.timestamp] = atom;\n            this._sizeMap.set(atom.id, 1);\n            return [atom, null];\n        }\n        else {\n            const cause = this.getAtom(atom.cause);\n            if (!cause) {\n                return [\n                    null,\n                    {\n                        atom: atom,\n                        reason: 'cause_not_found',\n                    },\n                ];\n            }\n            const causeIndex = this._atomIndexOf(cause);\n            if (causeIndex < 0) {\n                return [\n                    null,\n                    {\n                        atom: atom,\n                        reason: 'cause_not_found',\n                    },\n                ];\n            }\n            const weaveIndex = this._weaveIndex(causeIndex, atom.id);\n            const siteIndex = atom.id.timestamp;\n            if (siteIndex >= 0 && siteIndex < site.length) {\n                const existingAtom = site[siteIndex];\n                if (existingAtom && Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(existingAtom.id, atom.id)) {\n                    return [existingAtom, null];\n                }\n            }\n            this._atoms.splice(weaveIndex, 0, atom);\n            site[siteIndex] = atom;\n            this._updateAtomSizes([atom]);\n            return [atom, null];\n        }\n    }\n    /**\n     * Inserts the given list of atoms into the weave.\n     * @param atoms The atoms to insert.\n     */\n    insertMany(...atoms) {\n        atoms.forEach(a => {\n            this.insert(a);\n        });\n    }\n    /**\n     * Removes the given reference from the weave.\n     * Returns the references that were removed.\n     * @param ref The reference to remove.\n     */\n    remove(ref) {\n        if (!ref) {\n            return [];\n        }\n        const span = this._getSpan(ref);\n        if (!span) {\n            return [];\n        }\n        return this._removeSpan(span.index, span.length);\n    }\n    /**\n     * Removes all of the siblings of the given atom that happened before it.\n     * Returns the references that were removed.\n     * @param atom The reference whose older siblings should be removed.\n     */\n    removeBefore(atom) {\n        if (!atom) {\n            return [];\n        }\n        if (!atom.cause) {\n            return [];\n        }\n        const cause = this.getAtom(atom.cause);\n        if (!cause) {\n            return [];\n        }\n        const causeSize = this.getAtomSize(cause.id);\n        const atomSize = this.getAtomSize(atom.id);\n        const diff = causeSize - atomSize;\n        if (diff === 1) {\n            // There's nothing to remove because the atom is the only child\n            // of the cause.\n            return [];\n        }\n        const causeSpan = this._getSpan(cause);\n        if (!causeSpan) {\n            return [];\n        }\n        const refSpan = this._getSpan(atom, causeSpan.index);\n        if (!refSpan) {\n            return [];\n        }\n        const startSplice = refSpan.index + refSpan.length;\n        const endSplice = causeSpan.index + causeSpan.length;\n        const spliceLength = endSplice - startSplice;\n        return this._removeSpan(startSplice, spliceLength);\n    }\n    _removeSpan(index, length) {\n        let removed = this._atoms.splice(index, length);\n        for (let i = removed.length - 1; i >= 0; i--) {\n            const r = removed[i];\n            const chain = this.referenceChain(r);\n            for (let b = 1; b < chain.length; b++) {\n                const id = chain[b].id;\n                const current = this.getAtomSize(id);\n                this._sizeMap.set(id, current - 1);\n            }\n            this._sizeMap.delete(r.id);\n            const site = this.getSite(r.id.site);\n            delete site[r.id.timestamp];\n        }\n        return removed;\n    }\n    /**\n     * Gets the atom for the given reference.\n     * @param reference The reference.\n     */\n    getAtom(id) {\n        if (!id) {\n            return null;\n        }\n        const site = this.getSite(id.site);\n        if (id.timestamp >= 0 && id.timestamp < site.length) {\n            return site[id.timestamp];\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Gets the size of the atom with the given ID.\n     * The size of an atom is defined as the number of children it has plus 1.\n     * @param id The ID of the atom to find the size of. If the tree doesn't contain the given reference then undefined is returned.\n     */\n    getAtomSize(id) {\n        return this._sizeMap.get(id);\n    }\n    /**\n     * Gets the version that this weave is currently at.\n     */\n    getVersion() {\n        let knownSites = this.siteIds();\n        let sites = {};\n        knownSites.forEach(id => {\n            const site = this.getSite(id);\n            sites[id] = site.length - 1;\n        });\n        return {\n            sites,\n            hash: this.getHash(),\n        };\n    }\n    /**\n     * Gets the hash of the weave.\n     */\n    getHash() {\n        return Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_2__[\"getHash\"])(this.atoms);\n    }\n    /**\n     * Gets a new weave that contains only the atoms needed to keep the given version consistent.\n     * @param version The version of the weave to get.\n     */\n    getWeft(version, preserveChildren = false) {\n        let newWeave = this.copy();\n        if (preserveChildren) {\n            // travel from leaf nodes to the root node\n            for (let i = newWeave.atoms.length - 1; i >= 0; i--) {\n                const atom = newWeave.atoms[i];\n                const id = atom.id;\n                const site = id.site;\n                const oldestAllowed = version[site];\n                if (!oldestAllowed || id.timestamp > oldestAllowed) {\n                    // When preserving children,\n                    // we only remove an atom if it has no children.\n                    if (newWeave.getAtomSize(id) === 1) {\n                        newWeave.remove(atom);\n                    }\n                }\n            }\n        }\n        else {\n            for (let i = 0; i < newWeave.atoms.length; i++) {\n                const atom = newWeave.atoms[i];\n                const id = atom.id;\n                const site = id.site;\n                const oldestAllowed = version[site];\n                if (!oldestAllowed || id.timestamp > oldestAllowed) {\n                    newWeave.remove(atom);\n                    i -= 1;\n                }\n            }\n        }\n        newWeave._trimSites();\n        return newWeave;\n    }\n    /**\n     * Gets the list of atoms that are children of the given atom.\n     * @param parent The atom to find the children of.\n     */\n    decendants(parent) {\n        const size = this.getAtomSize(parent.id);\n        if (size) {\n            const index = this._atomIndexOf(parent);\n            if (index >= 0) {\n                return this.atoms.slice(index + 1, index + size);\n            }\n        }\n        return [];\n    }\n    /**\n     * Constructs a new weave that contains the smallest possible valid causal history for the given list\n     * of parent atoms.\n     * @param parents The list of atoms that should be kept in the weave.\n     */\n    subweave(...parents) {\n        const weaves = parents.map(atom => {\n            const children = this.decendants(atom);\n            let chain = this.referenceChain(atom);\n            chain.reverse();\n            return [...chain, ...children];\n        });\n        let newWeave = new Weave();\n        for (let i = 0; i < weaves.length; i++) {\n            let weave = weaves[i];\n            const [, rejected] = newWeave.import(weave);\n            if (rejected.length > 0) {\n                // Should be impossible to reject atoms because they were already in the weave.\n                throw new Error('[Weave] Atoms were ignored or rejected when it should be impossible to due so.');\n            }\n        }\n        return newWeave;\n    }\n    /**\n     * Copies this weave and returns the clone.\n     */\n    copy() {\n        let newWeave = new Weave();\n        newWeave._atoms = this._atoms.slice();\n        newWeave._sizeMap = new Map(this._sizeMap);\n        newWeave._sites = {};\n        for (let key in this._sites) {\n            newWeave._sites[key] = this._sites[key].slice();\n        }\n        return newWeave;\n    }\n    /**\n     * Imports the given list of atoms into this weave.\n     * The atoms are assumed to be pre-sorted.\n     * Returns the list of atoms that were added to the weave.\n     * @param atoms The atoms to import into this weave.\n     */\n    import(atoms) {\n        let newAtoms = [];\n        let rejectedAtoms = [];\n        let localOffset = 0;\n        for (let i = 0; i < atoms.length; i++) {\n            const a = atoms[i];\n            let local = this._atoms[i + localOffset];\n            if (!Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomMatchesChecksum\"])(a)) {\n                rejectedAtoms.push({\n                    atom: a,\n                    reason: 'checksum_failed',\n                });\n                break;\n            }\n            // No more local atoms, so the remote atoms are merely append\n            // operations\n            if (!local) {\n                // Short circut by appending the rest.\n                const finalAtoms = atoms.slice(i);\n                for (let b = 0; b < finalAtoms.length; b++) {\n                    const atom = finalAtoms[b];\n                    if (atom.cause) {\n                        const cause = this.getAtom(atom.cause);\n                        if (!cause) {\n                            // prevent atoms without parents\n                            // if the input is properly sorted,\n                            // then it is impossible to end up with\n                            // an atom without a cause.\n                            continue;\n                        }\n                    }\n                    const exists = this.getAtom(atom.id);\n                    if (exists) {\n                        rejectedAtoms.push({\n                            atom: atom,\n                            reason: 'atom_id_already_exists',\n                        });\n                        continue;\n                    }\n                    this._atoms.push(atom);\n                    newAtoms.push(atom);\n                    const site = this.getSite(atom.id.site);\n                    site[atom.id.timestamp] = atom;\n                }\n                break;\n            }\n            else {\n                // Could either be the same, a new sibling, or a new child of the current subtree\n                if (a.cause) {\n                    const cause = this.getAtom(a.cause);\n                    if (!cause) {\n                        // prevent atoms without parents\n                        // if the input is properly sorted,\n                        // then it is impossible to end up with\n                        // an atom without a cause.\n                        continue;\n                    }\n                }\n                const exists = this.getAtom(a.id);\n                if (exists && a.checksum !== exists.checksum) {\n                    // Break because the atoms aren't actually the same\n                    // even though they claim to be\n                    rejectedAtoms.push({\n                        atom: a,\n                        reason: 'atom_id_already_exists',\n                    });\n                    break;\n                }\n                let order = this._compareAtoms(a, local);\n                if (order === 0) {\n                    // Atoms are equal, no action needed.\n                }\n                else if (order < 0) {\n                    // New atom should be before local atom.\n                    // insert at this index.\n                    this._atoms.splice(i + localOffset, 0, a);\n                    newAtoms.push(a);\n                    const site = this.getSite(a.id.site);\n                    site[a.id.timestamp] = a;\n                }\n                else if (order > 0) {\n                    // New atom should be after local atom.\n                    // Skip local atoms until we find the right place to put the new atom.\n                    // Basically we're skipping until we are after the current local atom's children\n                    // or until we find a sibling that we should be inserted before.\n                    do {\n                        localOffset += 1;\n                        local = this._atoms[i + localOffset];\n                    } while (local &&\n                        (this._isInCausalGroup(a, local) ||\n                            (this._areSiblings(a, local) &&\n                                this._compareAtomIds(a.id, local.id) > 0)));\n                    if (!local) {\n                        // We reached the end of the weave\n                        this._atoms.splice(i + localOffset, 0, a);\n                        newAtoms.push(a);\n                        const site = this.getSite(a.id.site);\n                        site[a.id.timestamp] = a;\n                    }\n                    else {\n                        // We found a spot to place the atom at.\n                        order = this._compareAtoms(a, local);\n                        if (order < 0) {\n                            this._atoms.splice(i + localOffset, 0, a);\n                            newAtoms.push(a);\n                            const site = this.getSite(a.id.site);\n                            site[a.id.timestamp] = a;\n                        }\n                        else if (order > 0) {\n                            throw new Error(`[Weave] Atom (${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(a.id)}) is supposed to be placed before (${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(local.id)}) but the IDs say otherwise.`);\n                        }\n                    }\n                }\n            }\n        }\n        this._updateAtomSizes(newAtoms);\n        return [newAtoms, rejectedAtoms];\n    }\n    /**\n     * Gets the list of site IDs that this weave contains.\n     */\n    siteIds() {\n        return Object(lodash__WEBPACK_IMPORTED_MODULE_1__[\"keys\"])(this._sites)\n            .map(id => parseInt(id))\n            .sort();\n    }\n    /**\n     * Calculates the chain of references from the root directly to the given reference.\n     * Returns the chain from the given reference to the rootmost reference.\n     * @param weave The weave that the reference is from.\n     * @param ref The reference.\n     */\n    referenceChain(ref) {\n        let chain = [ref];\n        let cause = ref.cause;\n        while (cause) {\n            const causeRef = this.getAtom(cause);\n            if (!causeRef) {\n                throw new Error(`[Weave] Could not find cause for atom ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(cause)}`);\n            }\n            chain.push(causeRef);\n            cause = causeRef.cause;\n        }\n        return chain;\n    }\n    /**\n     * Determines if this causal tree is valid.\n     */\n    isValid() {\n        if (this._atoms.length === 0) {\n            return true;\n        }\n        let parents = [this._atoms[0]];\n        for (let i = 1; i < this._atoms.length; i++) {\n            const child = this._atoms[i];\n            let parent = parents[0];\n            const existing = this.getAtom(child.id);\n            if (!existing) {\n                console.warn(`[Weave] Invalid tree. ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.id)} was not able to be found by its ID. This means the site cache is out of date.`);\n                return false;\n            }\n            else if (child.checksum !== existing.checksum) {\n                console.warn(`[Weave] Invalid tree. There is a duplicate ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.id)} in the tree. Checksums did not match.`);\n                return false;\n            }\n            if (Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(child.cause, parent.cause)) {\n                const order = this._compareAtoms(child, parent);\n                // siblings\n                if (order < 0) {\n                    console.warn(`[Weave] Invalid tree. ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.id)} says it happened before its sibling (${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(parent.id)}) that occurred before it in the tree.`);\n                    return false;\n                }\n            }\n            while (!Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(child.cause, parent.id)) {\n                parents.shift();\n                if (parents.length === 0) {\n                    console.warn(`[Weave] Invalid tree. ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.id)} is either inserted before ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.cause)} or the cause is not in the tree.`);\n                    return false;\n                }\n                parent = parents[0];\n            }\n            if (child.id.timestamp <= parent.id.timestamp) {\n                console.warn(`[Weave] Invalid tree. ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.id)} says it happened before its parent ${Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"])(child.cause)}.`);\n                return false;\n            }\n            parents.unshift(child);\n        }\n        return true;\n    }\n    /**\n     * Trims the site map so that it only contains spaces for atoms that are currently in this weave.\n     * As a result, getVersion() will no longer show the latest timestamp from each site but only\n     * the latest timestamp that is currently in the site.\n     */\n    _trimSites() {\n        for (let siteId in this._sites) {\n            let site = this._sites[siteId];\n            let i = site.length;\n            while (i > 0) {\n                if (typeof site[i - 1] !== 'undefined') {\n                    break;\n                }\n                i -= 1;\n            }\n            site.splice(i);\n            if (site.length === 0) {\n                delete this._sites[siteId];\n            }\n        }\n    }\n    /**\n     * Updates the sizes of the given references in the map.\n     * @param atoms The references to update.\n     */\n    _updateAtomSizes(atoms) {\n        for (let i = 0; i < atoms.length; i++) {\n            const atom = atoms[i];\n            const chain = this.referenceChain(atom);\n            for (let b = 0; b < chain.length; b++) {\n                const id = chain[b].id;\n                const current = this.getAtomSize(id) || 0;\n                this._sizeMap.set(id, current + 1);\n            }\n        }\n    }\n    /**\n     * Gets the index that the given ref starts and and the number of children it has\n     * after it.\n     * Returns null if the given ref doesn't exist in the weave.\n     * @param ref The reference.\n     * @param start The index to start searching at.\n     */\n    _getSpan(ref, start = 0) {\n        const index = this._atomIndexOf(ref);\n        if (index < 0) {\n            return null;\n        }\n        return { index, length: this.getAtomSize(ref.id) };\n    }\n    /**\n     * Finds the index that an atom should appear at in the weave.\n     * @param causeIndex The index of the parent for the atom.\n     * @param atomId The ID of the atom to find the index for.\n     */\n    _weaveIndex(causeIndex, atomId) {\n        const cause = this._atoms[causeIndex];\n        let index = causeIndex + 1;\n        for (; index < this._atoms.length; index++) {\n            const atom = this._atoms[index];\n            const order = this._compareAtomIds(atomId, atom.id);\n            if (order < 0) {\n                break;\n            }\n            if (atom.cause.timestamp < cause.id.timestamp) {\n                break;\n            }\n        }\n        return index;\n    }\n    /**\n     * Finds the index that the given atom is at in the atoms array.\n     * @param atom The atom to find the index of.\n     */\n    _atomIndexOf(atom) {\n        // Lookup the reference chain for the atom.\n        const chain = this.referenceChain(atom);\n        let index = 0;\n        // Starting with the rootmost atom,\n        // find the index of the parent so we only have to evaluate the number of siblings\n        // that each level has instead of the entire weave.\n        for (let i = chain.length - 1; i >= 0; i--) {\n            const level = chain[i];\n            while (index < this._atoms.length) {\n                const atom = this._atoms[index];\n                if (Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(atom.id, level.id)) {\n                    index += 1;\n                    break;\n                }\n                else {\n                    index += this.getAtomSize(atom.id);\n                }\n            }\n        }\n        if (index <= this._atoms.length) {\n            return index - 1;\n        }\n        else {\n            return -1;\n        }\n    }\n    /**\n     * Determines if the first atom is in the same causal group as the second\n     * atom.\n     * @param first The atom to check.\n     * @param second The atom to check against.\n     */\n    _isInCausalGroup(first, second) {\n        return first.id.timestamp <= second.cause.timestamp;\n    }\n    /**\n     * Determines if the two given atoms are siblings. That is, if they share the same parent.\n     * @param first The first atom.\n     * @param second The second atom.\n     */\n    _areSiblings(first, second) {\n        return this._compareAtomIds(first.cause, second.cause) === 0;\n    }\n    /**\n     * Compares the two atoms to see which should be sorted in front of the other.\n     * Returns -1 if the first should be before the second.\n     * Returns 0 if they are equal.\n     * Returns 1 if the first should be after the second.\n     * @param first The first atom.\n     * @param second The second atom.\n     */\n    _compareAtoms(first, second) {\n        const cause = this._compareAtomIds(first.cause, second.cause);\n        if (cause === 0) {\n            return this._compareAtomIds(first.id, second.id);\n        }\n        return cause;\n    }\n    /**\n     * Determines if the first atom ID should sort before, at, or after the second atom ID.\n     * Returns -1 if the first should be before the second.\n     * Returns 0 if the IDs are equal.\n     * Returns 1 if the first should be after the second.\n     * @param first The first atom ID.\n     * @param second The second atom ID.\n     */\n    _compareAtomIds(first, second) {\n        if (!first && second) {\n            return -1;\n        }\n        else if (!second && first) {\n            return 1;\n        }\n        else if (first === second) {\n            return 0;\n        }\n        if (first.priority > second.priority) {\n            return -1;\n        }\n        else if (first.priority < second.priority) {\n            return 1;\n        }\n        else if (first.priority === second.priority) {\n            if (first.timestamp > second.timestamp) {\n                return -1;\n            }\n            else if (first.timestamp < second.timestamp) {\n                return 1;\n            }\n            else if (first.timestamp === second.timestamp) {\n                if (first.site < second.site) {\n                    return -1;\n                }\n                else if (first.site > second.site) {\n                    return 1;\n                }\n            }\n        }\n        return 0;\n    }\n    /**\n     * Builds a weave from an array of atoms.\n     * This array is assumed to already be sorted in the correct order.\n     * If the array was obtained from Weave.atoms, then it will be in the correct order.\n     * @param refs The atom references that the new weave should be built from.\n     */\n    static buildFromArray(refs) {\n        let weave = new Weave();\n        weave.import(refs);\n        return weave;\n    }\n}\n/**\n * Finds the index of the given atom in the given array.\n * Returns -1 if the atom could not be found.\n * @param arr The array to search through.\n * @param id The ID of the atom to find.\n * @param start The optional starting index.\n */\nfunction weaveIndexOf(arr, id, start = 0) {\n    for (let i = start; i < arr.length; i++) {\n        const atom = arr[i];\n        if (Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(atom.id, id)) {\n            return i;\n        }\n    }\n    return -1;\n}\n//# sourceMappingURL=Weave.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/Weave.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/WeaveTraverser.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/WeaveTraverser.js ***!
  \*****************************************************************************/
/*! exports provided: WeaveTraverser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WeaveTraverser\", function() { return WeaveTraverser; });\n/* harmony import */ var _Atom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Atom */ \"./node_modules/@casual-simulation/causal-trees/core/Atom.js\");\n\n/**\n * Defines a class that helps with traversing weaves.\n */\nclass WeaveTraverser {\n    constructor(weave) {\n        this._weave = weave;\n        this._index = 0;\n    }\n    /**\n     * Gets a reference to the next atom in the tree.\n     * Returns null if we're at the end.\n     * @param parent The ID of the parent that the next atom should match.\n     */\n    peek(parent) {\n        if (this._index < this._weave.atoms.length) {\n            const atom = this._weave.atoms[this._index];\n            if (!parent) {\n                return atom;\n            }\n            if (Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(parent, atom.cause)) {\n                return atom;\n            }\n        }\n        return null;\n    }\n    /**\n     * Consumes and returns the next atom in the tree.\n     */\n    next() {\n        const atom = this._weave.atoms[this._index];\n        this._index += 1;\n        return atom;\n    }\n    /**\n     * Gets the current atom.\n     */\n    current() {\n        return this._weave.atoms[this._index];\n    }\n    /**\n     * Skips atoms until the next atom is a sibling of the given parent.\n     * @param parent The parent to skip out of.\n     */\n    skip(parent) {\n        const current = this.current();\n        if (current && Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(parent, current.id)) {\n            const size = this._weave.getAtomSize(parent);\n            this._index += size;\n        }\n        else {\n            while (this.peek(parent)) {\n                const atom = this.next();\n                const nextRef = this.peek();\n                if (nextRef && Object(_Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"])(atom.id, nextRef.cause)) {\n                    this.skip(atom.id);\n                }\n            }\n        }\n    }\n    /**\n     * Copies this traverser.\n     */\n    fork() {\n        const copy = new WeaveTraverser(this._weave);\n        copy._index = this._index;\n        return copy;\n    }\n}\n//# sourceMappingURL=WeaveTraverser.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/WeaveTraverser.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/WeaveVersion.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/WeaveVersion.js ***!
  \***************************************************************************/
/*! exports provided: weaveVersion, versionsEqual */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"weaveVersion\", function() { return weaveVersion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"versionsEqual\", function() { return versionsEqual; });\n/**\n * Creates a new weave version from the given hash and sites.\n * @param hash\n * @param sites\n */\nfunction weaveVersion(hash, sites) {\n    return {\n        hash,\n        sites,\n    };\n}\n/**\n * Determines if the two versions are equal.\n * @param first The first version.\n * @param second The second version.\n */\nfunction versionsEqual(first, second) {\n    if (!first && second) {\n        return false;\n    }\n    else if (first && !second) {\n        return false;\n    }\n    else {\n        return first.hash === second.hash;\n    }\n}\n//# sourceMappingURL=WeaveVersion.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/WeaveVersion.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/core/index.js":
/*!********************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/core/index.js ***!
  \********************************************************************/
/*! exports provided: idEquals, atomId, atom, atomMatchesChecksum, atomIdToString, AtomFactory, CausalTree, CausalTreeFactory, bindChangesToStore, RealtimeChannelImpl, site, currentFormatVersion, storedTree, upgrade, VirtualArray, Weave, weaveIndexOf, WeaveTraverser, weaveVersion, versionsEqual, precalculatedOp, mergeIntoBatch, AtomValidator, USER_ROLE, ADMIN_ROLE, SERVER_ROLE, GUEST_ROLE, USERNAME_CLAIM, DEVICE_ID_CLAIM, SESSION_ID_CLAIM, remapProgressPercent, remote, device, NullCausalTreeStore, SyncedRealtimeCausalTree, LocalRealtimeCausalTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Atom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Atom */ \"./node_modules/@casual-simulation/causal-trees/core/Atom.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"idEquals\", function() { return _Atom__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomId\", function() { return _Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atom\", function() { return _Atom__WEBPACK_IMPORTED_MODULE_0__[\"atom\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomMatchesChecksum\", function() { return _Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomMatchesChecksum\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomIdToString\", function() { return _Atom__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"]; });\n\n/* harmony import */ var _AtomFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AtomFactory */ \"./node_modules/@casual-simulation/causal-trees/core/AtomFactory.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AtomFactory\", function() { return _AtomFactory__WEBPACK_IMPORTED_MODULE_1__[\"AtomFactory\"]; });\n\n/* harmony import */ var _CausalTree__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CausalTree */ \"./node_modules/@casual-simulation/causal-trees/core/CausalTree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CausalTree\", function() { return _CausalTree__WEBPACK_IMPORTED_MODULE_2__[\"CausalTree\"]; });\n\n/* harmony import */ var _CausalTreeFactory__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CausalTreeFactory */ \"./node_modules/@casual-simulation/causal-trees/core/CausalTreeFactory.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CausalTreeFactory\", function() { return _CausalTreeFactory__WEBPACK_IMPORTED_MODULE_3__[\"CausalTreeFactory\"]; });\n\n/* harmony import */ var _CausalTreeStoreHelpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CausalTreeStoreHelpers */ \"./node_modules/@casual-simulation/causal-trees/core/CausalTreeStoreHelpers.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bindChangesToStore\", function() { return _CausalTreeStoreHelpers__WEBPACK_IMPORTED_MODULE_4__[\"bindChangesToStore\"]; });\n\n/* harmony import */ var _RealtimeChannelImpl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RealtimeChannelImpl */ \"./node_modules/@casual-simulation/causal-trees/core/RealtimeChannelImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"RealtimeChannelImpl\", function() { return _RealtimeChannelImpl__WEBPACK_IMPORTED_MODULE_5__[\"RealtimeChannelImpl\"]; });\n\n/* harmony import */ var _SiteIdInfo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SiteIdInfo */ \"./node_modules/@casual-simulation/causal-trees/core/SiteIdInfo.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"site\", function() { return _SiteIdInfo__WEBPACK_IMPORTED_MODULE_6__[\"site\"]; });\n\n/* harmony import */ var _StoredCausalTree__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./StoredCausalTree */ \"./node_modules/@casual-simulation/causal-trees/core/StoredCausalTree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"currentFormatVersion\", function() { return _StoredCausalTree__WEBPACK_IMPORTED_MODULE_7__[\"currentFormatVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"storedTree\", function() { return _StoredCausalTree__WEBPACK_IMPORTED_MODULE_7__[\"storedTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"upgrade\", function() { return _StoredCausalTree__WEBPACK_IMPORTED_MODULE_7__[\"upgrade\"]; });\n\n/* harmony import */ var _VirtualArray__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./VirtualArray */ \"./node_modules/@casual-simulation/causal-trees/core/VirtualArray.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"VirtualArray\", function() { return _VirtualArray__WEBPACK_IMPORTED_MODULE_8__[\"VirtualArray\"]; });\n\n/* harmony import */ var _Weave__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Weave */ \"./node_modules/@casual-simulation/causal-trees/core/Weave.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Weave\", function() { return _Weave__WEBPACK_IMPORTED_MODULE_9__[\"Weave\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"weaveIndexOf\", function() { return _Weave__WEBPACK_IMPORTED_MODULE_9__[\"weaveIndexOf\"]; });\n\n/* harmony import */ var _WeaveTraverser__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./WeaveTraverser */ \"./node_modules/@casual-simulation/causal-trees/core/WeaveTraverser.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"WeaveTraverser\", function() { return _WeaveTraverser__WEBPACK_IMPORTED_MODULE_10__[\"WeaveTraverser\"]; });\n\n/* harmony import */ var _WeaveVersion__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./WeaveVersion */ \"./node_modules/@casual-simulation/causal-trees/core/WeaveVersion.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"weaveVersion\", function() { return _WeaveVersion__WEBPACK_IMPORTED_MODULE_11__[\"weaveVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"versionsEqual\", function() { return _WeaveVersion__WEBPACK_IMPORTED_MODULE_11__[\"versionsEqual\"]; });\n\n/* harmony import */ var _PrecalculatedOp__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PrecalculatedOp */ \"./node_modules/@casual-simulation/causal-trees/core/PrecalculatedOp.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"precalculatedOp\", function() { return _PrecalculatedOp__WEBPACK_IMPORTED_MODULE_12__[\"precalculatedOp\"]; });\n\n/* harmony import */ var _AddResult__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./AddResult */ \"./node_modules/@casual-simulation/causal-trees/core/AddResult.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"mergeIntoBatch\", function() { return _AddResult__WEBPACK_IMPORTED_MODULE_13__[\"mergeIntoBatch\"]; });\n\n/* harmony import */ var _AtomValidator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./AtomValidator */ \"./node_modules/@casual-simulation/causal-trees/core/AtomValidator.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AtomValidator\", function() { return _AtomValidator__WEBPACK_IMPORTED_MODULE_14__[\"AtomValidator\"]; });\n\n/* harmony import */ var _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./DeviceInfo */ \"./node_modules/@casual-simulation/causal-trees/core/DeviceInfo.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"USER_ROLE\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"USER_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ADMIN_ROLE\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"ADMIN_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SERVER_ROLE\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"SERVER_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GUEST_ROLE\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"GUEST_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"USERNAME_CLAIM\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"USERNAME_CLAIM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEVICE_ID_CLAIM\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"DEVICE_ID_CLAIM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SESSION_ID_CLAIM\", function() { return _DeviceInfo__WEBPACK_IMPORTED_MODULE_15__[\"SESSION_ID_CLAIM\"]; });\n\n/* harmony import */ var _StatusUpdateUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./StatusUpdateUtils */ \"./node_modules/@casual-simulation/causal-trees/core/StatusUpdateUtils.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"remapProgressPercent\", function() { return _StatusUpdateUtils__WEBPACK_IMPORTED_MODULE_16__[\"remapProgressPercent\"]; });\n\n/* harmony import */ var _Event__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Event */ \"./node_modules/@casual-simulation/causal-trees/core/Event.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"remote\", function() { return _Event__WEBPACK_IMPORTED_MODULE_17__[\"remote\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"device\", function() { return _Event__WEBPACK_IMPORTED_MODULE_17__[\"device\"]; });\n\n/* harmony import */ var _NullCausalTreeStore__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./NullCausalTreeStore */ \"./node_modules/@casual-simulation/causal-trees/core/NullCausalTreeStore.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NullCausalTreeStore\", function() { return _NullCausalTreeStore__WEBPACK_IMPORTED_MODULE_18__[\"NullCausalTreeStore\"]; });\n\n/* harmony import */ var _SyncedRealtimeCausalTree__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./SyncedRealtimeCausalTree */ \"./node_modules/@casual-simulation/causal-trees/core/SyncedRealtimeCausalTree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SyncedRealtimeCausalTree\", function() { return _SyncedRealtimeCausalTree__WEBPACK_IMPORTED_MODULE_19__[\"SyncedRealtimeCausalTree\"]; });\n\n/* harmony import */ var _LocalRealtimeCausalTree__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./LocalRealtimeCausalTree */ \"./node_modules/@casual-simulation/causal-trees/core/LocalRealtimeCausalTree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LocalRealtimeCausalTree\", function() { return _LocalRealtimeCausalTree__WEBPACK_IMPORTED_MODULE_20__[\"LocalRealtimeCausalTree\"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/core/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/causal-trees/index.js":
/*!***************************************************************!*\
  !*** ./node_modules/@casual-simulation/causal-trees/index.js ***!
  \***************************************************************/
/*! exports provided: idEquals, atomId, atom, atomMatchesChecksum, atomIdToString, AtomFactory, CausalTree, CausalTreeFactory, bindChangesToStore, RealtimeChannelImpl, site, currentFormatVersion, storedTree, upgrade, VirtualArray, Weave, weaveIndexOf, WeaveTraverser, weaveVersion, versionsEqual, precalculatedOp, mergeIntoBatch, AtomValidator, USER_ROLE, ADMIN_ROLE, SERVER_ROLE, GUEST_ROLE, USERNAME_CLAIM, DEVICE_ID_CLAIM, SESSION_ID_CLAIM, remapProgressPercent, remote, device, NullCausalTreeStore, SyncedRealtimeCausalTree, LocalRealtimeCausalTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./core */ \"./node_modules/@casual-simulation/causal-trees/core/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"idEquals\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"idEquals\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomId\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"atomId\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atom\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"atom\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomMatchesChecksum\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"atomMatchesChecksum\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"atomIdToString\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"atomIdToString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AtomFactory\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"AtomFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CausalTree\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"CausalTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CausalTreeFactory\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"CausalTreeFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bindChangesToStore\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"bindChangesToStore\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"RealtimeChannelImpl\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"RealtimeChannelImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"site\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"site\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"currentFormatVersion\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"currentFormatVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"storedTree\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"storedTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"upgrade\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"upgrade\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"VirtualArray\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"VirtualArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Weave\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"Weave\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"weaveIndexOf\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"weaveIndexOf\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"WeaveTraverser\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"WeaveTraverser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"weaveVersion\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"weaveVersion\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"versionsEqual\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"versionsEqual\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"precalculatedOp\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"precalculatedOp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"mergeIntoBatch\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"mergeIntoBatch\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AtomValidator\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"AtomValidator\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"USER_ROLE\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"USER_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ADMIN_ROLE\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"ADMIN_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SERVER_ROLE\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"SERVER_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GUEST_ROLE\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"GUEST_ROLE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"USERNAME_CLAIM\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"USERNAME_CLAIM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DEVICE_ID_CLAIM\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"DEVICE_ID_CLAIM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SESSION_ID_CLAIM\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"SESSION_ID_CLAIM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"remapProgressPercent\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"remapProgressPercent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"remote\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"remote\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"device\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"device\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NullCausalTreeStore\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"NullCausalTreeStore\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SyncedRealtimeCausalTree\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"SyncedRealtimeCausalTree\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LocalRealtimeCausalTree\", function() { return _core__WEBPACK_IMPORTED_MODULE_0__[\"LocalRealtimeCausalTree\"]; });\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/causal-trees/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto-browser/BrowserSigningCryptoImpl.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto-browser/BrowserSigningCryptoImpl.js ***!
  \************************************************************************************/
/*! exports provided: BrowserSigningCryptoImpl, BrowserPublicCryptoKey, BrowserPrivateCryptoKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserSigningCryptoImpl\", function() { return BrowserSigningCryptoImpl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserPublicCryptoKey\", function() { return BrowserPublicCryptoKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserPrivateCryptoKey\", function() { return BrowserPrivateCryptoKey; });\n/* harmony import */ var _casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @casual-simulation/crypto */ \"./node_modules/@casual-simulation/crypto/index.js\");\n/* harmony import */ var bowser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bowser */ \"bowser\");\n/* harmony import */ var bowser__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bowser__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n// DEV NOTE:\n// It kinda goes without saying, but change this code as little as possible.\n// Security is not our strong point, but it also just makes sense to only really change this\n// for things like bug/security fixes and not normal maintenence stuff.\n// When we get browser tests working then we'll have more leniency.\n/**\n * Defines a class that implements a signing crypto protocol for web browsers using the SubtleCrypto API.\n * Currently, the only algorithm supported is ECDSA using SHA256 for hashing.\n */\nclass BrowserSigningCryptoImpl {\n    /**\n     * Creates a new BrowserSigningCryptoImpl object.\n     * @param algorithm The algorithm to use. Currently only ECDSA-SHA256-NISTP256 is supported.\n     */\n    constructor(algorithm) {\n        if (algorithm !== 'ECDSA-SHA256-NISTP256') {\n            throw new Error('[BrowserSigningCryptoImpl] Algorithms other than ECDSA-SHA256-NISTP256 are not supported.');\n        }\n    }\n    supported() {\n        const bowserResult = bowser__WEBPACK_IMPORTED_MODULE_1___default.a.parse(navigator.userAgent);\n        console.log('[BrowserSigningCryptoImpl] Detected browser:', bowserResult);\n        // Browser crypto is not functioning correctly on Firefox browsers despite it being supported.\n        if (bowserResult.browser.name === 'Firefox') {\n            return false;\n        }\n        return typeof globalThis.crypto.subtle !== 'undefined';\n    }\n    sign(key, data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof BrowserPrivateCryptoKey) {\n                return yield crypto.subtle.sign({\n                    name: 'ECDSA',\n                    hash: {\n                        name: 'SHA-256',\n                    },\n                }, key.privateKey, data);\n            }\n            throw this._unknownKey();\n        });\n    }\n    verify(key, signature, data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof BrowserPublicCryptoKey) {\n                return yield crypto.subtle.verify({\n                    name: 'ECDSA',\n                    hash: {\n                        name: 'SHA-256',\n                    },\n                }, key.publicKey, signature, data);\n            }\n            throw this._unknownKey();\n        });\n    }\n    verifyBatch(key, signatures, datas) {\n        if (key instanceof BrowserPublicCryptoKey) {\n            let pub = key.publicKey;\n            let promises = new Array(datas.length);\n            let options = {\n                name: 'ECDSA',\n                hash: {\n                    name: 'SHA-256',\n                },\n            };\n            for (let i = 0; i < promises.length; i++) {\n                promises[i] = crypto.subtle.verify(options, pub, signatures[i], datas[i]);\n            }\n            return Promise.all(promises);\n        }\n        throw this._unknownKey();\n    }\n    exportKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let buffer;\n            if (key instanceof BrowserPublicCryptoKey) {\n                buffer = yield crypto.subtle.exportKey('spki', key.publicKey);\n                return Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"formatPublicPEMKey\"])(buffer);\n            }\n            else if (key instanceof BrowserPrivateCryptoKey) {\n                buffer = yield crypto.subtle.exportKey('pkcs8', key.privateKey);\n                return Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"formatPrivatePEMKey\"])(buffer);\n            }\n            throw this._unknownKey();\n        });\n    }\n    importPublicKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buffer = Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"parsePublicPEMKey\"])(key);\n            const cryptoKey = yield crypto.subtle.importKey('spki', buffer, {\n                name: 'ECDSA',\n                namedCurve: BrowserSigningCryptoImpl.NAMED_CURVE,\n            }, true, ['verify']);\n            return new BrowserPublicCryptoKey(cryptoKey);\n        });\n    }\n    importPrivateKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buffer = Object(_casual_simulation_crypto__WEBPACK_IMPORTED_MODULE_0__[\"parsePrivatePEMKey\"])(key);\n            const cryptoKey = yield crypto.subtle.importKey('pkcs8', buffer, {\n                name: 'ECDSA',\n                namedCurve: BrowserSigningCryptoImpl.NAMED_CURVE,\n            }, true, ['sign']);\n            return new BrowserPrivateCryptoKey(cryptoKey);\n        });\n    }\n    generateKeyPair() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const keyPair = yield crypto.subtle.generateKey({\n                name: 'ECDSA',\n                namedCurve: BrowserSigningCryptoImpl.NAMED_CURVE,\n            }, true, ['sign', 'verify']);\n            return [\n                new BrowserPublicCryptoKey(keyPair.publicKey),\n                new BrowserPrivateCryptoKey(keyPair.privateKey),\n            ];\n        });\n    }\n    _unknownKey() {\n        return new Error('[BrowserSigningCryptoImpl] Key not a recognized implementation.');\n    }\n}\n/**\n * The EC Curve that is used.\n */\nBrowserSigningCryptoImpl.NAMED_CURVE = 'P-256';\n/**\n * Defines an implementation of PublicCryptoKey for web browsers.\n */\nclass BrowserPublicCryptoKey {\n    /**\n     * Creates a new browser public crypto key.\n     * @param publicKey The key to use.\n     */\n    constructor(publicKey) {\n        this.type = 'public';\n        this.publicKey = publicKey;\n    }\n}\n/**\n * Defines an implementation of PublicCryptoKey for web browsers.\n */\nclass BrowserPrivateCryptoKey {\n    /**\n     * Creates a new browser private crypto key.\n     * @param privateKey The key to use.\n     */\n    constructor(privateKey) {\n        this.type = 'private';\n        this.privateKey = privateKey;\n    }\n}\n//# sourceMappingURL=BrowserSigningCryptoImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto-browser/BrowserSigningCryptoImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto-browser/index.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto-browser/index.js ***!
  \*****************************************************************/
/*! exports provided: BrowserSigningCryptoImpl, BrowserPublicCryptoKey, BrowserPrivateCryptoKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BrowserSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BrowserSigningCryptoImpl */ \"./node_modules/@casual-simulation/crypto-browser/BrowserSigningCryptoImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BrowserSigningCryptoImpl\", function() { return _BrowserSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"BrowserSigningCryptoImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BrowserPublicCryptoKey\", function() { return _BrowserSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"BrowserPublicCryptoKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BrowserPrivateCryptoKey\", function() { return _BrowserSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"BrowserPrivateCryptoKey\"]; });\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto-browser/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto-node/NodeSigningCryptoImpl.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto-node/NodeSigningCryptoImpl.js ***!
  \******************************************************************************/
/*! exports provided: NodeSigningCryptoImpl, NodePublicCryptoKey, NodePrivateCryptoKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NodeSigningCryptoImpl\", function() { return NodeSigningCryptoImpl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NodePublicCryptoKey\", function() { return NodePublicCryptoKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NodePrivateCryptoKey\", function() { return NodePrivateCryptoKey; });\n/* harmony import */ var _SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SubtleCryptoCompat */ \"./node_modules/@casual-simulation/crypto-node/SubtleCryptoCompat.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\nclass NodeSigningCryptoImpl {\n    constructor(algorithm) {\n        if (algorithm !== 'ECDSA-SHA256-NISTP256') {\n            throw new Error(`[NodeSigningCryptoImpl] Unsupported singing algorithm type: ${algorithm}`);\n        }\n    }\n    supported() {\n        return true;\n    }\n    sign(key, data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof NodePrivateCryptoKey) {\n                const sign = Object(crypto__WEBPACK_IMPORTED_MODULE_1__[\"createSign\"])('SHA256');\n                const buffer = Buffer.from(data);\n                sign.write(buffer);\n                sign.end();\n                const signature = sign.sign(key.privateKey);\n                return Object(_SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_0__[\"nodeSignatureToWebSignature\"])(signature);\n            }\n            throw this._unknownKey();\n        });\n    }\n    verify(key, signature, data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof NodePublicCryptoKey) {\n                const verify = Object(crypto__WEBPACK_IMPORTED_MODULE_1__[\"createVerify\"])('SHA256');\n                const buffer = Buffer.from(data);\n                verify.update(buffer);\n                verify.end();\n                const sig = Object(_SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_0__[\"webSignatureToNodeSignature\"])(Buffer.from(signature));\n                return verify.verify(key.publicKey, sig);\n            }\n            throw this._unknownKey();\n        });\n    }\n    verifyBatch(key, signatures, datas) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof NodePublicCryptoKey) {\n                let nodeSignatures = new Array(signatures.length);\n                for (let i = 0; i < nodeSignatures.length; i++) {\n                    nodeSignatures[i] = Object(_SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_0__[\"webSignatureToNodeSignature\"])(Buffer.from(signatures[i]));\n                }\n                let verifies = new Array(nodeSignatures.length);\n                for (let i = 0; i < verifies.length; i++) {\n                    const verify = Object(crypto__WEBPACK_IMPORTED_MODULE_1__[\"createVerify\"])('SHA256');\n                    const buffer = Buffer.from(datas[i]);\n                    verify.update(buffer);\n                    verify.end();\n                    verifies[i] = verify;\n                }\n                let results = new Array(datas.length);\n                let pub = key.publicKey;\n                for (let i = 0; i < results.length; i++) {\n                    results[i] = verifies[i].verify(pub, nodeSignatures[i]);\n                }\n                return results;\n            }\n            throw this._unknownKey();\n        });\n    }\n    exportKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (key instanceof NodePublicCryptoKey) {\n                return key.publicKey;\n            }\n            else if (key instanceof NodePrivateCryptoKey) {\n                return key.privateKey;\n            }\n            throw this._unknownKey();\n        });\n    }\n    importPublicKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new NodePublicCryptoKey(key);\n        });\n    }\n    importPrivateKey(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new NodePrivateCryptoKey(key);\n        });\n    }\n    generateKeyPair() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { publicKey, privateKey } = Object(crypto__WEBPACK_IMPORTED_MODULE_1__[\"generateKeyPairSync\"])('ec', {\n                namedCurve: 'prime256v1',\n                publicKeyEncoding: {\n                    type: 'spki',\n                    format: 'pem',\n                },\n                privateKeyEncoding: {\n                    type: 'pkcs8',\n                    format: 'pem',\n                },\n            });\n            return [\n                new NodePublicCryptoKey(publicKey),\n                new NodePrivateCryptoKey(privateKey),\n            ];\n        });\n    }\n    _unknownKey() {\n        return new Error('[NodeSigningCryptoImpl] Key not a recognized implementation.');\n    }\n}\nclass NodePublicCryptoKey {\n    constructor(publicKey) {\n        this.publicKey = publicKey;\n    }\n}\nclass NodePrivateCryptoKey {\n    constructor(privateKey) {\n        this.privateKey = privateKey;\n    }\n}\n//# sourceMappingURL=NodeSigningCryptoImpl.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto-node/NodeSigningCryptoImpl.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto-node/SubtleCryptoCompat.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto-node/SubtleCryptoCompat.js ***!
  \***************************************************************************/
/*! exports provided: nodeSignatureToWebSignature, webSignatureToNodeSignature */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"nodeSignatureToWebSignature\", function() { return nodeSignatureToWebSignature; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"webSignatureToNodeSignature\", function() { return webSignatureToNodeSignature; });\n/* harmony import */ var asn1_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! asn1.js */ \"asn1.js\");\n/* harmony import */ var asn1_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(asn1_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bn_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bn.js */ \"bn.js\");\n/* harmony import */ var bn_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bn_js__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// From https://stackoverflow.com/questions/39499040/generating-ecdsa-signature-with-node-js-crypto\nconst EcdsaDerSignature = asn1_js__WEBPACK_IMPORTED_MODULE_0___default.a.define('ECPrivateKey', function () {\n    return this.seq().obj(this.key('r').int(), this.key('s').int());\n});\n/**\n * Converts a signature from node.js's crypto format to a format that\n * is compatible with SubtleCrypto in web browsers. (ASN1/DER to Concatenated bytes)\n * @param buffer The buffer.\n */\nfunction nodeSignatureToWebSignature(buffer) {\n    const rsSig = EcdsaDerSignature.decode(buffer, 'der');\n    return Buffer.concat([\n        rsSig.r.toArrayLike(Buffer, 'be', 32),\n        rsSig.s.toArrayLike(Buffer, 'be', 32),\n    ]);\n}\n/**\n * Converts a signature from SubtleCrypto's format to a format that is compatible\n * with node.js. (Concatenated bytes to ASN1/DER)\n * @param buffer\n */\nfunction webSignatureToNodeSignature(buffer) {\n    const r = new bn_js__WEBPACK_IMPORTED_MODULE_1___default.a(buffer.slice(0, 32).toString('hex'), 16, 'be');\n    const s = new bn_js__WEBPACK_IMPORTED_MODULE_1___default.a(buffer.slice(32).toString('hex'), 16, 'be');\n    return EcdsaDerSignature.encode({ r, s }, 'der');\n}\n//# sourceMappingURL=SubtleCryptoCompat.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto-node/SubtleCryptoCompat.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto-node/index.js":
/*!**************************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto-node/index.js ***!
  \**************************************************************/
/*! exports provided: NodeSigningCryptoImpl, NodePublicCryptoKey, NodePrivateCryptoKey, nodeSignatureToWebSignature, webSignatureToNodeSignature */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NodeSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NodeSigningCryptoImpl */ \"./node_modules/@casual-simulation/crypto-node/NodeSigningCryptoImpl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodeSigningCryptoImpl\", function() { return _NodeSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"NodeSigningCryptoImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodePublicCryptoKey\", function() { return _NodeSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"NodePublicCryptoKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NodePrivateCryptoKey\", function() { return _NodeSigningCryptoImpl__WEBPACK_IMPORTED_MODULE_0__[\"NodePrivateCryptoKey\"]; });\n\n/* harmony import */ var _SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubtleCryptoCompat */ \"./node_modules/@casual-simulation/crypto-node/SubtleCryptoCompat.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"nodeSignatureToWebSignature\", function() { return _SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_1__[\"nodeSignatureToWebSignature\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"webSignatureToNodeSignature\", function() { return _SubtleCryptoCompat__WEBPACK_IMPORTED_MODULE_1__[\"webSignatureToNodeSignature\"]; });\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto-node/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto/Hash.js":
/*!********************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto/Hash.js ***!
  \********************************************************/
/*! exports provided: getHash, getHashBuffer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getHash\", function() { return getHash; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getHashBuffer\", function() { return getHashBuffer; });\n/* harmony import */ var sha_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sha.js */ \"sha.js\");\n/* harmony import */ var sha_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sha_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fast-json-stable-stringify */ \"fast-json-stable-stringify\");\n/* harmony import */ var fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * Calculates the SHA-256 hash of the given object.\n * @param obj The object to calculate the hash of.\n */\nfunction getHash(obj) {\n    const json = fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_1___default()(obj);\n    let sha = new sha_js__WEBPACK_IMPORTED_MODULE_0__[\"sha256\"]();\n    sha.update(json);\n    return sha.digest('hex');\n}\n/**\n * Calculates the SHA-256 hash of the given object and\n * returns a byte buffer containing the hash.\n * @param obj The object to hash.\n */\nfunction getHashBuffer(obj) {\n    const json = fast_json_stable_stringify__WEBPACK_IMPORTED_MODULE_1___default()(obj);\n    let sha = new sha_js__WEBPACK_IMPORTED_MODULE_0__[\"sha256\"]();\n    sha.update(json);\n    return sha.digest();\n}\n//# sourceMappingURL=Hash.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto/Hash.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto/index.js ***!
  \*********************************************************/
/*! exports provided: PEM_PRIVATE_KEY_HEADER, PEM_PRIVATE_KEY_FOOTER, PEM_PUBLIC_KEY_HEADER, PEM_PUBLIC_KEY_FOOTER, formatPublicPEMKey, formatPrivatePEMKey, formatPEM, parsePrivatePEMKey, parsePublicPEMKey, parsePEM, getHash, getHashBuffer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./node_modules/@casual-simulation/crypto/utils.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PEM_PRIVATE_KEY_HEADER\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"PEM_PRIVATE_KEY_HEADER\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PEM_PRIVATE_KEY_FOOTER\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"PEM_PRIVATE_KEY_FOOTER\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PEM_PUBLIC_KEY_HEADER\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"PEM_PUBLIC_KEY_HEADER\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PEM_PUBLIC_KEY_FOOTER\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"PEM_PUBLIC_KEY_FOOTER\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formatPublicPEMKey\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"formatPublicPEMKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formatPrivatePEMKey\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"formatPrivatePEMKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"formatPEM\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"formatPEM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parsePrivatePEMKey\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"parsePrivatePEMKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parsePublicPEMKey\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"parsePublicPEMKey\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parsePEM\", function() { return _utils__WEBPACK_IMPORTED_MODULE_0__[\"parsePEM\"]; });\n\n/* harmony import */ var _Hash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Hash */ \"./node_modules/@casual-simulation/crypto/Hash.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getHash\", function() { return _Hash__WEBPACK_IMPORTED_MODULE_1__[\"getHash\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getHashBuffer\", function() { return _Hash__WEBPACK_IMPORTED_MODULE_1__[\"getHashBuffer\"]; });\n\n\n\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto/index.js?");

/***/ }),

/***/ "./node_modules/@casual-simulation/crypto/utils.js":
/*!*********************************************************!*\
  !*** ./node_modules/@casual-simulation/crypto/utils.js ***!
  \*********************************************************/
/*! exports provided: PEM_PRIVATE_KEY_HEADER, PEM_PRIVATE_KEY_FOOTER, PEM_PUBLIC_KEY_HEADER, PEM_PUBLIC_KEY_FOOTER, formatPublicPEMKey, formatPrivatePEMKey, formatPEM, parsePrivatePEMKey, parsePublicPEMKey, parsePEM */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PEM_PRIVATE_KEY_HEADER\", function() { return PEM_PRIVATE_KEY_HEADER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PEM_PRIVATE_KEY_FOOTER\", function() { return PEM_PRIVATE_KEY_FOOTER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PEM_PUBLIC_KEY_HEADER\", function() { return PEM_PUBLIC_KEY_HEADER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PEM_PUBLIC_KEY_FOOTER\", function() { return PEM_PUBLIC_KEY_FOOTER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"formatPublicPEMKey\", function() { return formatPublicPEMKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"formatPrivatePEMKey\", function() { return formatPrivatePEMKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"formatPEM\", function() { return formatPEM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parsePrivatePEMKey\", function() { return parsePrivatePEMKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parsePublicPEMKey\", function() { return parsePublicPEMKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parsePEM\", function() { return parsePEM; });\n/* harmony import */ var base64_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! base64-js */ \"base64-js\");\n/* harmony import */ var base64_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(base64_js__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * The header that gets added to private keys formated as a PEM file.\n */\nconst PEM_PRIVATE_KEY_HEADER = '-----BEGIN PRIVATE KEY-----';\n/**\n * The footer that gets added to private keys formated as a PEM file.\n */\nconst PEM_PRIVATE_KEY_FOOTER = '-----END PRIVATE KEY-----';\n/**\n * The header that gets added to public keys formated as a PEM file.\n */\nconst PEM_PUBLIC_KEY_HEADER = '-----BEGIN PUBLIC KEY-----';\n/**\n * The footer that gets added to public keys formated as a PEM file.\n */\nconst PEM_PUBLIC_KEY_FOOTER = '-----END PUBLIC KEY-----';\n/**\n * Formats the given buffer as a PEM file for public keys.\n * @param key The buffer that should be stored in the PEM file.\n */\nfunction formatPublicPEMKey(key) {\n    return formatPEM(key, PEM_PUBLIC_KEY_HEADER, PEM_PUBLIC_KEY_FOOTER);\n}\n/**\n * Formats the given buffer as a PEM file for private keys.\n * @param key The buffer that should be stored in the PEM file.\n */\nfunction formatPrivatePEMKey(key) {\n    return formatPEM(key, PEM_PRIVATE_KEY_HEADER, PEM_PRIVATE_KEY_FOOTER);\n}\n/**\n * Formats the given buffer into PEM format.\n * @param buffer The buffer to format.\n * @param header The header to use.\n * @param footer The footer to use.\n */\nfunction formatPEM(buffer, header, footer) {\n    const bytes = new Uint8Array(buffer);\n    const base64 = Object(base64_js__WEBPACK_IMPORTED_MODULE_0__[\"fromByteArray\"])(bytes);\n    const pem = `${header}\\n${base64}\\n${footer}`;\n    return pem;\n}\n/**\n * Parses the given private key PEM file into a buffer that contains just the key.\n * @param pem The PEM file that represents the private key.\n */\nfunction parsePrivatePEMKey(pem) {\n    return parsePEM(pem, PEM_PRIVATE_KEY_HEADER, PEM_PRIVATE_KEY_FOOTER);\n}\n/**\n * Parses the given public key PEM file into a buffer that contains just the key.\n * @param pem The PEM file that represents the public key.\n */\nfunction parsePublicPEMKey(pem) {\n    return parsePEM(pem, PEM_PUBLIC_KEY_HEADER, PEM_PUBLIC_KEY_FOOTER);\n}\n/**\n * Parses the given PEM file using the given header and footer strings.\n * Returns an ArrayBuffer containing the bytes that were formatted into the PEM file.\n *\n * Note that this should probably not be used for PEM files other than the ones produced by\n * formatPEM(). This is because PEM files can contain a lot of extra data that this implementation\n * does not expect. For example, some PEM files can contain multiple keys and probably allow more whitespace.\n *\n * @param pem The PEM file to parse.\n * @param header The header that we're expecting the file to have.\n * @param footer The footer that we're expecting the file to have.\n */\nfunction parsePEM(pem, header, footer) {\n    pem = pem.trim();\n    // Make sure we remove the newlines\n    let contents = pem.substring(header.length + 1, pem.length - (footer.length + 1));\n    contents = contents.replace('\\n', '');\n    const buffer = Object(base64_js__WEBPACK_IMPORTED_MODULE_0__[\"toByteArray\"])(contents);\n    return buffer.buffer;\n}\n//# sourceMappingURL=utils.js.map\n\n//# sourceURL=webpack:///./node_modules/@casual-simulation/crypto/utils.js?");

/***/ }),

/***/ "acorn":
/*!************************!*\
  !*** external "acorn" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"acorn\");\n\n//# sourceURL=webpack:///external_%22acorn%22?");

/***/ }),

/***/ "asn1.js":
/*!**************************!*\
  !*** external "asn1.js" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"asn1.js\");\n\n//# sourceURL=webpack:///external_%22asn1.js%22?");

/***/ }),

/***/ "astring":
/*!**************************!*\
  !*** external "astring" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"astring\");\n\n//# sourceURL=webpack:///external_%22astring%22?");

/***/ }),

/***/ "base64-js":
/*!****************************!*\
  !*** external "base64-js" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"base64-js\");\n\n//# sourceURL=webpack:///external_%22base64-js%22?");

/***/ }),

/***/ "bn.js":
/*!************************!*\
  !*** external "bn.js" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"bn.js\");\n\n//# sourceURL=webpack:///external_%22bn.js%22?");

/***/ }),

/***/ "bowser":
/*!*************************!*\
  !*** external "bowser" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"bowser\");\n\n//# sourceURL=webpack:///external_%22bowser%22?");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"child_process\");\n\n//# sourceURL=webpack:///external_%22child_process%22?");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");\n\n//# sourceURL=webpack:///external_%22crypto%22?");

/***/ }),

/***/ "dexie":
/*!************************!*\
  !*** external "dexie" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dexie\");\n\n//# sourceURL=webpack:///external_%22dexie%22?");

/***/ }),

/***/ "estraverse":
/*!*****************************!*\
  !*** external "estraverse" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"estraverse\");\n\n//# sourceURL=webpack:///external_%22estraverse%22?");

/***/ }),

/***/ "fast-json-stable-stringify":
/*!*********************************************!*\
  !*** external "fast-json-stable-stringify" ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"fast-json-stable-stringify\");\n\n//# sourceURL=webpack:///external_%22fast-json-stable-stringify%22?");

/***/ }),

/***/ "lodash":
/*!*************************!*\
  !*** external "lodash" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash\");\n\n//# sourceURL=webpack:///external_%22lodash%22?");

/***/ }),

/***/ "lru-cache":
/*!****************************!*\
  !*** external "lru-cache" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"lru-cache\");\n\n//# sourceURL=webpack:///external_%22lru-cache%22?");

/***/ }),

/***/ "repl":
/*!***********************!*\
  !*** external "repl" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"repl\");\n\n//# sourceURL=webpack:///external_%22repl%22?");

/***/ }),

/***/ "rxjs":
/*!***********************!*\
  !*** external "rxjs" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"rxjs\");\n\n//# sourceURL=webpack:///external_%22rxjs%22?");

/***/ }),

/***/ "rxjs/operators":
/*!*********************************!*\
  !*** external "rxjs/operators" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"rxjs/operators\");\n\n//# sourceURL=webpack:///external_%22rxjs/operators%22?");

/***/ }),

/***/ "sha.js":
/*!*************************!*\
  !*** external "sha.js" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"sha.js\");\n\n//# sourceURL=webpack:///external_%22sha.js%22?");

/***/ }),

/***/ "socket.io-client":
/*!***********************************!*\
  !*** external "socket.io-client" ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"socket.io-client\");\n\n//# sourceURL=webpack:///external_%22socket.io-client%22?");

/***/ }),

/***/ "uuid/v4":
/*!**************************!*\
  !*** external "uuid/v4" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"uuid/v4\");\n\n//# sourceURL=webpack:///external_%22uuid/v4%22?");

/***/ }),

/***/ "vm2":
/*!**********************!*\
  !*** external "vm2" ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"vm2\");\n\n//# sourceURL=webpack:///external_%22vm2%22?");

/***/ })

/******/ });